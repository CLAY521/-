(window.webpackJsonp=window.webpackJsonp||[]).push([["0c6c478c130a"],{vb1926:function(e,W,Y){"use strict";Y.r(W),function(m){Y.d(W,"EmbeddedSideBar",function(){return U});var e,t,i,a,n,r,o,l,c,s=Y("vb196"),T=Y("vb143"),b=Y("vb152"),u=Y.n(b),d=Y("vb180"),j=Y("vb103"),F=Y.n(j),p=Y("vb159"),I=Y.n(p),E=(Y("vb147"),Y("vb148"),Y("vb963")),v=Y("vb154"),w=Y("vb111"),h=Y("vb308"),f=Y("vb2169"),y=Y("vb2170"),g=Y("vb2177"),V=Y("vb2171"),C=Y("vb652"),S=Y("vb157"),k=(Y("vb112"),Y("vb164"),Y("vb167"),Y("vb113"),Y("vb162")),_=(Y("vb155"),Y("vb116"),Y("vb118"),Y("vb120"),Y("vb174"),Y("vb119"),Y("vb121"),Y("vb117"),Y("vb382")),O=Y("vb965"),B=Y("vb185"),x=(Y("vb129"),Y("vb223"),Y("vb214"),Y("vb232"),Y("vb187"),Y("vb225"),Y("vb224"),Y("vb128"),Y("vb122"),Y("vb115"),Y("vb233"),Y("vb234"),Y("vb235"),Y("vb123"),Y("vb236"),Y("vb193"),Y("vb237"),Y("vb238"),Y("vb124"),Y("vb239"),Y("vb104"),Y("vb240"),Y("vb134"),Y("vb131"),Y("vb226"),Y("vb241"),Y("vb114"),Y("vb110"),Y("vb125"),Y("vb242"),Y("vb127"),Y("vb132"),Y("vb227"),Y("vb135"),Y("vb228"),Y("vb229"),Y("vb133"),Y("vb126"),Y("vb243"),Y("vb262"),Y("vb244"),Y("vb245"),Y("vb246"),Y("vb247"),Y("vb194"),Y("vb248"),Y("vb249"),Y("vb201"),Y("vb260"),Y("vb267"),Y("vb250"),Y("vb136"),Y("vb251"),Y("vb130"),Y("vb252"),Y("vb445"),Y("vb341"),Y("vb398"),Y("vb367"),Y("vb322"),Y("vb414"),Y("vb399"),Y("vb400"),Y("vb346"),Y("vb368"),Y("vb357"),Y("vb381"),Y("vb331"),Y("vb446"),Y("vb493"),Y("vb401"),Y("vb447"),Y("vb342"),function(e){function t(){return Object(T.ov)(this,t),e.apply(this,arguments)||this}return Object(T.bu)(t,e),Object(T.Pw)(t,[{key:"shouldComponentUpdate",value:function(e){var t=this.props,i=t.view,a=t.activeViewId,n=t.contextMenuSelectView,r=t.editViewId,o=t.editable,l=t.editName,c=Object(v.a)(i,e.view),s=Object(v.a)(n,e.contextMenuSelectView);return!(c&&s&&a===e.activeViewId&&r===e.editViewId&&o===e.editable&&l===e.editName)}},{key:"render",value:function(){var t=this,e=this.props,i=e.view,a=e.activeViewId,n=e.contextMenuSelectView,r=e.editViewId,o=e.editable,l=e.editName,c=e.moreBtnClicked,s="bitable-sidebar__item_float bitable-layout-row bitable-layout-cross-center\n      bitable-noselect J-bitable-sidebar__item";if(i.id===r)return F.a.createElement("li",{className:s},F.a.createElement("input",{className:"sidebar-input bitable-f-g-1",type:"text",onBlur:function(){return t.props.onViewEditBlur()},onClick:function(e){return e.stopPropagation()},onKeyDown:function(e){t.props.onKeyDown(e)},onFocus:function(){return t.props.onFocus(t.viewNameEditor)},defaultValue:l,ref:function(e){return t.viewNameEditor=e}}),F.a.createElement("i",{className:"bitable-g-cp bitable-layout-row bitable-layout-cross-center"},F.a.createElement(f.a,{className:"bitable-sidebar-done-icon"})));var b=n&&i.id===n.getId();return F.a.createElement("li",{className:I()(s,{active:i.id===a,select:b,"more-btn-select":b&&c}),onClick:function(){return t.onClickSideBarItem()}},F.a.createElement(T.Mx,{title:i.name,disabled:i.type===T.az.NotSupport},F.a.createElement("div",{className:"bitable-sidebar__item-content bitable-layout-row bitable-layout-cross-center"},F.a.createElement("i",{className:"bitable-sidebar__item-icon"},F.a.createElement(h.a,{type:i.type})),F.a.createElement("span",{className:I()("bitable-sidebar__item-text bitable-f-g-1",{"not-support":i.type===T.az.NotSupport})},i.name))),o?this.renderTools():null,i.type===T.az.NotSupport&&F.a.createElement(w.Tooltip,{title:m("bitable.not_support_view_tip"),placement:"bottom",adjustOverflow:!1},F.a.createElement("i",{className:"bitable-sidebar__item-warning"},F.a.createElement(y.a,null))))}}]),t}(E.d)),N=Object(T.oA)(function(e){return{base:e.base}})(x),z=3;function M(e,i){return Object(S.a)(e[i])?[!0,e[i]]:!1===e[i]?[!1,k.a]:[!0,function(e,t){return t[i]="".concat(e,"px")}]}function D(){var e=Object(j.useState)(0),t=Object(T.xz)(e,2),i=t[0],a=t[1];return[i,function(e){return e=Math.max(Math.floor(e),0),1<Math.abs(e-i)&&(a(e),!0)}]}function R(V){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},t=M(e,"top"),i=Object(T.xz)(t,2),I=i[0],E=i[1],a=M(e,"bottom"),n=Object(T.xz)(a,2),C=n[0],S=n[1],r=M(e,"left"),o=Object(T.xz)(r,2),k=o[0],_=o[1],l=M(e,"right"),c=Object(T.xz)(l,2),O=c[0],B=c[1],s=e.maxEffects,x=void 0===s?z:s,N=0,b=function(e){var t=D(),i=Object(T.xz)(t,2),s=i[0],b=i[1],a=D(),n=Object(T.xz)(a,2),d=n[0],u=n[1],r=D(),o=Object(T.xz)(r,2),p=o[0],v=o[1],l=D(),c=Object(T.xz)(l,2),m=c[0],w=c[1],h=Object(j.useRef)(null),f=e.style,y=void 0===f?{}:f;Object(j.useEffect)(function(){if(x<=N)N=0;else{var e=!1;if(h.current){var t=h.current.getBoundingClientRect(),i=t.top,a=t.bottom,n=t.left,r=t.right,o=window,l=o.innerWidth,c=o.innerHeight;I&&(e=b(0-(i-s))||e),C&&(e=u(a+d-c)||e),k&&(e=v(0-(n-p))||e),O&&(e=w(r+m-l)||e)}e?N++:N=0}}),I&&0<s&&E(s,y,e),C&&0<d&&S(d,y,e),k&&0<p&&_(p,y,e),O&&0<m&&B(m,y,e);var g=V;return F.a.createElement(g,Object(T.Kx)({},e,{style:y,ref:h}),e.children)};return function(e){return b(e)}}var P=140,L=36,q=1,K=18,H=(e=Object(T.VB)({ifNotEditable:function(e){return e.closeCreateMenu&&e.closeCreateMenu()},isEditable:function(e){return e.props.permissionStore.hasPermission(T.qy.View,{tableId:e.props.tableId},T.ry.Addable)}}),t=Object(T.VB)({isEditable:function(e){return e.props.permissionStore.hasPermission(T.qy.View,{tableId:e.props.tableId},T.ry.Addable)}}),i=Object(T.VB)({isEditable:function(e){return e.props.permissionStore.hasPermission(T.qy.View,{tableId:e.props.tableId},T.ry.Editable)}}),a=Object(T.VB)({isEditable:function(e,t){return e.props.permissionStore.hasPermission(T.qy.View,{tableId:e.props.tableId,viewId:t.id},T.ry.Editable)}}),n=Object(T.VB)({ifNotEditable:function(e,t){return t.target&&t.preventDefault()},isEditable:function(e,t,i){return e.props.permissionStore.hasPermission(T.qy.View,{tableId:e.props.tableId,viewId:i?i.id:""},T.ry.Deletable)||e.props.permissionStore.hasPermission(T.qy.View,{tableId:e.props.tableId,viewId:i?i.id:""},T.ry.Editable)}}),r=Object(T.VB)({ifNotEditable:function(e){return e.closeContextMenu()},isEditable:function(e){var t=e.state.contextMenuSelectView;return e.props.permissionStore.hasPermission(T.qy.View,{tableId:e.props.tableId,viewId:t?t.getId():""},T.ry.Editable)}}),o=Object(T.VB)({ifNotEditable:function(e){return e.closeContextMenu()},isEditable:function(e){var t=e.state.contextMenuSelectView;return e.props.permissionStore.hasPermission(T.qy.View,{tableId:e.props.tableId,viewId:t?t.getId():""},T.ry.Deletable)}}),l=Object(T.VB)(),c=function(t){function i(e){var d;return Object(T.ov)(this,i),(d=t.call(this,e)||this).viewNameEditor=null,d.autoScroll=new C.a,d.lastTableId="",d.bitableViewPanelVCFollow=null,d.setAddViewRef=function(e){d.addViewBtn=e},d.listenOnboardingEvents=function(){var e=T.ob.EventEmitter,t=function(){var e=d.props,t=e.renderer,i=e.env;t.eventManager.emit(T.ay.ClickGroupSettingsBtn),i.getEmbeddedType()===T.pA.EmbeddedInDoc&&d.setFloatToolbarVisibility(!1)},i=function(){var e=d.props.env;Object(T.eC)(T.fC),Object(T.gC)(T.fC),e.getEmbeddedType()===T.pA.EmbeddedInDoc&&d.setFloatToolbarVisibility(!1)};return null==e||e.addListener(T.WA.KANBAN_TRY_GROUP_SETTING,t),null==e||e.addListener(T.WA.KANBAN_SKIP_GROUP_SETTING,i),function(){null==e||e.removeListener(T.WA.KANBAN_TRY_GROUP_SETTING,t),null==e||e.removeListener(T.WA.KANBAN_SKIP_GROUP_SETTING,i)}},d.setFloatToolbarVisibility=function(e){(0,d.props.setFloatToolbarVisibility)(e)},d.switchView=function(e){var t=d.props,i=t.tableId,a=t.bitableStore,n=t.renderer,r=t.viewId,o=t.onSwitchView,l=t.env,c=t.uiEventManager,s=t.base;if(e.getType()!==T.az.NotSupport){if(i&&e.getId()!==r){var b=Object(T.pF)(e);T.ob.collectBitableEvent(T.On.BitableViewSwitch,{table_id:i,from_view_id:r,to_view_id:e.getId(),bitable_view_type:T.Cz[e.getType()],source:T.OC.SideBar,data_source:l.getModuleType(),bitable_select_type:b},!0),c.emit(T.my.SwitchView,e.getId()),n.switchView(Object(T.aB)(s),i,e.getId()),o&&o()}l.getEmbeddedType()===T.pA.EmbeddedInDoc&&d.props.toggleTableSidebar(!1)}else Object(T.XA)({title:m("bitable.not_support_type"),message:m("bitable.error.version_old"),buttons:[{text:m("bitable.refresh_now"),type:T.YA.primary,onClick:T.ZA}]},a)},d.closeContextMenu=function(){d.closeCtxMenu&&d.closeCtxMenu(!0)},d.onCopyView=Object(T.uY)(u.a.mark(function e(){var t,i,a,n,r,o,l;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(d.canAddView("copy")){e.next=2;break}return e.abrupt("return");case 2:if(t=d.props,i=t.tableId,a=t.onCopyView,n=t.source,r=t.base,o=d.state.contextMenuSelectView,!i||!o){e.next=14;break}if(r.getTable(i)){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,d.copyView(i,o.getId());case 10:l=e.sent,a&&a(Object(T.hC)(l)),T.ob.collectBitableEvent(T.On.BitableViewCreate,{action:T.bB.Duplicate,bitable_id:r.getEncryptToken(),table_id:i,view_id:o.getId(),bitable_view_type:T.Cz[o.getType()],view_type:T.Cz[o.getType()],source:n},!0),T.cz.collectClickEvent(T.Bc.CcmBitableViewMoreClick,{click:T.cB.Duplicate});case 14:d.closeContextMenu();case 15:case"end":return e.stop()}},e)})),d.checkToHideSidebarPlaceholder=function(){if(d.sidebarWrapRef&&d.sidebarListRef){var e=d.sidebarListRef.getBoundingClientRect(),t=!1;d.sidebarWrapRef.getBoundingClientRect().bottom-e.bottom<P+L+q&&(t=!0),d.setState({hideSidebarPlaceholder:t})}},d.onClickAddViewItem=function(e){d.handleAddView(e,!0),T.cz.collectClickEvent(T.Bc.CcmBitableViewCreateClick,{click:T.Cz[e]})},d.onClickAddViewInDocItem=function(e){d.addViewInDoc(e),T.cz.collectClickEvent(T.Bc.CcmBitableViewCreateClick,{click:T.Cz[e]})},d.getOffsetConfig=function(){var e=d.props,t=e.env,i=e.editable,a=0,n=0;return t.getEmbeddedType()===T.pA.EmbeddedInDoc?(a=i?T.xF:T.yF,n=0-T.zF):(a=i?T.AF:K,n=-T.BF+T.vF),{panelGap:a,offsetUp:n}},d.onDragStart=function(){d.setState({dragging:!0}),d.closeContextMenu()},d.onDragEnd=function(e){var t=e.oldIndex,i=e.newIndex,a=d.props.onDragEnd;d.setState({dragging:!1}),d.sortViews({oldIndex:t,newIndex:i}),a&&a({oldIndex:t,newIndex:i})},d.getSidebarListContainer=function(){return d.sidebarListRef||document.body},d.checkCanAddView=function(){var e=d.props,t=e.editable,i=e.permissionStore,a=e.tableId;return t&&i.hasPermission(T.qy.View,{tableId:a},T.ry.Addable)},d.state={editViewId:"",editName:"",contextMenuSelectView:null,hideSidebarPlaceholder:!0,moreBtnClicked:!1,dragging:!1},d.reduxStore=T.ob.store,d}return Object(T.bu)(i,t),Object(T.Pw)(i,[{key:"componentDidMount",value:function(){var e=this,t=this.props,i=t.env,a=t.isFloat,n=t.isOpenSidebar,r=t.isVCEnable,o=t.base;n&&this.scrollToActiveItem(this.sidebarListRef,".J-bitable-sidebar__item.active"),this.checkToHideSidebarPlaceholder(),this.resizeListener=Object(d.a)(this.checkToHideSidebarPlaceholder,100),window.addEventListener("resize",this.resizeListener),Object(T.Dx)()&&!a&&i.getEmbeddedType()!==T.pA.EmbeddedInDoc&&(this.bitableViewPanelVCFollow=new O.a({getState:function(){return{openStatus:e.props.isOpenSidebar?T.Dy.Open:T.Dy.Close,tableId:e.props.tableId}},enable:!!r,toggleSidebar:function(e,t){var i=o.getBlock(t);i&&T.qF.getInstance(i).toggleTableSidebar(e)},checkTableId:!0,getCurrentTableId:function(){return e.props.tableId}}))}},{key:"componentDidUpdate",value:function(e,t){var i;e.isOpenSidebar===this.props.isOpenSidebar&&e.tableId===this.props.tableId||null===(i=this.bitableViewPanelVCFollow)||void 0===i||i.sendVCStateChange(),this.props.isOpenSidebar&&(this.checkToHideSidebarPlaceholder(),(this.props.isOpenSidebar&&!e.isOpenSidebar||this.props.tableId!==e.tableId)&&this.scrollToActiveItem(this.sidebarListRef,".J-bitable-sidebar__item.active"))}},{key:"componentWillUnmount",value:function(){var e;window.removeEventListener("resize",this.resizeListener),this.removeOnboardingListener&&this.removeOnboardingListener(),null===(e=this.bitableViewPanelVCFollow)||void 0===e||e.closeVCFollow(),this.bitableViewPanelVCFollow=null}},{key:"sortViews",value:function(e){var t=this.props,i=t.operate,a=t.tableId,n=t.views,r=t.env;e.oldIndex!==e.newIndex&&(i.tableOperate.moveViewSync({tableId:a,target:e.newIndex,viewId:n[e.oldIndex].id}),T.ob.collectBitableEvent(T.On.BitableViewMove,{data_source:r.getModuleType()}))}},{key:"handleAddView",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(this.canAddView()){var i=this.props,a=i.tableId,n=i.viewId,r=i.onAddView,o=i.setAddViewLoadingState,l=i.toggleTableSidebar,c=i.toggleFormSettingsPanel,s=i.operate,b=i.base,d=i.env;d.getEmbeddedType()!==T.pA.EmbeddedInDoc&&o&&o(!0);var u=s.tableOperate.addViewSync({activeViewId:n,tableId:a,type:e});if(u.result===T.Ey.Success){var p=b.getTable(a).getView(u.data.viewId);if(p&&(this.props.renderer.switchView(Object(T.aB)(b),a,u.data.viewId),p.getType()===T.az.Form?(l(!1),c(u.data.viewId,!0),setTimeout(function(){var e=document.querySelector(".bitable-form-title-text");null==e||e.click()},200)):t&&this.onViewRename(p),p.getType()===T.az.Kanban&&this.handleSetGroupOnboarding(p),d.getEmbeddedType()!==T.pA.EmbeddedInDoc&&o))var v=setTimeout(function(){o(!1),clearTimeout(v)},500);return this.closeCreateMenu&&this.closeCreateMenu(),r&&r(),p}}}},{key:"handleSetGroupOnboarding",value:function(e){for(var t=e.getTable(),i=t.getAllFields(),a=this.props.env,n=0,r=0;r<i.length;r++){var o=t.getField(i[r]);if(Object(T.hB)(o.getType())&&1<++n)break}1<n&&(a.getEmbeddedType()===T.pA.EmbeddedInDoc&&this.setFloatToolbarVisibility(!0),this.removeOnboardingListener=this.listenOnboardingEvents(),Object(T.rF)(T.fC))}},{key:"onCreateView",value:function(){var t=this;if(this.canAddView()){var e=this.props,i=e.toggleTableSidebar,a=e.onEditorToolbarName,n=e.viewsExclude;if(e.env.getEmbeddedType()===T.pA.EmbeddedInDoc){var r=this.handleAddView(T.az.Grid,!1);if(!r)return;return i(!1),void(null==a||a(Object(T.lB)(r)))}var o=20,l=-2,c=80,s=Object(T.mB)(this.addViewBtn),b=s.bottom+l;b>window.innerHeight-c&&(b=s.top-c-l);var d=[T.az.Grid,T.az.Kanban,T.az.Gantt,T.az.Gallery,T.az.Form];n&&(d=d.filter(function(e){return!n.includes(e)})),T.cz.collectClickEvent(T.Bc.CcmBitableSidebarClick,{click:T.VC.CreateNewView,target:T.Rw.CcmBitableViewCreateView});var u=[];T.ob.config.ui.addViewTypes&&(u=T.ob.config.ui.addViewTypes(d).map(function(e){switch(e){case T.az.Grid:return{text:m("bitable.grid_view"),icon:F.a.createElement(h.b.GridSvg,{className:"icon"}),onClick:function(){return t.onClickAddViewItem(T.az.Grid)}};case T.az.Kanban:return{text:m("bitable.kanban_view"),icon:F.a.createElement(h.b.KanbanSvg,{className:"icon"}),onClick:function(){return t.onClickAddViewItem(T.az.Kanban)}};case T.az.Gallery:return{text:m("bitable.default_gallery_view"),icon:F.a.createElement(h.b.GallerySvg,{className:"icon"}),onClick:function(){return t.onClickAddViewItem(T.az.Gallery)}};case T.az.Gantt:return{text:m("bitable.default_gantt_view_name"),icon:F.a.createElement(h.b.GanttSvg,{className:"icon"}),onClick:function(){return t.onClickAddViewItem(T.az.Gantt)}};case T.az.Form:return{text:m("Bitable_Form_FormView"),icon:F.a.createElement(h.b.FormSvg,{className:"icon"}),step:"bitable_create_form_view",onClick:function(){Object(T.sF)(T.jB),t.onClickAddViewItem(T.az.Form)}}}return null}).filter(T.kB)),u.length&&(1!==u.length?this.closeCreateMenu=Object(T.NB)({x:o+s.left,y:b,className:"bitable-sidebar__create_menu",items:u,getContainer:function(){return t.sidebarWrapRef},onShow:function(){T.cz.collectBitableEvent(T.Rw.CcmBitableViewCreateView,{panel_type:T.vB.SidebarPanel})}}):u[0].onClick())}}},{key:"onViewEditBlur",value:function(){var i=this,e=this.viewNameEditor.value.trim();if(!Object(T.oB)(e))return Object(T.pB)(),void this.setState({editViewId:""});var t=this.props,a=t.tableId,n=t.operate,r=t.base,o=t.env;if(a){var l=this.state.editViewId,c=n.tableOperate.setViewSync({name:e,tableId:a,viewId:l});c.result===T.Ey.Fail&&c.reason===T.qB.NameRepeat&&Object(T.rB)({title:m("common.rename_failed"),message:m("bitable.error.repeat_view_name",e),buttons:[{text:m("common.confirm"),type:T.YA.primary,onClick:function(){var e,t=null===(e=r.getTable(a))||void 0===e?void 0:e.getView(l);t&&i.onViewRename(t)}}]}),this.setState({editViewId:""});var s=this.props.views.find(function(e){return e.id===l});s&&s.name!==e&&T.ob.collectBitableEvent(T.On.BitableViewRename,{table_id:a,view_id:l,bitable_view_type:T.Cz[s.type],length:e.length,action:T.sB.Rename,data_source:o.getModuleType()},!0)}}},{key:"onViewRename",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:T.NC.DoubleClick,i=this.props,a=i.tableId,n=i.env,r=e.getId(),o=e.getName();this.setState({editViewId:r,editName:o}),T.ob.collectBitableEvent(T.On.BitableViewRename,{table_id:a,view_id:r,bitable_view_type:T.Cz[e.getType()],action:T.sB.EnterEdit,source:t,data_source:n.getModuleType()},!0)}},{key:"onFocus",value:function(e){this.viewNameEditor=e}},{key:"onKeyDown",value:function(e){e.keyCode===T.sx.Enter?this.onViewEditBlur():e.keyCode===T.sx.Esc&&this.setState({editViewId:""})}},{key:"setListRef",value:function(e){e&&(this.sidebarListRef=e,this.autoScroll.setContainer(e))}},{key:"onContextMenu",value:function(e,t,i){var a=this,n=this.props,r=n.isFloat,o=n.env,l=n.permissionStore,c=this.state.contextMenuSelectView;if(c&&c.getId()===t.getId())this.closeContextMenu();else{var s=o.getEmbeddedType()===T.pA.EmbeddedInDoc,b=e.clientX,d=e.clientY,u=e.currentTarget;if(i){var p=Object(T.mB)(u);s||r?(b=p.right+T.tF.OFFSET_RIGHT_GAP,d=p.top-T.tF.OFFSET_TOP_GAP):(b=p.left,d=p.bottom+T.tF.OFFSET_BOTTOM_GAP)}var v={x:b,y:d};this.setState({contextMenuSelectView:t,moreBtnClicked:!!i},function(){a.closeCtxMenu=Object(T.NB)({x:v.x,y:v.y,items:[{text:m("bitable.rename_view"),onClick:a.openRename.bind(a),icon:F.a.createElement(T.IB.RenameIconSvg,{className:"icon icon-doc"}),disabled:!l.hasPermission(T.qy.View,{tableId:a.props.tableId,viewId:t?t.getId():""},T.ry.Editable)},{text:m("bitable.copy_view"),onClick:a.onCopyView.bind(a),icon:F.a.createElement(T.IB.CopyIconSvg,{className:s?"icon-doc":"icon"}),disabled:!l.hasPermission(T.qy.View,{tableId:a.props.tableId,viewId:t?t.getId():""},T.ry.Addable)},{text:m("bitable.delete_view"),onClick:a.deleteView.bind(a),icon:F.a.createElement(T.IB.DeleteIconSvg,{className:s?"icon-doc":"icon"}),disabled:a.props.views.length<=1||!l.hasPermission(T.qy.View,{tableId:a.props.tableId,viewId:t?t.getId():""},T.ry.Deletable)}],triggerElement:u,onClose:function(){a.setState({contextMenuSelectView:null,moreBtnClicked:!1},function(){a.closeCtxMenu=null})},onShow:function(){T.cz.collectBitableEvent(T.Rw.CcmBitableViewMoreView,{panel_type:r?T.vB.TitleBar:T.vB.SidebarPanel})},getContainer:function(){return a.sidebarWrapRef},className:"bitable-sidebar-contextmenu-more"})}),e.preventDefault(),e.persist()}}},{key:"onScroll",value:function(){this.closeContextMenu()}},{key:"openRename",value:function(){var e=this.state.contextMenuSelectView;e&&this.onViewRename(e,T.NC.Dropdown),T.cz.collectClickEvent(T.Bc.CcmBitableViewMoreClick,{click:T.cB.Rename}),this.closeContextMenu()}},{key:"canAddView",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"add",t=this.props,i=t.tableId,a=t.base.getTable(i);if(!a)return!1;if(a.getAllViews().length>=T.gB){var n={add:m("Bitable_AddView_MaximumLimitedTips",T.gB),copy:m("Bitable_CopyView_MaximumLimitedTips",T.gB)}[e];return n&&T.ob.Toast.error({content:n}),!1}return!0}},{key:"copyView",value:function(){var i=Object(T.uY)(u.a.mark(function e(t,i){var a,n,r,o,l,c;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.props,n=a.renderer,r=a.base,o=a.operate,e.next=3,o.tableOperate.copyView({tableId:t,viewId:i});case 3:if(!(l=e.sent)||l.result!==T.Ey.Success){e.next=9;break}return c=r.getTable(t).getView(l.data.viewId),n.switchView(Object(T.aB)(r),t,l.data.viewId),this.onViewRename(c,T.NC.Dropdown),e.abrupt("return",c);case 9:return e.abrupt("return",null);case 10:case"end":return e.stop()}},e,this)}));function e(e,t){return i.apply(this,arguments)}return e}()},{key:"deleteView",value:function(){var e=this.props,i=e.tableId,a=e.viewId,n=e.operate,r=e.base,o=e.env,l=this.state.contextMenuSelectView;T.cz.collectClickEvent(T.Bc.CcmBitableViewMoreClick,{click:T.cB.Delete,target:T.Rw.CcmBitableViewDeleteView}),i&&l&&(Object(T.rB)({title:m("bitable.delete_view"),message:m("bitable.to_delete_view",l.getName()),className:"bitable-dialog-view_delete",buttons:[{text:m("common.cancel"),onClick:function(){T.cz.collectClickEvent(T.Bc.CcmBitableViewDeleteClick,{click:T.aC.Cancel})}},{text:m("comment.delete"),type:T.YA.warn,onClick:function(){var e=Object(T.uY)(u.a.mark(function e(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return T.ob.collectBitableEvent(T.On.BitableViewDelete,{smartable_token:r.getMd5Token(),table_id:i,view_id:a,bitable_view_type:T.Cz[l.getType()],data_source:o.getModuleType()},!0),T.cz.collectClickEvent(T.Bc.CcmBitableViewDeleteClick,{click:T.aC.Confirm}),e.next=4,n.tableOperate.delView({tableId:i,viewId:l.getId()});case 4:case"end":return e.stop()}},e)}));function t(){return e.apply(this,arguments)}return t}()}]}),T.cz.collectBitableEvent(T.Rw.CcmBitableViewDeleteView)),this.closeContextMenu()}},{key:"scrollToActiveItem",value:function(e,t){var i=e&&e.querySelector(t);if(i){var a=i.parentElement;if(a){var n=a.scrollHeight,r=a.offsetHeight,o=a.children,l=n/o.length*([].indexOf.call(o,i)+1)-r;a.scrollTop=0<l?l:0}}}},{key:"addViewInDoc",value:function(e){var t=this.props,i=t.toggleTableSidebar,a=t.onEditorToolbarName,n=this.handleAddView(e,!1);n&&(i(!1),a&&a(Object(T.lB)(n)))}},{key:"renderAddViewItem",value:function(){var e=this;return this.props.editable?F.a.createElement(F.a.Fragment,null,F.a.createElement("div",{className:"bitable-sheet-sidebar-view__split-line"}),F.a.createElement("div",{ref:this.setAddViewRef,onClick:function(){return e.onCreateView()},className:"bitable-sheet-sidebar-add-view"},F.a.createElement("i",{className:"bitable-sidebar__item-icon"},F.a.createElement(g.a,null)),F.a.createElement("span",{className:"bitable-sidebar__item-text"},m("bitable.add_view")))):null}},{key:"renderAddViewItemInDocOrFloat",value:function(){var t=this,e=this.props,i=e.editable,a=e.viewsExclude,n=e.env,r=e.isOpenSidebar,o=e.isFloat,l=e.showFloatSidebar;if(!i)return null;var c=[T.az.Grid,T.az.Kanban,T.az.Gantt,T.az.Gallery];n.getEmbeddedType()===T.pA.EmbeddedInSheet&&c.push(T.az.Form),a&&(c=c.filter(function(e){return!a.includes(e)}));var s=[];T.ob.config.ui.addViewTypes&&(s=T.ob.config.ui.addViewTypes(c).map(function(e){switch(e){case T.az.Grid:return F.a.createElement("li",{key:"grid",tabIndex:-1,className:"bitable-sidebar__add-view-item",onClick:function(){return t.onClickAddViewInDocItem(T.az.Grid)}},F.a.createElement("i",{className:"bitable-sidebar__add-view-item-icon"},F.a.createElement(h.b.GridSvg,null)),F.a.createElement("span",{className:"bitable-sidebar__add-view-item-text"},m("bitable.grid_view")));case T.az.Kanban:return F.a.createElement("li",{key:"kanban",tabIndex:-1,className:"bitable-sidebar__add-view-item",onClick:function(){return t.onClickAddViewInDocItem(T.az.Kanban)}},F.a.createElement("i",{className:"bitable-sidebar__add-view-item-icon"},F.a.createElement(h.b.KanbanSvg,null)),F.a.createElement("span",{className:"bitable-sidebar__add-view-item-text"},m("bitable.kanban_view")));case T.az.Gallery:return F.a.createElement("li",{key:"gallery",tabIndex:-1,className:"bitable-sidebar__add-view-item",onClick:function(){return t.onClickAddViewInDocItem(T.az.Gallery)}},F.a.createElement("i",{className:"bitable-sidebar__add-view-item-icon"},F.a.createElement(h.b.GallerySvg,null)),F.a.createElement("span",{className:"bitable-sidebar__add-view-item-text"},m("bitable.default_gallery_view")));case T.az.Gantt:return F.a.createElement("li",{key:"gantt",tabIndex:-1,className:"bitable-sidebar__add-view-item",onClick:function(){return t.onClickAddViewInDocItem(T.az.Gantt)}},F.a.createElement("i",{className:"bitable-sidebar__add-view-item-icon"},F.a.createElement(h.b.GanttSvg,null)),F.a.createElement("span",{className:"bitable-sidebar__add-view-item-text"},m("bitable.default_gantt_view_name")));case T.az.Form:return F.a.createElement("li",{key:"form",tabIndex:-1,className:"bitable-sidebar__add-view-item",onClick:function(){return t.onClickAddViewInDocItem(T.az.Form)}},F.a.createElement("i",{className:"bitable-sidebar__add-view-item-icon"},F.a.createElement(h.b.FormSvg,null)),F.a.createElement("span",{className:"bitable-sidebar__add-view-item-text"},m("Bitable_Form_FormView")))}return null}).filter(T.kB));var b=R("div",{bottom:function(e,t){t.marginTop="".concat(-e,"px")}}),d=r||o&&l;return F.a.createElement("div",{className:"bitable-sidebar-add-new-wrapper",onMouseEnter:this.closeContextMenu},F.a.createElement("div",{ref:this.setAddViewRef,className:"bitable-sidebar__item bitable-sidebar-add-new bitable-noselect bitable-layout-row bitable-layout-cross-center J-bitable-sidebar__item bitable-sidebar-add-new-in-doc"},F.a.createElement("i",{className:"bitable-sidebar__item-icon"},F.a.createElement(g.a,null)),F.a.createElement("span",{className:"bitable-sidebar__item-text"},m("bitable.create_view")),F.a.createElement(V.a,{className:"bitable-sidebar-add-new__right_icon"})),d&&F.a.createElement(b,{className:"bitable-sidebar-add-view-list-wrapper"},F.a.createElement("ul",{className:"bitable-sidebar-add-view-list"},s)))}},{key:"getSidebarStyle",value:function(){var e=this.props,t=e.anchorInfo,i=e.views,a=e.env,n={},r=this.getOffsetConfig(),o=r.panelGap,l=r.offsetUp;if(t&&t.getAnchorRef){var c=t.getAnchorRef();if(c){var s=_.e*i.length+o,b=Object(T.tC)(c,{height:s,offsetDown:T.uF+T.vF,offsetUp:l,viewportTop:Object(T.zC)(a.getEmbeddedType())},{childSelector:".bitable-sidebar .b-scroll-view",otherHeight:this.checkCanAddView()?44:0,parentNode:this.sidebarWrapRef||document});Object.assign(n,b),Object(T.bE)(c,n,{width:T.CF})}}return n}},{key:"render",value:function(){var t=this,e=this.props,i=this.state,a=e.tableId,n=e.viewId,r=e.views,o=e.editable,l=e.isOpenSidebar,c=e.isFloat,s=e.showFloatSidebar,b=e.env,d=e.permissionStore,u=i.contextMenuSelectView,p=i.editName,v=i.editViewId,m=i.moreBtnClicked,w=i.dragging,h=E.b,f=b.getEmbeddedType()===T.pA.EmbeddedInDoc;f?h=E.c:c&&(h=N);var y=c&&(s||!!u||""!==v||w),g="ontouchstart"in document.documentElement?{pressDelay:200}:{distance:5},V=a!==this.lastTableId;return this.lastTableId=a,F.a.createElement("div",{className:I()("bitable-sidebar bitable-sheet-sidebar bitable-layout-column",{"bitable-sidebar-float":c,fold:!c&&!l,showFloat:y,"no-animation":V}),style:f?this.getSidebarStyle():{},onClick:function(e){return e.stopPropagation()}},F.a.createElement("div",{className:"bitable-sidebar-wrapper",ref:function(e){return t.sidebarWrapRef=e}},F.a.createElement(E.a,Object(T.Kx)({helperClass:"bitable-drag-item-helper J-bitable-drag-item",tableId:a,activeTableId:a,views:r,lockAxis:"y"},g,{lockToContainerEdges:!0,onScroll:this.onScroll.bind(this),onListRef:this.setListRef.bind(this),editable:o,editName:p,editViewId:v,activeViewId:n,contextMenuSelectView:u,moreBtnClicked:m,switchView:this.switchView.bind(this),onViewRename:this.onViewRename.bind(this),onContextMenu:this.onContextMenu.bind(this),onViewEditBlur:function(){var e=function e(){window.removeEventListener("mouseup",e),t.onViewEditBlur()};window.addEventListener("mouseup",e)},onKeyDown:this.onKeyDown.bind(this),onFocus:this.onFocus.bind(this),SidebarItemCom:h,onSortStart:this.onDragStart,onSortEnd:this.onDragEnd,getContainer:this.getSidebarListContainer,closeContextMenu:this.closeContextMenu,onClickViewMoreOptionsBtn:this.props.onClickViewMoreOptionsBtn,onClickSideBarItem:this.props.onClickSideBarItem})),this.checkCanAddView()&&(f||c?this.renderAddViewItemInDocOrFloat():this.renderAddViewItem()),!f&&!c&&this.props.editable&&!this.state.hideSidebarPlaceholder&&d.hasPermission(T.qy.View,{tableId:a},T.ry.Addable)&&F.a.createElement("div",{className:"sidebar-placeholder"},F.a.createElement(T.wF,{tailIcon:F.a.createElement(T.uD,{action:T.WD.CreateViews})}))))}}]),i}(F.a.PureComponent),Object(T.lz)(c.prototype,"handleAddView",[e],Object.getOwnPropertyDescriptor(c.prototype,"handleAddView"),c.prototype),Object(T.lz)(c.prototype,"onCreateView",[t],Object.getOwnPropertyDescriptor(c.prototype,"onCreateView"),c.prototype),Object(T.lz)(c.prototype,"onViewEditBlur",[i],Object.getOwnPropertyDescriptor(c.prototype,"onViewEditBlur"),c.prototype),Object(T.lz)(c.prototype,"onViewRename",[a],Object.getOwnPropertyDescriptor(c.prototype,"onViewRename"),c.prototype),Object(T.lz)(c.prototype,"onContextMenu",[n],Object.getOwnPropertyDescriptor(c.prototype,"onContextMenu"),c.prototype),Object(T.lz)(c.prototype,"openRename",[r],Object.getOwnPropertyDescriptor(c.prototype,"openRename"),c.prototype),Object(T.lz)(c.prototype,"deleteView",[o],Object.getOwnPropertyDescriptor(c.prototype,"deleteView"),c.prototype),Object(T.lz)(c.prototype,"addViewInDoc",[l],Object.getOwnPropertyDescriptor(c.prototype,"addViewInDoc"),c.prototype),c),U=Object(s.a)(B.c,Object(B.b)(function(e){var t=e.toolbarStore;return{setFloatToolbarVisibility:t.toggleFloatToolbar,toggleFormSettingsPanel:t.toggleFormSettingsPanel,isOpenSidebar:t.isOpenTableSidebar,toggleTableSidebar:t.toggleTableSidebar}}),Object(T.oA)(function(e){return{operate:e.operate,base:e.base,env:e.env,permissionStore:e.permissionStore,uiEventManager:e.uiEventManager}}))(H)}.call(this,Y("vb163"))},vb447:function(e,t,i){"use strict";i.d(t,"a",function(){return o});var n=i("vb143"),a=i("vb103"),u=i.n(a),r=i("vb159"),p=i.n(r),o=function(i){function a(e){var t;return Object(n.ov)(this,a),(t=i.call(this,e)||this).scrollBarRatio=1,t.state={scrollBarHeight:0,scrollBarTop:0,scrollBarRatio:1},t}return Object(n.bu)(a,i),Object(n.Pw)(a,[{key:"setRef",value:function(e){this.listEl=e,this.props.onRef&&this.props.onRef(e)}},{key:"onScroll",value:function(){this.props.onScroll&&this.props.onScroll(),this.listEl&&this.setState({scrollBarTop:this.listEl.scrollTop*this.state.scrollBarRatio})}},{key:"updateScrollBarHeight",value:function(){if(this.props.customScrollBar&&this.rootEl&&this.listEl){var e=this.rootEl.scrollHeight,t=e/this.listEl.scrollHeight,i=e*t;this.setState({scrollBarRatio:t,scrollBarHeight:i})}}},{key:"bindDOMEvent",value:function(){var e=this,t=function(){e.updateScrollBarHeight()};return window.addEventListener("resize",t),function(){window.removeEventListener("resize",t)}}},{key:"componentDidMount",value:function(){this.updateScrollBarHeight(),this.unbindDOMEvent=this.bindDOMEvent()}},{key:"componentDidUpdate",value:function(e){this.props.childrenCount!==e.childrenCount&&this.updateScrollBarHeight()}},{key:"componentWillUnmount",value:function(){this.unbindDOMEvent&&this.unbindDOMEvent()}},{key:"render",value:function(){var t=this,e=this.props,i=e.customScrollBar,a=e.autoHidden,n=e.className,r=e.style,o=this.state,l=o.scrollBarRatio,c=o.scrollBarHeight,s=o.scrollBarTop,b=l<1&&i,d="4px";return u.a.createElement("div",{className:"b-scroll-view-wrapper",ref:function(e){return t.rootEl=e},style:r||{}},u.a.createElement("ul",{className:p()("b-scroll-view",n,{"b-custom-scroll-view":i,"b-auto-hide":a}),onScroll:function(){return t.onScroll()},ref:function(e){return t.setRef(e)}},this.props.children),b&&u.a.createElement("div",{className:"b-scroll-view-scrollbar",style:{width:d,height:c,transform:"translateY(".concat(s,"px)")}}))}}]),a}(u.a.Component)},vb652:function(e,t,i){"use strict";i.d(t,"a",function(){return n});var a=i("vb143"),n=function(){function e(){Object(a.ov)(this,e),this.increase=10}return Object(a.Pw)(e,[{key:"setContainer",value:function(e){this.dom=e}},{key:"run",value:function(r,o){var l=this;return function e(t){var i=l.dom.scrollTop,a=l.dom.scrollHeight-l.dom.clientHeight-l.dom.scrollTop,n=o||l.increase;if("top"===r){if(0===i)return void l.stop();l.dom.scrollTop=i-n,l.reqA=window.requestAnimationFrame(e)}else if("bottom"===r){if(0===a)return void l.stop();l.dom.scrollTop=i+n,l.reqA=window.requestAnimationFrame(e)}}}},{key:"top",value:function(e){this.reqA&&(window.cancelAnimationFrame(this.reqA),this.reqA=null),this.reqA=window.requestAnimationFrame(this.run("top",e))}},{key:"bottom",value:function(e){this.reqA&&(window.cancelAnimationFrame(this.reqA),this.reqA=null),this.reqA=window.requestAnimationFrame(this.run("bottom",e))}},{key:"stop",value:function(){this.reqA&&(window.cancelAnimationFrame(this.reqA),this.reqA=null)}}]),e}()},vb963:function(e,h,f){"use strict";(function(V){f.d(h,"a",function(){return s}),f.d(h,"b",function(){return r}),f.d(h,"c",function(){return l}),f.d(h,"d",function(){return n});var e,I=f("vb143"),b=f("vb154"),d=f("vb103"),E=f.n(d),t=f("vb159"),C=f.n(t),o=(f("vb147"),f("vb148"),f("vb2173")),S=f("vb2170"),u=f("vb2169"),p=f("vb2183"),k=f("vb111"),_=f("vb308"),a=f("vb445"),i=(f("vb119"),f("vb152"),f("vb121"),f("vb117"),f("vb115"),f("vb112"),f("vb164"),f("vb167"),f("vb113"),f("vb118"),f("vb116"),f("vb120"),f("vb174"),f("vb155"),f("vb201")),v=f("vb447"),n=function(t){function i(e){var r;return Object(I.ov)(this,i),(r=t.call(this,e)||this).viewNameEditor=null,r.onMoreBtnClick=function(e){r.props.onClickViewMoreOptionsBtn&&r.props.onClickViewMoreOptionsBtn(),r.props.onContextMenu(e,r.getBizView(),!0),e.stopPropagation()},r.onMouseEnter=function(){var e=r.props,t=e.setHighlightViewInfo,i=e.view,a=e.highlightViewInfo,n=e.tableId;a&&t&&t("".concat(n,":").concat(i.id))},r.onMouseLeave=function(){var e=r.props,t=e.setHighlightViewInfo;e.highlightViewInfo&&t&&t("")},r.onClickSideBarItem=function(){var e=r.props.onClickSideBarItem,t=r.getBizView();r.props.switchView(t),e&&e(t)},r}return Object(I.bu)(i,t),Object(I.Pw)(i,[{key:"componentDidMount",value:function(){this.checkIsEdit()}},{key:"componentDidUpdate",value:function(e){this.checkIsEdit();var t=this.props,i=t.contextMenuSelectView,a=t.view,n=t.editable;e.editable&&!n&&i&&i.getId()===a.id&&this.props.closeContextMenu()}},{key:"activeRenameInput",value:function(){this.viewNameEditor&&(this.viewNameEditor.focus(),this.viewNameEditor.select())}},{key:"checkIsEdit",value:function(){this.props.editViewId===this.props.view.id&&document.activeElement!==this.viewNameEditor&&this.activeRenameInput()}},{key:"getBizView",value:function(){var e,t=this.props,i=t.tableId,a=t.base,n=t.view;return null===(e=a.getTable(i))||void 0===e?void 0:e.getView(n.id)}},{key:"renderTools",value:function(){var e=this.props,t=e.view,i=e.tableId,a=e.activeTableId,n=e.activeViewId,r=i===a&&t.id===n;return E.a.createElement("div",{className:C()("bitable-common-hover-press-background icon-background bitable-layout-row bitable-layout-cross-center bitable-sidebar-more",{"enhance-visible":r}),onClick:this.onMoreBtnClick},E.a.createElement(o.a,null))}},{key:"renderViewPermIcon",value:function(e){var t=this.props.view;if(void 0===t.publicLevel||t.publicLevel===I.fB.PUBLIC)return null;var i=a.b[t.publicLevel];return E.a.createElement(k.Tooltip,{placement:"top",title:a.c[t.publicLevel]},E.a.createElement(i,{className:C()("bitable-sidebar__item-view-perm-icon")}))}},{key:"render",value:function(){var t=this,e=this.props,i=e.view,a=e.activeViewId,n=e.contextMenuSelectView,r=e.moreBtnClicked,o=e.editViewId,l=e.editable,c=e.tableId,s=e.activeTableId,b=e.highlightViewInfo,d=i.id===o,u=n&&i.id===n.getId(),p=Object(I.zz)(i)&&l&&!d&&!(u&&!r),v=i.id===a&&c===s,m=b?b.split(":"):[],w=Object(I.xz)(m,2),h=w[0],f=w[1],y=i.id===f&&h===c,g=l?function(e){return t.props.onContextMenu(e,t.getBizView())}:void 0;return E.a.createElement("li",{className:C()("bitable-sidebar__item bitable-layout-row bitable-layout-cross-center\n        bitable-noselect J-bitable-sidebar__item",{active:v,inactive:!v,select:u,"more-btn-select":u&&r,"bitable-sidebar__item-hightlight":y,"bitable-sidebar__item-hover":!y}),onClick:function(){return t.onClickSideBarItem()},onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onContextMenu:g},E.a.createElement(I.Mx,{title:i.name,disabled:d||i.type===I.az.NotSupport},E.a.createElement("div",{className:"bitable-sidebar__item-content bitable-layout-row bitable-layout-cross-center"},E.a.createElement("i",{className:"bitable-sidebar__item-icon"},E.a.createElement(_.a,{type:i.type})),d?E.a.createElement("input",{className:"sidebar-input",type:"text",onBlur:function(){return t.props.onViewEditBlur()},onKeyDown:function(e){return t.props.onKeyDown(e)},onFocus:function(){return t.props.onFocus(t.viewNameEditor)},defaultValue:this.props.editName,ref:function(e){return t.viewNameEditor=e}}):E.a.createElement("span",{className:C()("bitable-sidebar__item-text",{"not-support":i.type===I.az.NotSupport}),onDoubleClick:function(){return t.props.onViewRename(t.getBizView())}},E.a.createElement(I.dD,{name:i.name})),i.type===I.az.NotSupport&&E.a.createElement(k.Tooltip,{title:V("bitable.not_support_view_tip"),placement:"bottom",adjustOverflow:!1},E.a.createElement("i",{className:"bitable-sidebar__item-warning"},E.a.createElement(S.a,null))))),this.renderViewPermIcon(p),p&&this.renderTools())}}]),i}(E.a.Component),r=Object(I.oA)(function(e){return{base:e.base}})(n),l=Object(I.oA)(function(e){return{base:e.base}})(e=function(e){function t(){return Object(I.ov)(this,t),e.apply(this,arguments)||this}return Object(I.bu)(t,e),Object(I.Pw)(t,[{key:"shouldComponentUpdate",value:function(e){var t=this.props,i=t.view,a=t.activeViewId,n=t.contextMenuSelectView,r=t.editViewId,o=t.editable,l=t.editName,c=Object(b.a)(i,e.view),s=Object(b.a)(n,e.contextMenuSelectView);return!(c&&s&&a===e.activeViewId&&r===e.editViewId&&o===e.editable&&l===e.editName)}},{key:"render",value:function(){var t=this,e=this.props,i=e.view,a=e.activeViewId,n=e.contextMenuSelectView,r=e.editViewId,o=e.editable,l=e.editName,c=e.moreBtnClicked,s="bitable-sidebar__item_doc bitable-layout-row bitable-layout-cross-center\n      bitable-noselect J-bitable-sidebar__item";if(i.id===r)return E.a.createElement("li",{className:s},E.a.createElement("input",{className:"sidebar-input bitable-f-g-1",type:"text",onBlur:function(){return t.props.onViewEditBlur()},onClick:function(e){return e.stopPropagation()},onKeyDown:function(e){t.props.onKeyDown(e)},onFocus:function(){return t.props.onFocus(t.viewNameEditor)},defaultValue:l,ref:function(e){return t.viewNameEditor=e}}),E.a.createElement("i",{className:"bitable-g-cp bitable-layout-row bitable-layout-cross-center"},E.a.createElement(u.a,{className:"bitable-sidebar-done-icon"})));var b=n&&i.id===n.getId();return E.a.createElement("li",{className:C()(s,{active:i.id===a,select:b,"more-btn-select":b&&c}),onClick:function(){I.cz.collectClickEvent(I.Bc.CcmBitableTitlebarViewOperateClick,{click:I.eB.ViewClick}),t.props.switchView(t.getBizView())}},E.a.createElement(p.a,{className:"sidebar-drag-icon"}),E.a.createElement("i",{className:"bitable-sidebar__item-icon"},E.a.createElement(_.a,{type:i.type})),E.a.createElement(I.Mx,{title:i.name,disabled:i.type===I.az.NotSupport},E.a.createElement("span",{className:C()("bitable-sidebar__item-text bitable-f-g-1",{"not-support":i.type===I.az.NotSupport})},i.name)),o?this.renderTools():null,i.type===I.az.NotSupport&&E.a.createElement(k.Tooltip,{title:V("bitable.not_support_view_tip"),placement:"bottom",adjustOverflow:!1},E.a.createElement("i",{className:"bitable-sidebar__item-warning"},E.a.createElement(S.a,null))))}}]),t}(n))||e,c=["SidebarItemCom"],m=["views","tableId","editable","onScroll","onListRef"],w=Object(i.SortableElement)(function(e){var t=e.SidebarItemCom,i=Object(I.nA)(e,c);return E.a.createElement(t,i)}),s=Object(i.SortableContainer)(function(e){var t=Object(d.useContext)(I.mA);if(!t)return E.a.createElement(E.a.Fragment,null);var a=t.permissionStore,i=e.views,n=e.tableId,r=e.editable,o=e.onScroll,l=e.onListRef,c=Object(I.nA)(e,m),s=r&&1<i.length&&a.hasPermission(I.qy.View,{tableId:n},I.ry.Movable);return E.a.createElement(v.a,{className:"bitable-sidebar-list bitable-layout-column",onScroll:o,onRef:l,childrenCount:i.length,customScrollBar:!0,autoHidden:!0},i.map(function(e,t){var i=!(e.type===I.az.Form)||a.hasPermission(I.qy.Form,{tableId:n},I.ry.Editable);return E.a.createElement(w,Object(I.Kx)({key:e.id,view:e,index:t,tableId:n,disabled:!s,editable:r&&a.hasPermission(I.qy.View,{tableId:n,viewId:e.id},I.ry.Editable)&&i},c))}))})}).call(this,f("vb163"))},vb965:function(e,t,i){"use strict";i.d(t,"a",function(){return c});var a,n,r=i("vb152"),o=i.n(r),d=i("vb143"),l=i("vb123"),c=(a=Object(l.Bind)(),n=function(s){function b(e){var t;Object(d.ov)(this,b),(t=s.call(this,d.Gx.BitableViewPanel)||this).instanceId="",t.getVCFollowId=function(){return t.isMulti?t.instanceId:void 0},t.closeVCFollow=function(){d.rA.info("closeVCFollow",{key:t.moduleKey,instanceId:t.getVCFollowId()}),Object(d.Hx)(t.moduleKey,t.replayVCFollowState,{instanceId:t.getVCFollowId()}),t.checkCloseVCFollow()};var i=e.getState,a=e.enable,n=e.toggleSidebar,r=e.checkTableId,o=void 0!==r&&r,l=e.getCurrentTableId,c=void 0===l?function(){return""}:l;return t.getState=i,t.enable=a&&Object(d.Dx)(),t.toggleSidebar=n,t.checkTableId=o,t.getCurrentTableId=c,a?(t.openVCFollow(),t):Object(d.DF)(t)}return Object(d.bu)(b,s),Object(d.Pw)(b,[{key:"isMulti",get:function(){return!1}},{key:"getStateAndCheck",value:function(){var e=this.getState();return this.checkState(e),e}},{key:"openVCFollow",value:function(){var e=Object(d.uY)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.enable){e.next=2;break}return e.abrupt("return");case 2:d.rA.info("openVCFollow",{key:this.moduleKey,instanceId:this.getVCFollowId(),on:this.enable}),Object(d.Fx)(this.moduleKey,this.replayVCFollowState,{instanceId:this.getVCFollowId()}),this.sendVCStateChange(),this.checkOpenVCFollow();case 6:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"sendVCStateChange",value:function(){var e=this.getStateAndCheck();d.rA.info("sendVCStateChange",{key:this.moduleKey,instanceId:this.getVCFollowId(),on:this.enable,data:e}),this.enable&&Object(d.Ix)(this.moduleKey,e)}},{key:"replayVCFollowState",value:function(e){var t=e.data,i=t.openStatus,a=t.tableId,n=i===d.Dy.Open;if(this.checkTableId){if(!a)return{status:d.dz.Ignore,code:d.ez.NotExist};if(this.getCurrentTableId()!==a)return{status:d.dz.Fail,code:d.ez.SourceTargetIsDiff};this.toggleSidebar(n,a)}else this.toggleSidebar(n);return this.checkReplaySuccess(e.data,d.EF),{status:d.dz.Success}}}]),b}(d.FF),Object(d.lz)(n.prototype,"replayVCFollowState",[a,d.mz],Object.getOwnPropertyDescriptor(n.prototype,"replayVCFollowState"),n.prototype),n)}}]);
//# sourceMappingURL=//slardar.bytedance.net/api_v2/browser/jserr/get_sourcemap?bid=docs_pc&js_filename=embed-sheet-side-bar.923823a35f.chunk.js