(window.webpackJsonp=window.webpackJsonp||[]).push([["ec1987e04166"],{vb1304:function(e,k,O){"use strict";O.r(k),function(s){O.d(k,"GalleryViewLayer",function(){return x});var e,t=O("vb152"),c=O.n(t),C=O("vb143"),o=O("vb145"),n=O("vb103"),b=O.n(n),i=(O("vb147"),O("vb148"),O("vb118"),O("vb116"),O("vb120"),O("vb110"),O("vb111"),O("vb114")),d=O("vb653"),v=O("vb326"),p=O("vb292"),u=O("vb358"),m=O("vb413"),f=O("vb495"),r=(O("vb129"),O("vb223"),O("vb214"),O("vb232"),O("vb187"),O("vb174"),O("vb225"),O("vb224"),O("vb128"),O("vb122"),O("vb115"),O("vb112"),O("vb119"),O("vb113"),O("vb167"),O("vb164"),O("vb233"),O("vb234"),O("vb235"),O("vb123"),O("vb236"),O("vb193"),O("vb237"),O("vb155"),O("vb238"),O("vb124"),O("vb239"),O("vb104"),O("vb159"),O("vb121"),O("vb117"),O("vb240"),O("vb134"),O("vb131"),O("vb226"),O("vb241"),O("vb125"),O("vb242"),O("vb127"),O("vb132"),O("vb227"),O("vb135"),O("vb228"),O("vb229"),O("vb133"),O("vb126"),O("vb243"),O("vb262"),O("vb244"),O("vb245"),O("vb246"),O("vb247"),O("vb194"),O("vb248"),O("vb249"),O("vb201"),O("vb260"),O("vb267"),O("vb250"),O("vb136"),O("vb251"),O("vb130"),O("vb252"),O("vb356"),function(e){var t=e.permission,n=e.tableId,i=e.editable,o=e.recordId,r=e.operator,a=e.isSyncTable,c=!a&&!Object(m.g)({permission:t,tableId:n,editable:i}),l=a,d=Object(f.h)({isSyncTable:a});return{id:p.a.InsertLeft,text:s("bitable.insert_record_left"),icon:b.a.createElement(C.IB.AddLeftIconSvg,{className:"icon"}),onClick:function(){r.onInsertRow(o,null,C.qC.Left),Object(u.a)(C.LK.InsertLeft)},hidden:c,disabled:l,tooltipConfig:d}}),a=function(e){var t=e.permission,n=e.tableId,i=e.editable,o=e.recordId,r=e.operator,a=e.isSyncTable,c=!a&&!Object(m.g)({permission:t,tableId:n,editable:i}),l=a,d=Object(f.h)({isSyncTable:a});return{id:p.a.InsertRight,text:s("bitable.insert_record_right"),icon:b.a.createElement(C.IB.AddRightIconSvg,{className:"icon"}),onClick:function(){r.onInsertRow(o,null,C.qC.Right),Object(u.a)(C.LK.InsertRight)},hidden:c,disabled:l,tooltipConfig:d}},l=function(e){var t=e.showComment,n=e.operator;return Object(f.d)({hidden:!t,onClick:function(){n.onAddComment(e.recordId),Object(u.a)(C.LK.AddComment,{target:C.Rw.CcmCommentView})}})},w=function(e){var t=e.recordId,n=e.operator,i=C.ob.config.ui.disableRecordCardMode;return Object(f.f)({onClick:function(){n.onShowEditPopup(t),Object(u.a)(C.LK.ExpandRecord,{target:C.Rw.CcmBitableCardView})},hidden:i})},h=function(e){var t=e.recordId,n=e.permission,i=e.tableId,o=e.editable,r=e.view,a=e.operator,c=e.isSyncTable,l=!c&&!Object(m.a)({permission:n,tableId:i,viewId:r.id,editable:o,recordId:t}),d=c,s=Object(f.h)({isSyncTable:c});return Object(f.e)({hidden:l,onClick:function(){a.onDeleteRow([t]),Object(u.a)(C.LK.DeleteRecord)},disabled:d,tooltipConfig:s})},I=function(e){var t=e.view,n=e.recordId,i=e.operator,o=t.table.getPrimaryKey();return n&&o?Object(f.c)({onClick:function(){return i.onCopyLink(n,o)},hidden:Boolean(C.ob.config.disableRecordLink)}):null},y=function(e){var t=e.permission,n=e.tableId,i=e.editable,o=e.recordId,r=e.operator,a=function(){r.onCopyRecord(o,null),Object(u.a)(C.LK.Copy)},c=!Object(m.g)({permission:t,tableId:n,editable:i});return Object(f.g)({hidden:c,onClick:a})},g=Object(C.Ww)({},p.b.GalleryCardContextMenu,[r,a,y,w,I,l,h]),x=Object(i.connect)(function(e,t){var n=Object(C.Fz)(e),i=n&&n.status.translated;return{isNotDefaultMode:Object(C.yx)(e),haveCommentPermission:Object(C.Hz)(e)&&!i,isCommentDataInit:Object(C.By)(e)}},null)(e=function(t){function i(e){var f,n;return Object(C.ov)(this,i),(f=t.call(this,e)||this).selfDom=null,f.hyperLinkRef=null,f._showMentionPopover=function(e){var t="",n="";e.mentionType===C.mx.User&&(t=Object(o.a)(f.activeTable.getI18nUserItemById(e.token),"name","")),f.props.smartableMentionManager&&f.props.smartableMentionManager.getMentionInfoByUserId(f.props.tableId,e.token)&&(n=f.props.tableId),C.lx.open(Object.assign({name:t,tableId:n},e))},f.executeMoveRecrod=function(e){var t=e.recordId,n=e.from,i=e.to,o=e.afterRecordId,r=f.props,a=r.bitableStore,c=r.tableId,l=r.viewId;a.getCommandManager().execute({cmd:C.Fy.MoveRecords,tableId:c,viewId:l,records:[t],target:i,afterRecordId:o}),C.ob.collectBitableEvent(C.On.BitableRecordMove,{table_id:f.activeTable.id,view_id:f.activeView.id,bitable_view_type:C.Cz[f.activeView.type],data_source:f.props.bitableStore.Options.module},!0),C.cz.collectClickEvent(C.Bc.CcmBitableRecordDragClick,{click:C.QK.RecordDrag,from_card_idx:String(n),to_card_idx:String(i)})},f.getViewOperation=function(){return{onDeleteRow:f.onDeleteRow,onInsertRow:f.executeAddRecord,onShowEditPopup:f.onShowEditPopup,onAddComment:f.onAddComment,onCopyRecord:f.executeCopyRecord,onCopyLink:f.onCopyLink}},f.executeSetCheckbox=function(e){var t=Object(C.Cx)(f).activeTable,n=f.props,i=n.bitableStore,o=n.viewId,r=e.isChecked,a=e.recordId,c=e.field;i.getCommandManager().execute({cmd:C.Fy.SetRecord,tableId:t.id,recordId:a,viewId:o,data:Object(C.Ww)({},c.getId(),{type:c.getType(),value:r})})},f.handleFieldListClick=function(e){var t=f.props.showCardModal;t&&t(e.recordId)},f.handleCardContextMenu=function(e){var t=f.props,n=t.bitableStore,i=t.editable,o=t.tableId,r=t.haveCommentPermission,a=t.isCommentDataInit,c=t.contextMenuService,l=n.getPermissionStore(),d=Object(v.b)(n.bitableConfig)&&r&&a,s=f.getViewOperation(),b=n.isSyncTable(o),u=Object.assign({},e,{tableId:o,view:f.activeView,permission:l,editable:i,showComment:d,operator:s,isSyncTable:b});null==c||c.showContextMenu(p.b.GalleryCardContextMenu,{getContextMenuConfig:function(){var e;return{x:f.props.contextMenuPositionX,y:f.props.contextMenuPositionY,hidden:null===(e=f.props.bitableStore.bitableConfig.ui)||void 0===e?void 0:e.disableContextMenu}},getContext:function(){return u}})},f.handleGalleryWidgetClick=function(){f.props.smartableCommentManager&&f.props.smartableCommentManager.handleDeactivateComment()},f.getAddRecordIndex=function(e,t){var n=Object(C.Cx)(f).activeView,i=e?n.getAllRecordIndexById(e):0;return t===C.qC.Right?i+1:i},f.executeAddRecordCmd=function(e,t){var n=Object(C.Cx)(f),i=n.activeTable,o=n.activeView,r=f.props.bitableStore,a=f.getAddRecordIndex(e,t);return r.getCommandManager().execute({cmd:C.Fy.AddRecord,tableId:i.id,viewId:o.id,index:a})},f.executeAddRecord=function(e,t,n){var i=Object(C.Cx)(f),o=i.activeTable,r=i.activeView,a=f.props,c=a.bitableStore,l=a.showCardModal,d=a.showEditor,s=a.addRecordInCard,b=a.renderer,u=f.getAddRecordIndex(e,n);if(s)f.props.onAddRecord&&f.props.onAddRecord(null,u,n);else{var v=f.executeAddRecordCmd(e,n);if(setTimeout(function(){b.activeBitableWidget.getGalleryWidget().revealRecord(e,void 0,!0)},1e3),v&&v.result===C.Ey.Success){var p=c.getBasePermission(C.ry.Manageable),m=c.base.isPro();p||!m||s?l(v.data.recordId,void 0,void 0,!0):d&&d({showNewCardEditor:C.mL.NEW_CARD,groupValue:"",recordId:v.data.recordId,editorNeedUndo:!0,addTriggerButton:C.IF.TopButton}),C.ob.collectBitableEvent(C.On.BitableRecordAdd,{table_id:o.id,view_id:r.id,bitable_view_type:C.Cz[r.type],bitable_record_direction:n||C.qC.Default,data_source:c.Options.module,action:C.UC.Click,record_number:1},!0)}}},f.onCopyLink=(n=Object(C.uY)(c.a.mark(function e(t,n){var i,o,r,a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=f.props,o=i.viewId,r=i.tableId,a=i.renderer,e.next=3,Object(d.a)({tableId:r,viewId:o,renderer:a,fieldId:n,recordId:t});case 3:case"end":return e.stop()}},e)})),function(e,t){return n.apply(this,arguments)}),f.onAddComment=function(e){var t=f.props,n=t.smartableCommentManager,i=t.mountOption;e&&n&&(n.triggerCreateComment(e,C.YH.ContextMenu,i),C.cz.collectBitableEvent(C.Rw.CcmCommentView,{sub_view:"part_comment"}))},f.onShowEditPopup=function(e){f.props.showCardModal(e)},f.executeCopyRecord=function(t,e,n){var i=Object(C.Cx)(f),o=i.activeTable,r=i.activeView,a=f.props,c=a.bitableStore;if(a.addRecordInCard)f.props.onAddRecord&&f.props.onAddRecord(null,f.getAddRecordIndex(t,n),n);else{var l=c.getCommandManager(),d=o.getFieldIds().filter(function(e){return null!=o.getCellValue(t,e)}),s=f.executeAddRecordCmd(t,n);s&&s.result===C.Ey.Success&&l.execute({cmd:C.Fy.PasteSetRecords,tableId:o.id,viewId:r.id,fields:d,stdValues:r.getStdValueMatrixFromIds({fieldIds:d,recordIds:[t]},!1).stdValueMatrix,pasteTargetFieldIds:d,pasteRecordIds:[s.data.recordId]})}},f.onClickHyperLink=function(e){if(e&&f.hyperLinkRef){var t=Object(C.Cx)(f),n=t.activeTable,i=t.activeView;f.hyperLinkRef.onClickHyperLink(Object.assign({},e,{activeTable:n,activeView:i}))}},f.onClickMention=function(e){var t=Object(C.Cx)(f),n=t.activeTable,i=t.activeView;C.lx.openMention(Object.assign({},e,{activeTable:n,activeView:i}))},f.onDeleteRow=function(e){var t=f.props.bitableStore.getCommandManager(),n=f.activeTable.id;t.execute({cmd:C.Fy.DeleteRecords,tableId:n,viewId:f.activeView.id,recordIds:e}),f.closeContextMenu()},f.copyCard=function(e){f.executeCopyRecord(e,C.qC.Right),f.closeContextMenu()},f.closeContextMenu=function(){var e;null===(e=f.props.contextMenuService)||void 0===e||e.closeContextMenu()},f.setRef=function(e){f.selfDom=e},f.setHyperLinkRef=function(e){f.hyperLinkRef=e},f.state={tooltip:{show:!1,x:0,y:0,width:0,height:0,title:""}},f.initContextMenuService(),f}return Object(C.bu)(i,t),Object(C.Pw)(i,[{key:"componentDidMount",value:function(){this.updateActiveModel(this.props)&&(this.clearListener=this.bindFasterEvent(this.activeTable,this.activeView))}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.props.tableId===e.tableId&&this.props.viewId===e.viewId||(this.clearListener&&this.clearListener(),this.updateActiveModel(e)&&(this.clearListener=this.bindFasterEvent(this.activeTable,this.activeView)));var t=e.view,n=this.props.view;this.props.tableId===e.tableId&&t&&n&&t.id===n.id&&t.publicLevel!==n.publicLevel&&t.publicLevel===C.fB.PERSONAL&&(this.closeContextMenu(),this.setState({tooltip:Object.assign({},this.state.tooltip,{show:!1})}))}},{key:"componentWillUnmount",value:function(){this.clearListener&&this.clearListener()}},{key:"updateActiveModel",value:function(e){var t=e.bitableStore,n=e.tableId,i=e.viewId,o=t.base.getTableById(n),r=o&&o.getViewById(i);return!(!o||!r||(this.activeTable=o,this.activeView=r,0))}},{key:"bindFasterEvent",value:function(e,t){var n,i,s=this,o=this.props.renderer.activeBitableWidget,r=this.props.smartableCommentManager,a=o.getGalleryWidget(),c=(Object(C.Ww)(n={},C.sC.CardContextMenu,this.handleCardContextMenu),Object(C.Ww)(n,C.sC.FieldListClick,this.handleFieldListClick),Object(C.Ww)(n,C.sC.MouseWheel,this.closeContextMenu),Object(C.Ww)(n,C.sC.MoveRecord,this.executeMoveRecrod),Object(C.Ww)(n,C.sC.AddRecord,function(e){var t=e.recordId,n=e.direction;s.executeAddRecord(t,null,n)}),Object(C.Ww)(n,C.sC.ClickCheckbox,this.executeSetCheckbox),Object(C.Ww)(n,C.sC.ClickMention,this.onClickMention),Object(C.Ww)(n,C.sC.ClickHyperlink,this.onClickHyperLink),Object(C.Ww)(n,C.sC.GalleryWidgetClick,this.handleGalleryWidgetClick),n),l=(Object(C.Ww)(i={},C.kC.ShowTooltip,function(e){var t=e.x,n=e.y,i=e.width,o=e.height,r=e.title,a=e.direction,c=e.className,l=e.style,d=e.showArrow;s.setState({tooltip:{x:t,y:n,width:i,height:o,title:r,show:!0,direction:a,className:c,style:l,showArrow:d}})}),Object(C.Ww)(i,C.kC.ShowReminderTooltip,function(e){var t=e.x,n=e.y,i=e.reminder,o=e.direction,r=e.className,a=Object(C.RK)(i,s.activeTable);s.setState({tooltip:{x:t,y:n,title:a,show:!0,direction:o,className:r}}),C.ob.collectBitableEvent(C.On.SetBitableReminder,{action:C.SK.HOVER_CLOCK_ICON,table_id:s.props.tableId,view_id:s.props.viewId,bitable_view_type:C.Cz[C.az.Gallery],source:C.mC.OUTSIZE_RECORD_DETAIL})}),Object(C.Ww)(i,C.kC.HideTooltip,function(){s.setState({tooltip:Object.assign({},s.state.tooltip,{show:!1})})}),Object(C.Ww)(i,C.kC.ShowMentionPopover,this._showMentionPopover),Object(C.Ww)(i,C.kC.HideMentionPopover,C.lx.close),Object(C.Ww)(i,C.kC.ShowViewLockedModal,function(e){return Object(d.b)({bitableStore:s.props.bitableStore,renderer:s.props.renderer,source:e,operate:s.props.operate})}),Object(C.Ww)(i,C.kC.CommentBubbleClick,function(e){C.cz.collectClickEvent(C.Bc.CcmBitableRecordCommentClick,{click:"click_record",target:C.Rw.CcmCommentView}),r&&r.onCommentBubbleClick(e)}),Object(C.Ww)(i,C.kC.FasterWidthChange,function(){r&&r.notifyCommentUpdate()}),Object(C.Ww)(i,C.kC.ShowAttachPopover,function(e){f.a.open(e)}),Object(C.Ww)(i,C.kC.HideAttachPopover,function(){f.a.close()}),i);return a.events.addListeners(c),o.events.addListeners(l),function(){a.events.removeListeners(c),o.events.removeListeners(l)}}},{key:"initContextMenuService",value:function(){var e=this.props,i=e.bitableStore,t=e.contextMenuService,n=Object(C.Ww)({},p.b.GalleryCardContextMenu,function(e,t){if(i.isEmbedded||i.Options.isHistoryMode||i.Options.module===C.Bz.Template)return Object.assign({},e,{items:e.items.filter(function(e){return e.id!==p.a.CopyLink})});var n=e.items.find(function(e){return e.id===p.a.DeleteRecord});return n&&Object(f.i)(n,i,t),e});null==t||t.setContextMenus(g),null==t||t.setContextServiceOption({customContextMenus:n})}},{key:"render",value:function(){var e=this.state.tooltip;return b.a.createElement("div",{ref:this.setRef},b.a.createElement(C.uL,{ref:this.setHyperLinkRef}),b.a.createElement(C.vL,{container:this.props.tooltipOverlayRef,x:e.x,y:e.y,width:e.width,height:e.height,title:e.title,visible:e.show,direction:e.direction,className:"".concat(e.className),style:e.style,showArrow:e.showArrow}))}}]),i}(b.a.PureComponent))||e}.call(this,O("vb163"))},vb292:function(e,t,n){"use strict";var i,o,r,a;n.d(t,"a",function(){return o}),n.d(t,"b",function(){return i}),(a=i||(i={})).GridContentContextMenu="GridContentContextMenu",a.GridFieldHeaderMenu="GridFieldHeaderMenu",a.GridGroupTitleContextMenu="GridGroupTitleContextMenu",a.KanbanCardContextMenu="KanbanContextMenu",a.KanbanCardListMoreContextMenu="KanbanCardListMoreContextMenu",a.GalleryCardContextMenu="GalleryCardContextMenu",a.GanttBarContextMenu="GanttBarContextMenu",a.BlockCreationMenu="BlockCreationMenu",a.BlockContextMenu="BlockContextMenu",(r=o||(o={})).InsertAbove="InsertAbove",r.InsertBelow="InsertBelow",r.InsertLeft="InsertLeft",r.InsertRight="InsertRight",r.ExpendRow="ExpendRow",r.CopyLink="CopyLink",r.Comment="Comment",r.FilterItem="FilterItem",r.Reminder="Reminder",r.DeleteRecord="DeleteRecord",r.ExpendSubGroups="ExpendSubGroups",r.FoldSubGroups="FoldSubGroups",r.ModifyField="ModifyField",r.ModifyDescription="ModifyDescription",r.DuplicateField="DuplicateField",r.InsertFieldLeft="InsertFieldLeft",r.InsertFieldRight="InsertFieldRight",r.FrozenField="FrozenField",r.SetSortAZ="SetSortAZ",r.SetSortZA="SetSortZA",r.SetGroup="SetGroup",r.SetFilter="SetFilter",r.CreateView="CreateView",r.HideField="HideField",r.DeleteField="DeleteField",r.CopyRecord="CopyRecord",r.GroupRename="GroupRename",r.DeleteGroup="DeleteGroup",r.ExportAttachment="ExportAttachment",r.DeleteGanttTask="DeleteGanttTask",r.AddTable="AddTable",r.AddDashboard="AddDashboard",r.RenameBlock="RenameBlock",r.CopyTable="CopyTable",r.DeleteBlcok="DeleteBlcok",r.CopyBlock="CopyBlock"},vb326:function(e,t,n){"use strict";function i(e){var t;return(null==e||null===(t=e.ui)||void 0===t?void 0:t.showComment)||!1}function o(e){return!(null!=e&&e.disableReminder)}n.d(t,"a",function(){return o}),n.d(t,"b",function(){return i})},vb356:function(e,i,o){"use strict";(function(d){o.d(i,"a",function(){return n}),o.d(i,"b",function(){return u});var e=o("vb152"),s=o.n(e),b=o("vb143");o("vb147"),o("vb103"),o("vb148");function u(e,t,n,i){var o=Object(b.uO)({table:e,view:t,record:n,field:i});return"".concat(location.origin).concat(location.pathname,"?").concat(o)}var t,n=(t=Object(b.uY)(s.a.mark(function e(t){var n,i,o,r,a,c,l;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.viewId,i=t.tableId,o=t.recordId,r=t.fieldId,a=t.onCopy,c=void 0===a?function(){return!0}:a,l=u(i,n,o,r),e.next=4,c(l);case 4:e.sent?b.ob.Toast.show({type:"info",content:d("Bitable_Record_CopyLinkSuccessfullyToast"),duration:3e3,closable:!1}):b.ob.Toast.show({type:"info",content:d("Bitable_Record_UnableToCopyLinkToast"),duration:3e3,closable:!1});case 6:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)})}).call(this,o("vb163"))},vb358:function(e,t,n){"use strict";n.d(t,"a",function(){return l}),n.d(t,"b",function(){return v}),n.d(t,"c",function(){return c}),n.d(t,"d",function(){return d});var i,o,u=n("vb143"),r=(Object(u.Ww)(i={},u.og.SingleSelect,u.zL.Rename),Object(u.Ww)(i,u.og.MultiSelect,u.zL.Rename),Object(u.Ww)(i,u.og.User,u.zL.ChangeThePerson),Object(u.Ww)(i,u.og.SingleLink,u.zL.ChangeTheRecord),Object(u.Ww)(i,u.og.DuplexLink,u.zL.ChangeTheRecord),i),a=(Object(u.Ww)(o={},u.og.User,u.Rw.CcmMentionPanelView),Object(u.Ww)(o,u.og.SingleLink,u.Rw.CcmBitableRelationFieldModifyView),Object(u.Ww)(o,u.og.DuplexLink,u.Rw.CcmBitableRelationFieldModifyView),o),c=function(e){u.cz.collectClickEvent(u.Bc.CcmBitableKanbanGroupMoreClick,{click:r[e.type],target:a[e.type]})},l=function(e,t){u.cz.collectClickEvent(u.Bc.CcmBitableRecordOperateClick,Object.assign({click:e},t))},v=function(e,t,n){u.cz.collectClickEvent(u.Bc.CcmBitableFieldOperateClick,Object.assign({click:u.AL[e],target:n||u.Rw.None},t))},d=function(e,t,n){var i=n.isIndexColumn,o=n.fieldType,r=n.indexes,a=n.tempFrozenColCount;if(Object(u.kD)(e)){var c=e.getFrozenColumnCount(),l=c,d=r[0],s=e.mapVisibleColToRealCol(d);(t===u.BL.InsertLeft?s:s+1)<c&&(l+=1);var b=0===a?0:e.mapVisibleColToRealCol(a-1)+1;if(c!==l)return void v(t,{is_index_column:i,field_type:o,before_freeze_field_count:c,after_freeze_field_count:l,is_temporary_frozen:(b<l).toString()})}v(t,{is_index_column:i,field_type:o})}},vb413:function(e,t,n){"use strict";n.d(t,"a",function(){return b}),n.d(t,"b",function(){return i}),n.d(t,"c",function(){return o}),n.d(t,"d",function(){return r}),n.d(t,"e",function(){return c}),n.d(t,"f",function(){return u}),n.d(t,"g",function(){return s}),n.d(t,"h",function(){return d}),n.d(t,"i",function(){return l});var a=n("vb143"),i=function(e){var t=e.permission,n=e.editable,i=e.tableId,o=e.recordId,r=e.viewId;return n&&t.hasPermission(a.qy.Record,{tableId:i,viewId:r,recordId:o},a.ry.Editable)},o=function(e){var t=e.fieldId,n=e.permission,i=e.tableId;return n.hasPermission(a.qy.Field,{tableId:i,fieldId:t},a.ry.Editable)},r=function(e){var t=e.permission,n=e.tableId;return t.hasPermission(a.qy.Field,{tableId:n},a.ry.Addable)},c=function(e){var t=e.permission,n=e.tableId,i=e.fieldId;return t.hasPermission(a.qy.Field,{tableId:n,fieldId:i},a.ry.Copyable)},l=function(e){var t=e.permission,n=e.view,i=e.tableId,o=e.fieldIndexes,r=n.getVisibleFields();return o.map(function(e){return r[e]}).every(function(e){return t.hasPermission(a.qy.Field,{tableId:i,viewId:n.id,fieldId:e},a.ry.Deletable)})},d=function(e){var t=e.permission,n=e.tableId;return t.hasPermission(a.qy.View,{tableId:n},a.ry.Addable)},s=function(e){var t=e.permission,n=e.editable,i=e.tableId;return n&&t.hasPermission(a.qy.Record,{tableId:i},a.ry.Addable)},b=function(e){var t=e.permission,n=e.editable,i=e.tableId,o=e.viewId,r=e.recordId;return n&&t.hasPermission(a.qy.Record,{tableId:i,viewId:o,recordId:r},a.ry.Deletable)},u=function(e){var t=e.permission,n=e.tableId,i=e.viewId;return e.editable&&t.hasPermission(a.qy.View,{tableId:n,viewId:i},a.ry.Editable)}},vb495:function(e,x,k){"use strict";(function(d){k.d(x,"a",function(){return g}),k.d(x,"b",function(){return o}),k.d(x,"c",function(){return l}),k.d(x,"d",function(){return c}),k.d(x,"e",function(){return s}),k.d(x,"f",function(){return b}),k.d(x,"g",function(){return v}),k.d(x,"h",function(){return p}),k.d(x,"i",function(){return m}),k.d(x,"j",function(){return t}),k.d(x,"k",function(){return h}),k.d(x,"l",function(){return u}),k.d(x,"m",function(){return r});var f=k("vb103"),C=k.n(f),w=k("vb143"),n=k("vb292"),e=(k("vb147"),k("vb148"),k("vb110")),i=k.n(e),a=(k("vb152"),k("vb112"),k("vb164"),k("vb167"),k("vb113"),k("vb155"),k("vb116"),k("vb118"),k("vb120"),k("vb174"),k("vb119"),k("vb121"),k("vb117"),k("vb115"),k("vb111"));function t(e){var t=e.text;return Object.assign({},e,{id:n.a.InsertAbove,icon:C.a.createElement(w.IB.AddRightIconSvg,{className:"icon rotate-270"}),text:t||d("bitable.grid_insert_record_above",1)})}function o(e){var t=e.text;return Object.assign({},e,{id:n.a.InsertAbove,icon:C.a.createElement(w.IB.AddLeftIconSvg,{className:"icon rotate-270"}),text:t||d("bitable.grid_insert_record_below",1)})}function r(e){var t=e.text;return Object.assign({},e,{id:n.a.Reminder,text:t||d("smartable.reminder.reminder_helper_title"),icon:C.a.createElement(w.IB.ReminderSvg,{className:"icon"})})}function c(e){var t=e.text;return Object.assign({},e,{id:n.a.Comment,text:t||d("bitable.add_comment"),icon:C.a.createElement(w.IB.CommentSvg,{className:"icon"})})}function l(e){return Object.assign({},e,{id:n.a.CopyLink,text:d("Bitable_Record_CopyRecordLink"),icon:C.a.createElement(w.IB.UrlSvg,{className:"icon"})})}var s=function(e){var t=e.text;return Object.assign({},e,{id:n.a.DeleteRecord,text:t||d("bitable.delete_record"),icon:C.a.createElement(w.IB.DeleteIconSvg,{className:"icon"}),isDivider:!0})},b=function(e){var t=e.text;return Object.assign({},e,{id:n.a.ExpendRow,text:t||d("bitable.expand_record"),icon:C.a.createElement(w.IB.ExpandRecordIconSvg,{className:"icon"})})};function u(e){var t=e.text;return Object.assign({},e,{id:n.a.FilterItem,text:C.a.createElement(w.ix,{className:"bitable-layout-row bitable-layout-cross-center",name:d("bitable.common_filter_from_value")},C.a.createElement("p",{className:"b-menu__field_text"},t||d("common.unnamed_value"))),icon:C.a.createElement(w.IB.FilterSvg,{className:"icon"})})}function v(e){var t=e.text;return Object.assign({},e,{id:n.a.CopyRecord,text:t||d("Bitable_Record_Duplicate"),icon:C.a.createElement(w.IB.CopyIconSvg,{className:"icon"})})}var p=function(e){var t=e.isSyncTable,n=e.isNoSpaceToFreeze;return t?{placement:"top",title:d("Bitable_DataReference_SyncFromOtherBase_ActionNotSupported_Tooltip")}:n?{title:d("Bitable_Freeze_NoSpaceToFreeze_Tooltip")}:void 0};function m(e,t,n){var i=n.tableId,o=n.recordId,r=t.getBasePermission(w.ry.Editable),a=t.hasPermission(w.qy.Record,{tableId:i,recordId:o},w.ry.Editable),c=t.hasPermission(w.qy.Record,{tableId:i,recordId:o},w.ry.Deletable),l=w.wL.getTableRecordOperationPermission(t,i,w.Od.DeleteRecord);r&&a&&!c&&!1===l&&(e.disabled=!0,e.hidden=!1,e.tooltipConfig={title:d("Bitable_AdvancedPermission_NoPermissionToDeleteRecord"),placement:"left"})}function h(e,t,n){w.cz.collectClickEvent(w.Bc.CcmBitableCellEditClick,{field_type:t&&w.lC[t],edit_cell_type:e,click:"cell_content_change",is_empty:n&&0!==String(n).length?"false":"true"})}var I=function(e){var t=e.name,n=e.attachmentToken,i=e.thumbnailUrl,o=e.tableId,r=e.extra,a=e.mimeType,c=e.base64Data,l=Object(f.useState)(),d=Object(w.xz)(l,2),s=d[0],b=d[1],u=Object(f.useState)(),v=Object(w.xz)(u,2),p=v[0],m=v[1];return Object(f.useEffect)(function(){m(Object(w.xL)(t)),i?b(i):w.WI.getBlobUrl({attach:{attachmentToken:n,name:t,tableId:o,extra:r,mimeType:a,base64Data:c},updateCallback:function(e){b(e.coverUrl)},quality:w.yL.HIGH,isUseCacheBeforeFetchNew:!0})},[n,i,t,o,r,a,c]),C.a.createElement("div",{className:"attachment-popover-container"},C.a.createElement("div",{className:"attachment-popover-title"},t),C.a.createElement("div",{className:"attachment-popover-img-container"},s?C.a.createElement("img",{className:"attachment-popover-img",src:s}):C.a.createElement("img",{className:"attachment-popover-default-img",src:p})))},y=["rect"],g=function(o){function r(){var e;Object(w.ov)(this,r);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return(e=o.call.apply(o,[this].concat(n))||this).state={visible:!1,contentProps:null,rectStyle:{top:"0",left:"0",width:"0",height:"0"}},e}return Object(w.bu)(r,o),Object(w.Pw)(r,[{key:"show",value:function(e){var t=this,n=e.rect,i=Object(w.nA)(e,y);this.setState({rectStyle:{top:"".concat(n.y,"px"),left:"".concat(n.x,"px"),width:"".concat(n.width,"px"),height:"".concat(n.height,"px")}},function(){t.setState({visible:!0,contentProps:i})})}},{key:"hide",value:function(){this.setState({visible:!1})}},{key:"render",value:function(){var e=this.state,t=e.contentProps,n=e.visible,i=e.rectStyle;return C.a.createElement(a.Popover,{content:t?C.a.createElement(I,t):null,visible:n,overlayClassName:"attachment-popover-overlay"},C.a.createElement("div",{style:Object.assign({position:"fixed",pointerEvents:"none",zIndex:-999},i)}))}}],[{key:"open",value:function(t){r.instantiation?r.instantiation.show(t):(r.dom||(r.dom=document.createElement("div"),document.body.appendChild(r.dom)),i.a.render(C.a.createElement(r,{ref:function(e){return r.instantiation=e}}),r.dom,function(){var e;return null===(e=r.instantiation)||void 0===e?void 0:e.show(t)}))}},{key:"close",value:function(){var e;null===(e=r.instantiation)||void 0===e||e.hide()}}]),r}(f.PureComponent);g.dom=null,g.instantiation=null}).call(this,k("vb163"))},vb653:function(e,d,s){"use strict";(function(f){s.d(d,"a",function(){return a}),s.d(d,"b",function(){return r});var t,i,o,e=s("vb152"),b=s.n(e),C=s("vb143"),n=(s("vb147"),s("vb103")),w=s.n(n),c=(s("vb148"),s("vb356")),l=s("vb358"),h=(o=Object(C.uY)(b.a.mark(function e(t,n,i){var o,r,a,c,l,d,s;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=t.bitableStore,r=t.renderer,a=t.operate,c=o.base,!(l=c.getTableById(n))){e.next=11;break}return e.next=6,a.tableOperate.copyView({tableId:n,viewId:i});case 6:if(!(d=e.sent)||d.result!==C.Ey.Success){e.next=11;break}return s=l.views[d.data.index],r.switchView(o.base,n,d.data.viewId),e.abrupt("return",s);case 11:return e.abrupt("return",null);case 12:case"end":return e.stop()}},e)})),function(e,t,n){return o.apply(this,arguments)}),u=function(t){return new Promise(function(e){Object(C.HU)({title:f("bitable.view_attribute_unlock_popup_title"),content:w.a.createElement(C.ix,{name:f("bitable.view_attribute_unlock_popup_description")},w.a.createElement("span",{className:"bitable-view-unlock-confirm-modal-view-name"},t)),enableCancelButton:!0,wrapClassName:"bitable-view-unlock-confirm-modal",onOk:function(){return e(!0)},onCancel:function(){return e(!1)},okText:f("common.confirm"),cancelText:f("common.cancel")})})},I=(i=Object(C.uY)(b.a.mark(function e(t,n,i){var o,r,a,c,l,d,s;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=t.bitableStore,r=o.base,!(a=r.getTableById(n))){e.next=11;break}if(c=a.getViewById(i)){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,u(c.name);case 9:e.sent&&(C.ob.collectBitableEvent(C.On.BitableViewAttribute,{tableId:n,viewId:i,bitable_view_type:C.Cz[c.type],source:t.source,action:"confirm",attribute:C.YB[C.fB.PUBLIC]}),l=o.getCommandManager(),(d=l.execute({cmd:C.Fy.SetViewPublicLevel,tableId:n,viewId:i,publicLevel:C.fB.PUBLIC}))&&d.result===C.Ey.Success&&(s="un_lock_toast_key",C.ob.Toast.show({key:s,type:"success",content:f("bitable.view_attribute_unlock_successfully"),duration:3e3})));case 11:case"end":return e.stop()}},e)})),function(e,t,n){return i.apply(this,arguments)}),r=function(e){var a=e.renderer,t=e.bitableStore;if(t.getBasePermission(C.ry.Editable)){var c=a.getActiveTableId(),n=a.getActiveView();if(n&&n.viewPermission.publicLevel===C.fB.LOCKED){var i,l=n.id,d=a.reduxStore,o=function(){var e=d.getState(),t=e&&e.bitable&&e.bitable.Tables&&e.bitable.Tables.tableMap,n=!!t[c],i=n&&t[c].viewMap[l],o=a.getActiveViewId()===l,r=i&&t[c].viewMap[l].publicLevel===C.fB.LOCKED;!(n&&i&&r&&o)&&m()},r=function(){t.getBasePermission(C.ry.Editable)||m()},s=d.subscribe(o);t.getPermissionStore().subscribe(r);var b={tableId:c,viewId:l,bitable_view_type:C.Cz[n.type],source:e.source},u=function(){C.ob.collectBitableEvent(C.On.BitableViewProtectPopup,Object.assign({},b,{action:"unprotect"})),I(e,c,l)},v=function(){C.ob.collectBitableEvent(C.On.BitableViewProtectPopup,Object.assign({},b,{action:"saveas"})),h(e,c,l)},p=t.hasPermission(C.qy.View,{tableId:c,viewId:l},C.ry.Editable)&&t.hasPermission(C.qy.View,{tableId:c,viewId:l},C.ry.Lockable);i=Object(C.HU)({title:f("Bitable_AdvancedPermission_ViewLocked_Title"),content:w.a.createElement("div",{className:"bitable-layout-row bitable-layout-cross-center"},w.a.createElement("span",{className:"bitable-view-locked-tip-modal-text"},f("bitable.view_attribute_cannot_edit"))),maskClosable:!0,wrapClassName:"bitable-view-locked-tip-modal",enableCancelButton:p,cancelButtonProps:{onClick:function(){u(),m()}},onOk:function(){v(),m()},onCancel:m,cancelText:f("bitable.view_attribute_button_unlock"),okText:f("bitable.view_attribute_button_save_as")})}}function m(){i&&i(),s&&s(),t.getPermissionStore().unsubscribe(r)}},a=(t=Object(C.uY)(b.a.mark(function e(t){var n,i,o,r,a;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.viewId,i=t.tableId,o=t.renderer,r=t.recordId,a=t.fieldId,e.next=3,Object(c.a)({viewId:n,tableId:i,recordId:r,fieldId:a,onCopy:function(){var t=Object(C.uY)(b.a.mark(function e(t){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.clipboardHelper.setClipboardValue(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));function e(e){return t.apply(this,arguments)}return e}()});case 3:Object(l.a)(C.LK.CopyRecordLink);case 4:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)})}).call(this,s("vb163"))}}]);
//# sourceMappingURL=//slardar.bytedance.net/api_v2/browser/jserr/get_sourcemap?bid=docs_pc&js_filename=vendors-gallery-view-layer.e09fc548d6.chunk.js