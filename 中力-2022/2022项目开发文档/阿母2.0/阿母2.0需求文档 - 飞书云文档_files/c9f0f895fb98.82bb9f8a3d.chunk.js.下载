(window.webpackJsonp=window.webpackJsonp||[]).push([["c9f0f895fb98","b53b3a3d6ab9"],{vb2221:function(e,t,n){"use strict";var i=n("vb144"),r=n.n(i),a=n("vb103"),o=n("vb151");function s(e){return a.createElement("svg",r()({width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),a.createElement("path",{d:"M11.228 5.376a1 1 0 0 1 1.559 0l8.305 10.334a1 1 0 0 1-.78 1.626H3.703a1 1 0 0 1-.78-1.626l8.306-10.334Z",fill:"currentColor"}))}var l=a.forwardRef(function(e,t){return a.createElement(o.a,r()({icon:s},e,{ref:t,svgProps:{"data-icon":"ExpandUpFilled"}}))});t.a=l},vb331:function(e,t){function n(){}e.exports=n},vb344:function(e,t,n){"use strict";n.d(t,"a",function(){return s}),n.d(t,"b",function(){return o}),n.d(t,"c",function(){return l});var i=n("vb152"),r=n.n(i),a=n("vb143"),o=Object(a.Uy)(Object(a.uY)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e("d645920e395f").then(n.bind(null,"vb485"));case 2:return e.abrupt("return",e.sent.SingleSelectorEditor);case 3:case"end":return e.stop()}},e)}))),s=Object(a.Uy)(Object(a.uY)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e("d67d8ab4f4c1").then(n.bind(null,"vb486"));case 2:return e.abrupt("return",e.sent.MultiSelectorEditor);case 3:case"end":return e.stop()}},e)}))),l=Object(a.Uy)(Object(a.uY)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e("3416a75f4cea").then(n.bind(null,"vb487"));case 2:return e.abrupt("return",e.sent.UserSelectorEditor);case 3:case"end":return e.stop()}},e)})))},vb394:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return i}),n.d(t,"c",function(){return o}),n.d(t,"d",function(){return s}),n.d(t,"e",function(){return a}),n.d(t,"f",function(){return l});var i="".concat("bitable-5a92a9","__date-time-editor"),r="".concat("bitable-5a92a9","__calendar"),a=252,o=500,s=230,l=5},vb483:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var i=function(e){return{userId:e.id,name:e.cn_name,enName:e.en_name,avatarUrl:e.avatar_url,department:e.department,isExternal:e.is_external,displayName:e.display_name}}},vb589:function(e,t,n){"use strict";n.r(t),n.d(t,"Panel",function(){return o}),n.d(t,"formatOption",function(){return y}),n.d(t,"generateOptions",function(){return g});var b=n("vb143"),i=n("vb103"),f=n.n(i),r=n("vb159"),h=n.n(r),a=(n("vb129"),n("vb147"),n("vb152"),n("vb223"),n("vb214"),n("vb232"),n("vb187"),n("vb174"),n("vb225"),n("vb224"),n("vb128"),n("vb148"),n("vb122"),n("vb115"),n("vb112"),n("vb118"),n("vb119"),n("vb113"),n("vb167"),n("vb164"),n("vb233"),n("vb234"),n("vb235"),n("vb123"),n("vb236"),n("vb193"),n("vb237"),n("vb155"),n("vb238"),n("vb124"),n("vb239"),n("vb111"),n("vb104"),n("vb116"),n("vb120"),n("vb121"),n("vb117"),n("vb240"),n("vb134"),n("vb131"),n("vb226"),n("vb241"),n("vb114"),n("vb110"),n("vb125"),n("vb242"),n("vb127"),n("vb132"),n("vb227"),n("vb135"),n("vb228"),n("vb229"),n("vb133"),n("vb126"),n("vb243"),n("vb262"),n("vb244"),n("vb245"),n("vb246"),n("vb247"),n("vb194"),n("vb248"),n("vb249"),n("vb201"),n("vb260"),n("vb267"),n("vb250"),n("vb136"),n("vb251"),n("vb130"),n("vb252"),function e(t,n,i){var r=window.requestAnimationFrame||function(){return setTimeout(arguments[0],10)};if(i<=0)t.scrollTop=n;else{var a=(n-t.scrollTop)/i*10;r(function(){t.scrollTop=t.scrollTop+a,t.scrollTop!==n&&e(t,n,i-10)})}});function g(e){for(var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,n=[],i=0;i<e;i+=t)n.push(i);return n}var y=function(e){var t="".concat(e);return e<10&&(t="0".concat(e)),t},o=function(t){function n(e){var r;return Object(b.ov)(this,n),(r=t.call(this,e)||this).scrollToSelected=function(e){var t=r.list;if(t){var n=r.selectedIndex;(!n||n<0)&&(n=0);var i=t.children[n].offsetTop;a(t,i,e)}},r.saveList=function(e){r.list=e,r.scrollToSelected(0)},r.onSelect=function(e){r.props.onChange&&r.props.onChange(e)},r.state={value:e.value},r}return Object(b.bu)(n,t),Object(b.Pw)(n,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.value;t&&this.setState({value:t})}},{key:"getTimeSelect",value:function(e){var o,s,i=this,t=this.props,r=t.prefixCls,n=t.hourStep,a=t.minuteStep,l=g(24,n),c=g(60,a),u=!0,d=!0;if(""!==e){var m=e.split(":");u=!Number.isNaN(parseInt(m[0],10)),o=u?parseInt(m[0],10):"",d=1<m.length&&!Number.isNaN(parseInt(m[1],10)),s=u&&d?parseInt(m[1],10):""}else{var p=new Date;o=p.getHours(),s=p.getMinutes()}u&&d&&(s<=15?s=0:45<s?(o=11===o?0:o+1,s=0):s=30);var v=[];return l.forEach(function(a,e){c.forEach(function(e,t){var n=y(a),i=y(e),r=a===o&&e===s;v.push({value:n+":"+i,selected:r})})}),v.map(function(e,t){e.selected&&(i.selectedIndex=t,i.scrollToSelected(120));var n=h()(Object(b.Ww)({},"".concat(r,"-select-option-selected"),e.selected));return f.a.createElement("li",{className:n,key:t,onClick:function(){return i.onSelect(e.value)}},e.value)})}},{key:"render",value:function(){var e=this.props,t=e.prefixCls,n=e.className,i=this.state.value;return f.a.createElement("div",{className:h()(Object(b.Ww)({},"".concat(t,"-inner"),!0),n)},f.a.createElement("div",{className:"".concat(t,"-combobox")},f.a.createElement("div",{className:"".concat(t,"-select")},f.a.createElement("ul",{className:"".concat(t,"-select-ul"),ref:this.saveList},this.getTimeSelect(i)))))}}]),n}(f.a.PureComponent);o.defaultProps={prefixCls:"".concat("bitable-5a92a9","__time-picker-panel"),hourStep:1,className:""}},vb645:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return s});var v=n("vb143"),i=n("vb103"),b=n.n(i),f=n("vb394"),h=n("vb111"),r=n("vb331"),l=n.n(r),a=n("vb159"),g=n.n(a),y=n("vb2170"),o=function(t){function n(e){var r;return Object(v.ov)(this,n),(r=t.call(this,e)||this).onCalendarSelect=function(e){var t=r.props,n=t.onCalendarSelect,i=t.onChange;n&&n(e),i(e)},r.state={mode:"date"},r}return Object(v.bu)(n,t),Object(v.Pw)(n,[{key:"render",value:function(){var t=this,e=this.props,n=e.disabledDate,i=e.showToday,r=e.value,a=e.setPickerContainerRef,o=e.align,s=e.locale;return b.a.createElement("div",{className:"".concat(f.a,"-picker-container bitable-date-picker-container"),style:o?o.offset:void 0,ref:a},b.a.createElement(h.ConfigProvider,{locale:s},b.a.createElement(h.DatePickerContextProvider,{value:{mode:this.state.mode,value:r,showToday:i,setMode:function(e){t.setState({mode:e})},setValue:function(e){e&&t.onCalendarSelect(e)},setOpened:l.a}},b.a.createElement(h.DatePickerPanel,{className:"".concat(f.a," bitable-date-picker-calendar"),disabledDate:n,mode:"date",onSelect:this.onCalendarSelect,value:r,startOfWeek:1}))))}}]),n}(b.a.Component),s=function(r){function a(){var t;Object(v.ov)(this,a);for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return(t=r.call.apply(r,[this].concat(n))||this).saveInput=function(e){t.input=e},t}return Object(v.bu)(a,r),Object(v.Pw)(a,[{key:"focus",value:function(){this.input&&this.input.focus()}},{key:"blur",value:function(){this.input&&this.input.blur()}},{key:"getInputPosition",value:function(){return this.input?this.input.getBoundingClientRect():null}},{key:"render",value:function(){var e=this.props,t=e.suffixIcon,n=e.className,i=e.readOnly,r=e.inputDateValue,a=e.placeholder,o=e.disabled,s=e.shouldCheckEmpty,l=e.scene,c="".concat(f.a,"-picker"),u="".concat(f.a,"-picker-input"),d=t&&b.a.cloneElement(t,{className:g()(t.props.className,Object(v.Ww)({},"".concat(f.a,"-picker-icon"),!0))}),m=!1,p="";return s&&!r&&(m=!0,p=Object(v.SP)(v.ZO.ContentEmpty,l)),b.a.createElement("span",{className:g()(n,c)},b.a.createElement("div",null,b.a.createElement("input",{type:"text",ref:this.saveInput,readOnly:!!i,value:r,placeholder:null!=a?a:"",className:g()(u,{invalid:m}),onChange:this.props.onInputChange,onFocus:this.props.onInputFocus,onBlur:this.props.onInputBlur,disabled:o}),p&&b.a.createElement(h.Tooltip,{title:p,placement:"top"},b.a.createElement("i",{className:"b-select--invalid-icon sibling-tooltip"},b.a.createElement(y.a,null))),o?null:d))}}]),a}(b.a.PureComponent)},vb770:function(e,H,Z){"use strict";Z.r(H),function(c){Z.d(H,"ReminderDatePicker",function(){return B}),Z.d(H,"getLocalTimeFormatText",function(){return V});var p=Z("vb143"),a=Z("vb150"),e=Z("vb103"),h=Z.n(e),t=Z("vb128"),u=Z.n(t),n=Z("vb159"),d=Z.n(n),i=(Z("vb147"),Z("vb148"),Z("vb152")),s=Z.n(i),l=Z("vb394"),m=Z("vb344"),r=Z("vb483"),v=Z("vb111"),b=Z("vb589"),f=Z("vb645"),o=Z("vb2221"),g=Z("vb2171"),y=Z("vb2166"),E=(Z("vb129"),Z("vb223"),Z("vb214"),Z("vb232"),Z("vb187"),Z("vb174"),Z("vb225"),Z("vb224"),Z("vb122"),Z("vb115"),Z("vb112"),Z("vb118"),Z("vb119"),Z("vb113"),Z("vb167"),Z("vb164"),Z("vb233"),Z("vb234"),Z("vb235"),Z("vb123"),Z("vb236"),Z("vb193"),Z("vb237"),Z("vb155"),Z("vb238"),Z("vb124"),Z("vb239"),Z("vb104"),Z("vb116"),Z("vb120"),Z("vb121"),Z("vb117"),Z("vb240"),Z("vb134"),Z("vb131"),Z("vb226"),Z("vb241"),Z("vb114"),Z("vb110"),Z("vb125"),Z("vb242"),Z("vb127"),Z("vb132"),Z("vb227"),Z("vb135"),Z("vb228"),Z("vb229"),Z("vb133"),Z("vb126"),Z("vb243"),Z("vb262"),Z("vb244"),Z("vb245"),Z("vb246"),Z("vb247"),Z("vb194"),Z("vb248"),Z("vb249"),Z("vb201"),Z("vb260"),Z("vb267"),Z("vb250"),Z("vb136"),Z("vb251"),Z("vb130"),Z("vb252"),Z("vb331"),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e});function C(e,t){var n={};for(var i in e)0<=t.indexOf(i)||Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i]);return n}var S=function(e){e.styles;var t=C(e,["styles"]);return h.a.createElement("svg",E({width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),h.a.createElement("g",{mask:"url(#mask0)"},h.a.createElement("circle",{cx:"16",cy:"16",r:"16",fill:"#82A7FC"}),h.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16 14.907c2.148 0 3.889-1.77 3.889-3.954C19.889 8.77 18.148 7 16 7c-2.148 0-3.889 1.77-3.889 3.954 0 2.183 1.741 3.953 3.889 3.953zm0-1.581c-1.289 0-2.333-1.062-2.333-2.373 0-1.31 1.044-2.372 2.333-2.372 1.289 0 2.333 1.062 2.333 2.373 0 1.31-1.044 2.372-2.333 2.372zm-7 7.511c0-3.047 2.519-4.744 4.667-4.744h4.666c2.148 0 4.667 1.694 4.667 4.744v2.372c0 .437-.348.791-.778.791H9.778A.784.784 0 0 1 9 23.21v-2.373zm12.444 1.582v-1.582c0-1.994-1.655-3.163-3.11-3.163h-4.667c-1.424 0-3.111 1.112-3.111 3.163v1.582h10.888z",fill:"#fff"})))};function T(e){var t=e.fieldName;return h.a.createElement("div",{className:"bitable-reminder-field-select-option"},h.a.createElement(S,{className:"bitable-reminder-field-select-avatar"}),h.a.createElement("span",{className:"bitable-reminder-field-option-name bitable-reminder-overflow-text"},t))}var N=["displayName"],O=[{value:p.uQ.User,text:c("smartable.reminder.entity_type_user")},{value:p.uQ.Field,text:c("smartable.reminder.entity_type_field")}];function I(){return(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).reduce(function(e,t){return Object.assign(Object(p.Ww)({},t.userId,t),e)},{})}var M=function(a){function o(e){var r,t;Object(p.ov)(this,o),(r=a.call(this,e)||this).onEntityTypeChange=function(e){if(e!==r.state.entityType){var t=e===p.uQ.User?{users:[]}:{fields:[]};r.setState({entityType:e,notifyEntity:t}),r.props.onEntityTypeChange&&r.props.onEntityTypeChange(e)}},r.onUserEntityChange=function(e){var n=[],i=r.state.userItemMap;e.forEach(function(e){var t=i[e];t&&n.push(t)}),r.setState({notifyEntity:{users:n}}),r.hasChanged=!0},r.onUserSelectorDropdownVisibleChange=function(e){r.searchUsers(""),r.onSelectorDropdownVisibleChange(e)},r.onSelectorDropdownVisibleChange=function(e){r.setState({isSelectorDropDownOpen:e}),e&&r.props.onShowUserSelectorDropdown&&r.props.onShowUserSelectorDropdown()},r.searchUsers=(t=Object(p.uY)(s.a.mark(function e(t){var n;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.props.searchUsers(t);case 2:n=e.sent,r.setUsers(n);case 4:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)}),r.onUserFieldEntityChange=function(e){r.setState({notifyEntity:{fields:e}}),r.hasChanged=!0},r.submitEntityChange=function(){if(r.hasChanged){var e=r.state.notifyEntity.users;e&&(e=e.map(function(e){return e.displayName,Object(p.nA)(e,N)})),r.props.submitEntityChange(Object.assign({},r.state.notifyEntity,{users:e}))}else r.props.cancelEntityChange();r.props.onClickSubmitBtn&&r.props.onClickSubmitBtn()},r.cancelEntityChange=function(){var e=r.props.cancelEntityChange;r.props.onClickCancelBtn&&r.props.onClickCancelBtn(),e()};var n=e.notifyEntity,i=e.fieldMap;return r.hasChanged=!1,r.userFieldList=Object.keys(i).map(function(e){return i[e]}).filter(function(e){return Object(p.vQ)(e)}),r.state={entityType:r.filterEntityType(n),notifyEntity:r.getNotifyEntityByProps(),searchUserOptions:[],userItemMap:I(n.users),isSelectorDropDownOpen:!1},r}return Object(p.bu)(o,a),Object(p.Pw)(o,[{key:"componentDidMount",value:function(){this.props.onShow&&this.props.onShow()}},{key:"filterEntityType",value:function(e){return void 0!==e.users?p.uQ.User:void 0!==e.fields?p.uQ.Field:p.uQ.User}},{key:"getNotifyEntityByProps",value:function(){var e=this.props,t=e.notifyEntity,n=e.fieldMap,i=Object.assign({},t),r=i.fields;if(r){var a,o=[],s=Object(p.WB)(r);try{for(s.s();!(a=s.n()).done;){var l=a.value,c=n[l];c&&Object(p.vQ)(c)&&o.push(l)}}catch(e){s.e(e)}finally{s.f()}i.fields=o}return i}},{key:"render",value:function(){var e=this.props,t=e.align,n=e.disableField;return h.a.createElement("div",{className:"bitable-reminder-entity-config-panel",style:t?t.offset:void 0},h.a.createElement("div",{className:"bitable-reminder-entity-config-title bitable-reminder-overflow-text"},c("smartable.reminder.select_reminder_entity")),!n&&h.a.createElement("div",{className:"bitable-reminder-selector bitable-reminder-entity-config-selector"},h.a.createElement(p.Tw,{options:O,selected:this.state.entityType,onChange:this.onEntityTypeChange,optionWidth:l.d})),this.renderEntitySelector(),this.renderFooter(),this.state.isSelectorDropDownOpen&&h.a.createElement("div",{className:"bitable-reminder-entity-config-selector-overlay"}))}},{key:"renderEntitySelector",value:function(){return this.props.disableField||this.state.entityType!==p.uQ.Field?this.renderUserSelector():this.renderUserFieldSelector()}},{key:"renderUserSelector",value:function(){var e=this.state,t=e.searchUserOptions,n=e.notifyEntity,i=e.userItemMap,r=this.props.bitableType,a=(n.users||[]).map(function(e){return e.userId});return h.a.createElement(m.c,{className:"selector-cell user-editor bitable-reminder-user-selector",options:t,language:this.props.language,userIdItemMap:i,disableBlankOption:!0,values:a,relativeClass:r===p.pA.EmbeddedInDoc?"app-main-container":"bitable-container",editable:!0,style:{width:l.d},isMultiple:!0,onSearch:this.searchUsers,onMultiChange:this.onUserEntityChange,onDropdownVisibleChange:this.onUserSelectorDropdownVisibleChange,emptyListPlaceholder:c("smartable.reminder.notify_user_select_placeholder")})}},{key:"setUsers",value:function(e){var n=e.map(r.a);(this.state.notifyEntity.users||[]).forEach(function(t){n.find(function(e){return e.userId===t.userId})||n.push(t)}),this.setState({searchUserOptions:n,userItemMap:I(n)})}},{key:"valueRender",value:function(e){return h.a.createElement(T,{fieldName:e})}},{key:"renderOption",value:function(e){return h.a.createElement(T,{fieldName:e.label})}},{key:"renderUserFieldSelector",value:function(){var e=0===this.userFieldList.length,t=this.props.getPinyin,n=this.userFieldList.map(function(e){return{value:e.id,label:e.name}});return h.a.createElement(p.wQ,{value:this.state.notifyEntity.fields||[],multiple:!0,showSearch:!1,onChange:this.onUserFieldEntityChange,disablePinyin:!0,disableAutoHighlightOption:!0,useHotkeys:!1,valueRender:this.valueRender,valuePlaceholder:c(e?"smartable.reminder.field_select_no_option_placeholder":"smartable.reminder.notify_entity_select_placeholder"),disabled:e,className:"bitable-reminder-field-entity-selector",onDropdownVisibleChange:this.onSelectorDropdownVisibleChange,getPinyin:t,rowHeight:52,rowRender:this.renderOption,options:n,contentType:p.xQ.User})}},{key:"renderFooter",value:function(){var e=this.props,t=e.cancelBtnText,n=e.submitBtnText;return h.a.createElement("div",{className:"bitable-reminder-cancel-submit-button-group"},h.a.createElement(p.hX,{onCancel:this.cancelEntityChange,onSubmit:this.submitEntityChange,submitDisabled:this.getIsSubmitEntityDisabled(),cancelBtnText:t,submitBtnText:n}))}},{key:"getIsSubmitEntityDisabled",value:function(){var e=this.state,t=e.notifyEntity,n=e.entityType===p.uQ.User?t.users:t.fields;return!n||0===n.length}}]),o}(h.a.Component),w="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBtYXNrPSJ1cmwoI21hc2swKSI+PGNpcmNsZSBjeD0iMTYiIGN5PSIxNiIgcj0iMTYiIGZpbGw9IiM4MkE3RkMiLz48cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTE2IDE0LjkwN2MyLjE0OCAwIDMuODg5LTEuNzcgMy44ODktMy45NTRDMTkuODg5IDguNzcgMTguMTQ4IDcgMTYgN2MtMi4xNDggMC0zLjg4OSAxLjc3LTMuODg5IDMuOTU0IDAgMi4xODMgMS43NDEgMy45NTMgMy44ODkgMy45NTN6bTAtMS41ODFjLTEuMjg5IDAtMi4zMzMtMS4wNjItMi4zMzMtMi4zNzMgMC0xLjMxIDEuMDQ0LTIuMzcyIDIuMzMzLTIuMzcyIDEuMjg5IDAgMi4zMzMgMS4wNjIgMi4zMzMgMi4zNzMgMCAxLjMxLTEuMDQ0IDIuMzcyLTIuMzMzIDIuMzcyem0tNyA3LjUxMWMwLTMuMDQ3IDIuNTE5LTQuNzQ0IDQuNjY3LTQuNzQ0aDQuNjY2YzIuMTQ4IDAgNC42NjcgMS42OTQgNC42NjcgNC43NDR2Mi4zNzJjMCAuNDM3LS4zNDguNzkxLS43NzguNzkxSDkuNzc4QS43ODQuNzg0IDAgMCAxIDkgMjMuMjF2LTIuMzczem0xMi40NDQgMS41ODJ2LTEuNTgyYzAtMS45OTQtMS42NTUtMy4xNjMtMy4xMS0zLjE2M2gtNC42NjdjLTEuNDI0IDAtMy4xMTEgMS4xMTItMy4xMTEgMy4xNjN2MS41ODJoMTAuODg4eiIgZmlsbD0iI2ZmZiIvPjwvZz48L3N2Zz4=";function k(e,t,n){e.forEach(function(e){t.setUserItemWithPermission(n,e.userId,"","",void 0,!1)})}var D=function(n){function i(e){var t;return Object(p.ov)(this,i),(t=n.call(this,e)||this).onUserPermissionChange=function(){t.updateUserPermission(),t.forceUpdate()},t.updateUserPermission(),t}return Object(p.bu)(i,n),Object(p.Pw)(i,[{key:"render",value:function(){var e=this.props.notifyEntity,t=e.users,n=e.fields;return t?this.renderUserEntities(t):n?this.renderFieldEntities(n):null}},{key:"componentDidMount",value:function(){this.props.userContext.addPermissionChangeListener(this.onUserPermissionChange)}},{key:"componentWillUnmount",value:function(){this.props.userContext.removePermissionChangeListener(this.onUserPermissionChange)}},{key:"renderUserEntities",value:function(e){var t=this,n=this.props.reminderContext,i=this.props.language,r=e.length,a=e.slice(0,l.f);return h.a.createElement(h.a.Fragment,null,a.map(function(e){return h.a.createElement(p.Vw,{key:e.userId,item:e,className:d()("bitable-reminder-entity-item bitable-reminder-user-entity",{readable:n.getUserReadable(e.userId)}),showClose:!1,onShowUser:t.props.onShowUser,onHideUser:t.props.onHideUser,language:i})}),r>l.f&&h.a.createElement("span",{className:"bitable-reminder-entities-placeholder"},c("smartable.reminder.notify_user_entity_placeholder",r)))}},{key:"renderFieldEntities",value:function(e){var n=this,i=this.props.reminderContext.fields,t=e.filter(function(e){var t=i[e];return t&&Object(p.vQ)(t)}),r=t.slice(0,l.f).map(function(e){var t=i[e];return h.a.createElement(p.Vw,{key:e,item:{userId:e,name:t.name,enName:t.name,avatarUrl:w},showClose:!1,className:"bitable-reminder-entity-item bitable-reminder-field-entity",language:n.props.language})}),a=t.length;return h.a.createElement(h.a.Fragment,null,r,a>l.f&&h.a.createElement("span",{className:"bitable-reminder-entities-placeholder"},c("smartable.reminder.notify_field_entity_placeholder",a)))}},{key:"updateUserPermission",value:function(){var e=this.props,t=e.userContext,n=e.reminderContext,i=e.notifyEntity.users;i&&k(i,t,n)}}]),i}(h.a.PureComponent),x="bitable-date-time-picker-select-list";function j(e){return{value:e.id.toString(),text:e.text}}var P="bitable-reminder-config-item",R=Object(b.generateOptions)(24,1),U=Object(b.generateOptions)(60,30),_=34;function z(e){var t,n=[],i=Object(p.WB)(R);try{for(i.s();!(t=i.n()).done;){var r,a=t.value,o=Object(p.WB)(U);try{for(o.s();!(r=o.n()).done;){var s=r.value;n.push("".concat(Object(b.formatOption)(a),":").concat(Object(b.formatOption)(s)))}}catch(e){o.e(e)}finally{o.f()}}}catch(e){i.e(e)}finally{i.f()}return e&&!n.includes(e)&&n.push(e),n.sort().map(function(e){return{value:e,label:h.a.createElement("span",null,e)}})}function F(e){var t=e.match(/\s{1}?[PA]?M?/i);t||(t=e.match(/\s?[PA]?M+?/i));var n=e.match(/(\d+)?(：|:)?(\d+)?/),i="";if(n&&0<n[0].length){var r=n[0].split(/:|：/);i+=r[0]+(1<r.length?":":"")+(r[1]||"")}else{var a=e.match(/\d+/);i+=a?a[0]:""}return i+(t?t[0]:"").toUpperCase()}var Q=p.zQ.map(j),L=p.AQ.map(j),B=function(t){function n(e){var m;return Object(p.ov)(this,n),(m=t.call(this,e)||this).dateChanged=!1,m.selectRef=null,m.selectInputFocus=!1,m.getSelectedTime=function(){var e="09:00",t=m.props,n=t.timeValue,i=t.value;return n?e=n:i&&(e=i.format("HH:mm")),e},m.handleOpenChange=function(e){var t=m.props.onOpenChange;t&&t(e),e||m.backToCalendarPanel()},m.saveInput=function(e){m.dateInput=e},m.onDateInputFocus=function(){m.props.onDateInputFocus&&m.props.onDateInputFocus(),m.props.readOnly||m.handleOpenChange(!0)},m.onInputChange=function(e){m.props.onTextChange&&m.props.onTextChange(e.target.value),m.dateChanged=!0},m.handleCalendarChange=function(e){var t;m.props.onChange(e),m.dateChanged||(m.dateChanged=e.valueOf()!==(null===(t=m.props.value)||void 0===t?void 0:t.valueOf()))},m.setCalendarContainerRef=function(e){m.calendarContainer=e},m.setPortalPopupContainerRef=function(e){m.portalPopupContainer=e},m.switchReminderFormat=function(){var e=m.props,t=e.collectReminderEvent,n=e.reminder,i=e.onSwitchReminderFormat,r=n.isSpecificTime;t&&t(p.SK.SWITCH_TIME_SET,r?"off":"on"),i&&i(r?p.BQ.Off:p.BQ.On);var a=m.getStrategyOptions(!r)[0].value;m.updateReminder(Number(a),n.notifyEntities,!r)},m.onDocumentClick=function(e){var t=m.props,n=t.open,i=t.ignoreDocumentClick,r=e.target,a=m.calendarContainer,o=document.querySelector(".bitable-mention-popover"),s=document.querySelector(".".concat(x)),l=null==s?void 0:s.contains(r),c=r&&a&&a.contains(r),u=r&&o&&o.contains(r),d=i&&i(r);!n||c||u||d||l||m.handleOpenChange(!1)},m.renderReminderConfig=function(){return h.a.createElement("div",{className:"bitable-reminder-config"},m.renderTimeZoneChangedAlert(),h.a.createElement("div",{className:"".concat(P," bitable-reminder-config-title")},h.a.createElement(p.CQ,{triggerContent:m.renderReminderHelper(),onClick:m.toggleReminder,isChecked:!!m.props.reminder,clickOnSwitch:!0})),m.renderReminderConfigItems())},m.renderTimeTriggerElement=function(e){var t=e.inputRef,n=e.setOverlayVisible,i=function(e){m.setState({timeSearchValue:e.target.value})},r=function(){n()},a=m.getTimeVal();return h.a.createElement("div",{onClick:r},h.a.createElement(v.Input,{ref:t,size:"medium",value:m.selectInputFocus?m.state.timeSearchValue:a,placeholder:a,onChange:i,suffix:m.state.timeSelectOpen?h.a.createElement(o.a,{className:"bitable-date-time-picker-select-icon"}):h.a.createElement(g.a,{className:"bitable-date-time-picker-select-icon"})}))},m.openReminderHelperDoc=function(){var e=m.props.reminderHelperLink||c("smartable.reminder.reminder_helper_url"),t=Object(p.HP)(e);p.ob.DomainHelper.protectedOpenLink(t),m.props.collectReminderEvent&&m.props.collectReminderEvent(p.SK.VIEW_HELP)},m.switchToEntityConfigPanel=function(){var e=m.props.onSwitchToEntityConfigPanel;e&&e(),m.toggleEntityConfigPanel(!0)},m.backToCalendarPanel=function(){m.toggleEntityConfigPanel(!1)},m.toggleReminder=function(){var e=m.props,t=e.reminderContext,n=e.getCurrentUser,i=e.showTimePicker,r=e.collectReminderEvent,a=e.onToggleReminder,o=null,s=m.getDateTimeValue();if(m.props.reminder)r&&r(p.SK.SWITCH_REMINDER,"off"),a&&a(p.BQ.Off);else{var l=[],c=n(),u=c?c.get("id"):"";if(u){var d=t.getUserItemById(u);d&&l.push(d)}o=Object(p.XK)(s,(i?p.AQ:p.zQ)[0].id,{users:l},i,m.props.timeZone),r&&r(p.SK.SWITCH_REMINDER,"on"),a&&a(p.BQ.On)}m.props.onReminderChange(s,o)},m.getTimeVal=function(){var e=m.props,t=e.timeValue,n=e.value;return t||(n?n.format("HH:mm"):"00:00")},m.handleSetTimeOpen=function(t){m.setState({timeSelectOpen:t},function(){if(t){var e=m.getTimeVal();m.setReminderTimeSelectActiveOption(e)}})},m.handleSetTimeSearch=function(e){m.setState({timeSearchValue:F(e)})},m.setReminderTimeSelectActiveOption=function(e){m.selectRef&&m.selectRef.setActiveOption(e)},m.onBlur=function(){m.selectInputFocus=!1,m.insertSetTime()},m.onFocus=function(){m.selectInputFocus=!0,m.setState({timeSearchValue:m.getTimeVal()})},m.onKeyDown=function(e){"Enter"===e.key&&(e.stopPropagation(),m.state.timeSelectOpen&&Promise.resolve().then(function(){m.insertSetTime()}))},m.insertSetTime=function(){var e=m.props.reminder;if(e){m.handleSetTimeOpen(!1);var t=m.state.timeSearchValue;m.updateReminder(e.notifyStrategy,e.notifyEntities,e.isSpecificTime,t),Promise.resolve().then(function(){var e=m.getSelectedTime();m.handleSetTimeSearch(e)})}},m.onNotifyStrategyChange=function(e){var t=m.props,n=t.reminder,i=t.collectReminderEvent,r=t.onNotifyStrategyChange;n&&(m.updateReminder(Number(e),n.notifyEntities,n.isSpecificTime),i&&i(p.SK.SET_REMINDER_TIME,e),r&&r(e))},m.onNotifyTimeChange=function(e){var t=m.props,n=t.reminder,i=t.collectReminderEvent,r=t.onNotifyTimeChange;n&&(m.updateReminder(n.notifyStrategy,n.notifyEntities,n.isSpecificTime,e),i&&i(p.SK.SET_TIME,e),r&&r(),m.handleSetTimeSearch(e))},m.onNotifyEntityChange=function(e){var t=m.props,n=t.reminder,i=t.userContext,r=t.reminderContext,a=t.collectReminderEvent;n&&(m.updateReminder(n.notifyStrategy,e,n.isSpecificTime),e.users?(k(e.users,i,r),a&&a(p.SK.EDIT_REMINDER_PERSON,"specific_person")):a&&a(p.SK.EDIT_REMINDER_PERSON,"person_column")),m.backToCalendarPanel()},m.state={showEntityConfigPanel:!1,timeSearchValue:"",timeSelectOpen:!1},m}return Object(p.bu)(n,t),Object(p.Pw)(n,[{key:"componentDidMount",value:function(){window.addEventListener("mousedown",this.onDocumentClick)}},{key:"componentWillUnmount",value:function(){this.dateChanged=!1,window.removeEventListener("mousedown",this.onDocumentClick)}},{key:"componentDidUpdate",value:function(){!this.props.open&&this.selectInputFocus&&(this.selectInputFocus=!1)}},{key:"focus",value:function(){this.dateInput&&this.dateInput.focus()}},{key:"blur",value:function(){this.dateInput&&this.dateInput.blur()}},{key:"render",value:function(){var e=this.props,t=e.open,n=e.placeholder;return h.a.createElement("div",{className:d()(e.className,"bitable-reminder-date-picker"),ref:this.setCalendarContainerRef},h.a.createElement("div",{className:"bitable-reminder-portal-popup-container",ref:this.setPortalPopupContainerRef}),h.a.createElement(f.b,{readOnly:!!e.readOnly,inputDateValue:e.inputDateValue,placeholder:n,onInputChange:this.onInputChange,onInputFocus:this.onDateInputFocus,onInputBlur:e.onDateInputBlur,ref:this.saveInput,suffixIcon:e.dateInputIcon}),t&&this.renderReminderPopover())}},{key:"renderReminderPopover",value:function(){var e=this.props,t=e.reminder;return!e.disableReminder&&t&&this.state.showEntityConfigPanel?this.renderReminderEntityConfigPanel():this.renderCalendar()}},{key:"renderCalendar",value:function(){var e=this.props,t=e.align,n=e.disabledDate,i=e.showToday,r=e.value,a=e.format,o=e.onCalendarSelect,s=e.popoverClassName,l=e.setCalendarPopoverRef,c=e.disableReminder,u=e.locale;return h.a.createElement("div",{ref:l,className:d()("bitable-reminder-calendar-popover",s),style:t?t.offset:void 0},h.a.createElement(f.a,{value:r,locale:u,disabledDate:n,showToday:i,format:a,onChange:this.handleCalendarChange,onCalendarSelect:o}),!c&&this.renderReminderConfig())}},{key:"renderTimeZoneChangedAlert",value:function(){var e=this;if(this.dateChanged)return null;var t=this.props,n=t.reminder,i=t.timeZone;if(!i||!n||n.isSpecificTime)return null;var r=this.getDateTimeValue(),a=Object(p.XK)(r,n.notifyStrategy,n.notifyEntities,!1,i);if(!a||n.notifyTime===a.notifyTime)return null;var o=Object(p.DQ)({value:Object(p.EQ)(n.notifyTime,i),dateFormat:"yyyy/MM/dd",timeFormat:"HH:mm"}),s=Object(p.DQ)({value:Object(p.EQ)(a.notifyTime,i),dateFormat:"yyyy/MM/dd",timeFormat:"HH:mm"}),l=Object(p.FQ)(i);return h.a.createElement(v.Notice,{type:"info",message:c("Bitable_Reminder_NotifAtCurrentTime",o+(l?" (".concat(l,")"):"")),action:h.a.createElement("div",{style:{marginLeft:-4}},h.a.createElement(v.Tooltip,{placement:"top",title:c("Bitable_Reminder_NotifAtUpdatedTimeTip",s+(l?" (".concat(l,")"):""))},h.a.createElement(v.Button,{type:"text",color:"primary",onClick:function(){return e.props.onReminderChange(r,a)}},c("Bitable_Common_ButtonUpdate")))),style:{margin:"12px 0",maxWidth:274}})}},{key:"renderReminderConfigItems",value:function(){var t=this,e=this.props,n=e.reminder,i=e.showTimePicker;if(!n)return null;var r=n.isSpecificTime;void 0===r&&(r=i);var a=this.getSelectedTime(),o=this.getStrategyOptions(),s=z(this.getTimeVal());return h.a.createElement(h.a.Fragment,null,r&&h.a.createElement("div",{className:P},h.a.createElement("span",{className:"bitable-reminder-strategy-title bitable-reminder-overflow-text"},c("smartable.reminder.notify_time")),h.a.createElement("div",{className:"bitable-reminder-selector bitable-reminder-strategy-selector"},h.a.createElement(v.Select,{ref:function(e){return t.selectRef=e},open:this.state.timeSelectOpen,options:s,showSearch:!0,filterOption:!1,allowClear:!1,mode:"single",virtual:!1,value:a,onChange:this.onNotifyTimeChange,onDropdownVisibleChange:this.handleSetTimeOpen,onKeyDown:this.onKeyDown,onBlur:this.onBlur,onFocus:this.onFocus,className:"bitable-date-time-picker-select",dropdownClassName:"bitable-date-time-picker-select-list",dropdownStyle:{maxHeight:"calc(50vh - 40px)"},triggerElement:this.renderTimeTriggerElement,getPopupContainer:function(){return t.portalPopupContainer||document.body}}))),h.a.createElement("div",{className:P},h.a.createElement("span",{className:"bitable-reminder-strategy-title bitable-reminder-overflow-text"},c("smartable.reminder.remind")),h.a.createElement("div",{className:"bitable-reminder-selector bitable-reminder-strategy-selector"},h.a.createElement(p.Tw,{options:o,selected:String(n.notifyStrategy||"0"),onChange:this.onNotifyStrategyChange,noPortal:!0}))),h.a.createElement("div",{className:"".concat(P," bitable-reminder-config-title bitable-reminder-entities-title")},h.a.createElement("span",{className:"bitable-reminder-entities-title-text bitable-reminder-overflow-text"},c("bitable.field_user")),this.renderReminderEntities(),h.a.createElement("span",{className:"bitable-reminder-config-switch-panel-btn bitable-reminder-overflow-text",onClick:this.switchToEntityConfigPanel},c("smartable.reminder.change_reminder_entity"))),h.a.createElement("div",{className:P},h.a.createElement(v.Checkbox,{onChange:this.switchReminderFormat,checked:r},c("smartable.reminder.set_specify_time"))))}},{key:"getStrategyOptions",value:function(t){var n=this,e=this.props.reminder;t=Object(a.a)(t)?!!e&&e.isSpecificTime:t;var i=Q.map(function(e){return{value:e.value,text:e.text+(t?" (".concat(n.getSelectedTime(),")"):" (09:00)")}}),r=L.concat(i);return t||(r=i),r}},{key:"renderReminderHelper",value:function(){return h.a.createElement("div",{className:"bitable-reminder-helper"},h.a.createElement("span",{className:"bitable-reminder-helper-title bitable-reminder-overflow-text"},c("smartable.reminder.reminder_helper_title")),h.a.createElement(v.Tooltip,{placement:"top",title:c("bitable.reminder.help_doc")},h.a.createElement("span",null,h.a.createElement(y.a,{onClick:this.openReminderHelperDoc,className:"bitable-reminder-helper-icon"}))))}},{key:"renderReminderEntityConfigPanel",value:function(){var e=this.props,t=e.align,n=e.reminder,i=e.reminderContext,r=e.bitableType,a=e.fileToken,o=e.getPinyin,s=e.searchUsers,l=e.getToken,c=e.disableField,u=e.getMentionList,d=e.language,m=e.onShowReminderEntity,p=e.onShowUserSelectorDropdown,v=e.onEntityTypeChange,b=e.onClickEntitySubmitBtn,f=e.onClickEntityCancelBtn;return n?h.a.createElement(M,{align:t,notifyEntity:n.notifyEntities,cancelEntityChange:this.backToCalendarPanel,submitEntityChange:this.onNotifyEntityChange,fieldMap:i.fields,bitableType:r,language:d,fileToken:a,getPinyin:o,searchUsers:s,getToken:l,getMentionList:u,disableField:c,onShow:m,onEntityTypeChange:v,onClickSubmitBtn:b,onClickCancelBtn:f,onShowUserSelectorDropdown:p}):null}},{key:"toggleEntityConfigPanel",value:function(e){this.setState({showEntityConfigPanel:e})}},{key:"renderReminderEntities",value:function(){var e=this.props,t=e.reminder,n=e.reminderContext,i=e.userContext,r=e.language,a=e.onShowUser,o=e.onHideUser;return t?h.a.createElement("div",{className:"bitable-reminder-entities-container"},h.a.createElement(D,{reminderContext:n,notifyEntity:t.notifyEntities,userContext:i,language:r,onShowUser:a,onHideUser:o})):null}},{key:"autoSetReminder",value:function(){this.props.reminder||!this.props.readOnly&&this.props.open&&this.toggleReminder()}},{key:"getCurrentItemIndex",value:function(e,t){return e.findIndex(function(e){return e.value===t})}},{key:"scrollDropdown",value:function(e,t){e&&(e.scrollTop=_*t)}},{key:"getDateTimeValue",value:function(e){var t=this.props,n=t.value,i=t.timeValue,r=t.showTimePicker,a=t.timeZone,o=(n||u()()).set({hour:0,minute:0,second:0,millisecond:0}).valueOf(),s=e||i||(r?V(p.GQ):"00:00"),l=Object(p.HQ)(s,p.GQ)||0;return Object(p.IQ)(o+l,a)}},{key:"updateReminder",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2],i=3<arguments.length?arguments[3]:void 0,r=this.getDateTimeValue(i||this.getSelectedTime()),a=Object(p.XK)(r,e,t,n,this.props.timeZone);a&&(a.isSpecificTime=n),this.props.onReminderChange(r,a)}}],[{key:"getDerivedStateFromProps",value:function(e){var t=[];return e.open&&e.reminder||t.push({showEntityConfigPanel:!1,timeSearchValue:""}),e.open||t.push({timeSelectOpen:!1}),t.length?Object.assign.apply(Object,[{}].concat(t)):null}}]),n}(h.a.Component);function V(e){return u()().local().format(Object(p.yQ)(e))}}.call(this,Z("vb163"))}}]);
//# sourceMappingURL=//slardar.bytedance.net/api_v2/browser/jserr/get_sourcemap?bid=docs_pc&js_filename=c9f0f895fb98.82bb9f8a3d.chunk.js