(window.webpackJsonp=window.webpackJsonp||[]).push([["a92db3753ac7"],{vb1299:function(e,c,b){"use strict";b.r(c),function(g){b.d(c,"EditorContainer",function(){return s});var e,t,n,L=b("vb143"),r=b("vb180"),i=b("vb103"),k=b.n(i),o=b("vb159"),D=b.n(o),d=(b("vb148"),b("vb152"),b("vb112"),b("vb164"),b("vb167"),b("vb113"),b("vb116")),p=(b("vb147"),b("vb119"),b("vb155"),b("vb118"),b("vb120"),b("vb174"),b("vb121"),b("vb117"),b("vb115"),b("vb111")),E=(b("vb126"),b("vb125"),b("vb540")),l=b("vb950"),a=(b("vb129"),b("vb223"),b("vb214"),b("vb232"),b("vb187"),b("vb225"),b("vb224"),b("vb128"),b("vb122"),b("vb233"),b("vb234"),b("vb235"),b("vb123"),b("vb236"),b("vb193"),b("vb237"),b("vb238"),b("vb124"),b("vb239"),b("vb104"),b("vb240"),b("vb134"),b("vb131"),b("vb226"),b("vb241"),b("vb114"),b("vb110"),b("vb242"),b("vb127"),b("vb132"),b("vb227"),b("vb135"),b("vb228"),b("vb229"),b("vb133"),b("vb243"),b("vb262"),b("vb244"),b("vb245"),b("vb246"),b("vb247"),b("vb194"),b("vb248"),b("vb249"),b("vb201"),b("vb260"),b("vb267"),b("vb250"),b("vb136"),b("vb251"),b("vb130"),b("vb252"),1),s=(e=Object(L.zx)(L.Ax.PinyinHelper),t=function(i){function o(e){var h;Object(L.ov)(this,o),(h=i.call(this,e)||this).isUnmounted=!1,h.cellInfo={recordId:"",fieldId:""},h.isStartEdit=!1,h.focusOnlyEditorOffsetY=0,h.focusAfterSetRef=!1,h.startEditAfterSetRef=null,h.isRecordFloating=!1,h.teaSource=L.iz.Cell,Object(L.Bx)(h,"pinyinHelper",n,Object(L.Cx)(h)),h.debounceUpdateEditorPosition=Object(r.a)(function(){h.updateEditorPosition()},200),h.onSetSelectionByRemote=function(){h.updateEditorPosition()},h.showLockIcon=function(e,t){var i,o,n,r,d=h.state,l=d.field,a=d.recordId,s=null==l?void 0:l.fieldUIType,c=a&&l&&Object(L.EK)(e,t,a,l.id),b=s===L.ex.Attachment&&0!==(null==l||null===(i=l.property)||void 0===i||null===(o=i.capture)||void 0===o?void 0:o.length),v=s===L.ex.Location&&(null==l||null===(n=l.property)||void 0===n?void 0:n.inputType)===L.FK.ONLY_MOBILE,u=s===L.ex.Barcode&&!1===(null==l||null===(r=l.allowedEditModes)||void 0===r?void 0:r.manual),f="";return c?(v&&(f=L.jz.BitableFieldUnableToEditLocationMobileOnly),u&&(f=L.jz.BitableFieldUnableToEditBarcodeMobileOnly),s===L.ex.Attachment&&(f=b?L.jz.BitableFieldUnableToEditAttachmentMobileOnly:L.jz.BitableAdvancedPermissionNoPermUploadAttachment)):f=L.jz.BitableAdvancedPermissionNoPermToEditFieldContent,s&&h.isStartEdit&&!(null!=l&&l.getIsReadonly())&&c&&(b||v||u)&&k.a.createElement(p.Tooltip,{title:f},k.a.createElement("div",{className:"bitable-editor-container-lock-bg",style:{left:-6,top:-6}},k.a.createElement(E.a,{className:"bitable-editor-container-lock",style:{left:2,top:2}})))},h.onSetSelectionByLocal=function(){var e=h.gridContext,t=e.getActiveCell();if(h.props.editing&&h.editorRef)if(t){var i=e.view,o=h.getCurrentEditRecordId(t),n=i.getVisibleFields()[t.col];if(h.cellInfo.fieldId!==n||h.cellInfo.recordId!==o){var r=null;h.state.cell&&(r={row:h.state.cell.row,col:h.state.cell.col}),h.cellInfo={recordId:o,fieldId:n},h.endEdit(h.editorRef.shouldCancelSaveOnBlur,r)}}else h.endEdit(h.editorRef.shouldCancelSaveOnBlur);if(t){var d=e.view,l=h.getCurrentEditRecordId(t),a=d.getVisibleFields()[t.col],s=d.table,c=Object(L.GK)(h.gridContext);h.setState({field:s.fields[a],rect:c,cell:{col:t.col,row:t.row},fieldId:a,recordId:l},function(){L.rx.isIPad&&!h.props.bitableStore.isEmbeddedInDoc||h.focusEditor(),L.rx.isIPad&&L.lx.close(),h.cellInfo={recordId:l,fieldId:a}})}else h.clearEditor()},h.onClickFasterDom=function(e){var t=e.target,i=["amap-labels"].some(function(e){return e===t.className});t&&t.tagName&&"CANVAS"===t.tagName.toUpperCase()&&!i&&(h.props.editing&&h.endEdit(),L.rx.isIPad&&!h.props.bitableStore.isEmbeddedInDoc||h.focusEditor())},h.onClickCheckboxSelection=function(){h.editorRef.isFocus?h.startEdit(!1,!0):h.editorRef.isFocus=!0},h.focusEditor=function(){h.focus()},h.onMouseDown=function(e){var t=Object(L.Cx)(h),i=t.rootAppDom,o=t.bitableContainer,n=t.editorContainerRef,r=t.gridContext,d=["mention-sheet","m-mention-box","bitable-mention","mention-bitable","J-card-edit-modal","bitable-mention-popover","bitable-reminder-entity-config-selector-overlay","card_edit_field_panel","formula-editor","formula-advanced-editor-modal","bitable-field-popover","b-select-edit-pannel","bitable-date-time-picker-select-list","bitable-attach-editor","bitable-toolbar-reminder","link-field-panel-editor","atuser-share-popover","do-not-blur-on-sheet-when-clicked","bitable-map-editor","bitable-map-editor-modal"],l=function(t){return t.classList&&d.some(function(e){return t.classList.contains(e)})};if(!Object(L.GJ)(e.target,l)&&i){var a=h.props.editing,s=h.props.renderer,c=e.target,b=h.getIsClickExpandRowIntro(c),v=document.getElementById("toolbar-cell-keep-focus");if(v&&v.contains(c))return;if("canvas"!==c.tagName.toLowerCase()&&(!a&&i.contains(c)&&!b||a&&n&&!n.contains(c))){var u=s.activeBitableWidget;u.isFloatLayerOpen&&(u.getActiveGridWidget().setSelection(null),u.setIsFloatLayerOpen(!1)),r.getSelection()&&r.setSelection(null)}else"canvas"===c.tagName.toLowerCase()&&o&&!o.contains(c)&&(s.activeBitableWidget.isFloatLayerOpen&&s.activeBitableWidget.setIsFloatLayerOpen(!1),r.getSelection()&&r.setSelection(null))}},h.handleBeforeUnload=function(e){var t=Object(L.Cx)(h).gridContext;t.getSelection()&&t.setSelection(null)},h.getIsClickExpandRowIntro=function(e){var t=h.props.mountOption,i=document.getElementById("expand_row_intro_callout_selector");return t&&t.overlayContainer&&t.overlayContainer.contains(i)&&i&&i.contains(e)},h.getIsFieldEditable=function(){var e,t=h.props,i=t.bitableStore,o=t.tableId,n=t.editable,r=h.state,d=r.fieldId,l=r.field;return!((null==l||null===(e=l.property)||void 0===e?void 0:e.optionsType)===L.JE.DYNAMIC)&&n&&i.hasPermission(L.qy.Field,{tableId:o,fieldId:d},L.ry.Editable)},h.getIsCellEditable=function(){var e=Object(L.Cx)(h),t=e.props,i=e.state,o=t.editable,n=t.bitableStore,r=t.recordEditMode,d=t.tableId,l=i.recordId,a=i.fieldId;return o&&n.hasPermission(L.qy.Cell,{tableId:d,fieldId:a||"",recordId:l||""},L.ry.Editable)&&r!==L.HJ.Card},h.updateEditorPosition=function(){if(!h.isUnmounted){var e=h.state,t=e.recordId,i=e.fieldId,o=h.state.cell;if(o&&t&&i){var n=Object(L.IJ)(h.gridContext,t,i,o);-1===n.col&&(n=o);var r=Object(L.GK)(h.gridContext,n);h.setState({cell:n,rect:r})}}},h.onClickToStartEditor=function(e){var t=e.teaSource,i=e.cell;t&&(h.teaSource=t),i&&!h.state.rect&&h.setState({rect:Object(L.GK)(h.gridContext,i)}),h.startEdit(!0)},h.uneditableFieldsTip=function(e,t,i){var o,n,r,d,l=null==e?void 0:e.fieldUIType,a=l===L.ex.Attachment&&0!==(null==e||null===(o=e.property)||void 0===o||null===(n=o.capture)||void 0===n?void 0:n.length),s=l===L.ex.Location&&(null==e||null===(r=e.property)||void 0===r?void 0:r.inputType)===L.FK.ONLY_MOBILE,c=l===L.ex.Barcode&&!1===(null==e||null===(d=e.allowedEditModes)||void 0===d?void 0:d.manual);switch(l){case L.ex.CreatedUser:h.showToolTip(t,L.jz.BitableFieldUnableToEditCreatedBy);break;case L.ex.ModifiedUser:h.showToolTip(t,L.jz.BitableFieldUnableToEditModifiedBy);break;case L.ex.CreatedTime:h.showToolTip(t,L.jz.BitableFieldUnableToEditDateCreated);break;case L.ex.ModifiedTime:h.showToolTip(t,L.jz.BitableFieldUnableToEditLastModifiedDate);break;case L.ex.Lookup:h.showToolTip(t,L.jz.BitableFieldUnableToEditLookup);break;case L.ex.Formula:h.showToolTip(t,L.jz.BitableFieldUnableToEditFormula);break;case L.ex.AutoNumber:h.showToolTip(t,L.jz.BitableFieldUnableToEditNumbering);break;default:i?h.setLocationAndAttachesTip({bitableWidget:t,isOnlyLocation:s,isOnlyAllowPhoto:a,isOnlyBarcode:c}):l===L.ex.Attachment?h.showToolTip(t,L.jz.BitableAdvancedPermissionNoPermUploadAttachment):h.showToolTip(t,L.jz.BitableAdvancedPermissionNoPermToEditFieldContent)}},h.setLocationAndAttachesTip=function(e){var t=e.bitableWidget,i=e.isOnlyLocation,o=e.isOnlyAllowPhoto,n=e.isOnlyBarcode;o?h.showToolTip(t,L.jz.BitableFieldUnableToEditAttachmentMobileOnly):i?h.showToolTip(t,L.jz.BitableFieldUnableToEditLocationMobileOnly):n&&h.showToolTip(t,L.jz.BitableFieldUnableToEditBarcodeMobileOnly)},h.showToolTip=function(e,t){var i,o=null==e||null===(i=e.getActiveGridWidget)||void 0===i?void 0:i.call(e).getCover();if(o){var n=o.mapToGlobal(new d.FPoint(o.width/2,0));e&&e.events.emit(L.kC.ShowTooltip,{x:n.x,y:n.y,title:t}),document.addEventListener("wheel",function(){return h.hideToolTip(e)},!0),document.addEventListener("mousemove",function(){return h.hideToolTip(e)},!0)}},h.hideToolTip=function(e){e.events.emit(L.kC.HideTooltip,{animate:!0})},h.onDBClickCell=function(){var e=h.props,t=e.bitableStore,i=e.renderer,o=e.tableId,n=Object(L.JJ)(t),r=Object(L.KJ)(t,o),d=Object(L.LJ)(t,o),l=t.base.isPro(),a=null==t?void 0:t.Options.isHistoryMode,s=t.isSyncTable(o);t.uiEventManager.emit(L.my.DoubleClickCell);var c=h.state,b=c.field,v=c.recordId,u=null==i?void 0:i.activeBitableWidget,f=b&&v&&Object(L.EK)(t,o,v,b.id),p=Object(L.MJ)()&&!(n||r||d||!l||a);s?(h.showToolTip(u,g("Bitable_DataReference_SyncFromOtherBase_CurrentTableViewOnly_Toast")),L.cz.collectBitableEvent(L.Rw.CcmBitableRecordEditDenyView,{reason:"is_sync_table"})):p&&b&&h.uneditableFieldsTip(b,u,f);var E=h.props.recordEditMode||L.HJ.Directly;!b||(Object(L.NJ)(b.type)||E!==L.HJ.Directly)&&E!==L.HJ.Card||Object(L.qz)(b)?L.hy.teaLog({key:L.iy.DoubleClickEditFail,field:b&&b.type,mode:E}):h.startEdit(!0)},h.getEditorStyle=function(){return h.props.editing&&h.state.rect?{width:h.state.rect.width,minHeight:h.state.rect.height}:Object(L.OJ)()},h.startEditByEvent=function(e){var t=e.keepValue;h.startEdit(t)},h.startEdit=function(){var o=0<arguments.length&&void 0!==arguments[0]&&arguments[0],n=1<arguments.length?arguments[1]:void 0;if(h.isStartEdit=!0,h.getIsCellEditable()){h.startEditAfterSetRef=null,h.editorRef&&L.ZG.start(L.PJ,{},{eventKey:L.QJ.EnterEdit});var e=h.gridContext,t=e.getActiveCell();if(t){var i=e.view,r=h.getCurrentEditRecordId(t),d=i.getVisibleFields()[t.col],l=i.table,a=l.id,s=l.getCellValue(r,d),c=h.props.recordEditMode||L.HJ.Directly,b=h.props,v=b.renderer,u=b.bitableStore.downgradeManager;h.isRecordFloating=v.activeBitableWidget.isFloatLayerOpen,u.cellCantEditableNotify({tableId:a,fieldId:d}),c===L.HJ.Directly?(e.showCell(t),v.startEdit(a,r,d),e.setIsEditing(!0),h.setState({cellValue:s,cell:t,recordId:r,fieldId:d,field:l.fields[d]},function(){h.updateEditorPosition();var e=h.state.field;if(e){var t=s;if(Object(L.DK)(e)){var i=e.property;t=i&&i.formula}h.editorRef?h.startEditorEdit(t,o,n):h.startEditAfterSetRef={value:t,keepValue:o,directlyEndEdit:n}}})):c===L.HJ.Card&&r&&h.props.showCardModal&&h.props.showCardModal(r,d)}}},h.startEditIfneeded=function(e){if(!h.props.editing){var t=e.metaKey,i=e.ctrlKey,o=e.altKey,n=e.keyCode;t||i||o||(Object(l.b)(e)&&n!==L.sx.Enter?h.startEdit():h.editorRef.setEditorValue(null))}},h.startEditorEdit=function(e,t,i){var o,n,r=h.state,d=r.field,l=r.fieldId;if(h.editorRef&&d){var a,s=h.props,c=s.bitableStore,b=s.tableId,v=null===(o=h.gridContext)||void 0===o||null===(n=o.getActiveCell)||void 0===n?void 0:n.call(o),u=v&&h.getCurrentEditRecordId(v);u&&l&&c.hasPermission(L.qy.Cell,{recordId:u,tableId:b,fieldId:l},L.ry.Editable)||(a={from:L.uH.NoPermissionContainer}),h.editorRef.onStartEdit(e,t,a),setTimeout(function(){L.ZG.send(L.On.BitablePerformanceStage,{stage:L.QJ.EnterEdit,field_type:d.type},{eventKey:L.QJ.EnterEdit})}),i&&h.endEdit()}},h.onKeyDown=function(e){var t=h.state.field,i=t&&t.type;e.keyCode!==L.sx.Enter&&i&&L.sy.instance.get(i).valueEditorIgnoreKeyDown||h.startEditIfneeded(e)},h.handleCopy=function(e){h.props.onCopy&&h.props.onCopy(e)},h.handleCut=function(e){h.props.onCut&&h.props.onCut(e)},h.handlePaste=function(e){h.props.onPaste&&h.props.onPaste(e);var t=h.state.field,i=t&&t.type;i&&L.sy.instance.get(i).supportCellPaste||e.stopPropagation()},h.bindDomEvent=function(){var e=Object(L.Cx)(h).editorContainerRef;h.props.fasterDom&&h.props.fasterDom.addEventListener("click",h.onClickFasterDom,!1),e.addEventListener("keydown",h.onKeyDown,!1),L.RJ.useTextArea||(e.addEventListener("copy",h.handleCopy,!0),e.addEventListener("cut",h.handleCut,!0),e.addEventListener("paste",h.handlePaste,!0)),(h.props.bitableStore.isEmbeddedInDoc?document.body:window).addEventListener("mousedown",h.onMouseDown,!1),window.addEventListener("beforeunload",h.handleBeforeUnload),window.addEventListener("resize",h.debounceUpdateEditorPosition)},h.unbindDomEvent=function(){var e=h.editorContainerRef;h.props.fasterDom&&h.props.fasterDom.removeEventListener("click",h.onClickFasterDom,!1),e.removeEventListener("keydown",h.onKeyDown,!1),L.RJ.useTextArea||(e.removeEventListener("copy",h.handleCopy,!0),e.removeEventListener("cut",h.handleCut,!0),e.removeEventListener("paste",h.handlePaste,!0)),(h.props.bitableStore.isEmbeddedInDoc?document.body:window).removeEventListener("mousedown",h.onMouseDown,!1),window.removeEventListener("beforeunload",h.handleBeforeUnload),window.removeEventListener("resize",h.debounceUpdateEditorPosition)},h.endEdit=function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=1<arguments.length?arguments[1]:void 0;if(h.isStartEdit=!1,h.editorRef&&h.gridContext.getEditing()&&!(h.editorRef&&h.editorRef.preventOnEndEdit||!1===h.editorRef.onEndEdit(e))){var i=h.props,o=i.renderer,n=i.bitableStore,r=i.tableId;if(o.endEdit(r),h.gridContext.setIsEditing(!1),h.state.field){var d=h.state.field.type;if(L.sy.instance.get(d).needLogOutsideEditor)try{var l,a=o.getActiveTableId(),s=o.getActiveViewId(),c=n.base.getTableById(a||""),b=c?c.getViewById(s||""):null,v=t||h.state.cell;L.ob.collectBitableEvent(L.On.BitableRecordEdit,Object.assign({smartable_token:n.md5Token,row:v?v.row:-1,col:v?v.col:-1,table_id:a,view_id:s,bitable_editor_type:"cell",bitable_view_type:L.Cz[null!==(l=null==b?void 0:b.type)&&void 0!==l?l:L.az.Grid],bitable_field_type:L.lC[h.state.field.fieldUIType]},Object(L.SJ)(d,h.editorRef),{data_source:n.Options.module,is_record_floating:h.isRecordFloating},o.getRecordEditLogParams()),!0)}catch(e){console.error(e),L.hy.ravenCatch(e)}}}},h.exitEdit=function(){h.endEdit(!0)},h.focus=function(){var e=h.props.bitableStore,t=document.querySelector(".etherpad-container-wrapper"),i=t?t.scrollTop:0,o=e.isEmbeddedInDoc?document.querySelector(".bear-web-x-container"):null,n=o?o.scrollTop:0;h.editorRef?(h.editorRef.focus&&h.editorRef.focus(),(t||i)&&console.log("Scroll when focus bitable editor"),h.focusAfterSetRef=!1):h.focusAfterSetRef=!0,t&&(t.scrollTop=i),o&&(o.scrollTop=n),L.rx.safari&&setTimeout(function(){t&&(t.scrollTop=i),o&&(o.scrollTop=n)})},h.onScrollChange=function(){h.props.editing&&h.updateEditorPosition()},h.onFasterUpdated=function(){h.props.editing&&h.updateEditorPosition()},h.getWidgetListeners=function(){var e;return Object(L.Ww)(e={},L.pC.ScrollChange,h.onScrollChange),Object(L.Ww)(e,L.pC.SelectionChangeByRemote,h.onSetSelectionByRemote),Object(L.Ww)(e,L.pC.SelectionChangeByLocal,h.onSetSelectionByLocal),Object(L.Ww)(e,L.pC.DBClickCell,h.onDBClickCell),Object(L.Ww)(e,L.pC.ClickToStartEditor,h.onClickToStartEditor),Object(L.Ww)(e,L.pC.RestoreSelection,h.focus),Object(L.Ww)(e,L.pC.ClickCheckboxSelection,h.onClickCheckboxSelection),Object(L.Ww)(e,L.pC.EditRecord,h.startEditByEvent),e},h.bindWidgetEvent=function(e){if(e){var t=h.getWidgetListeners();e.addGridEventsBindListener(t)}},h.unbindWidgetEvent=function(e){if(e){var t=h.getWidgetListeners();e.removeGridEventsBindListener(t)}},h.getContextListeners=function(){var e;return Object(L.Ww)(e={},L.my.ExitEditing,h.exitEdit),Object(L.Ww)(e,L.my.CompleteEditing,h.endEdit),Object(L.Ww)(e,L.ay.FasterUpdated,h.onFasterUpdated),e},h.bindContextEvent=function(){var e=h.getContextListeners(),t=h.props,i=t.bitableStore,o=t.renderer;i.addEventListeners(o.getActiveTableId(),e)},h.unbindContextEvent=function(){var e=h.getContextListeners(),t=h.props,i=t.bitableStore,o=t.renderer;i.removeEventListeners(o.getActiveTableId(),e)},h.setEditorContainerRef=function(e){h.editorContainerRef=e},h._handleRemoteFieldDelete=function(e,t){var i=h.state.fieldId;e===h.props.tableId&&t===i&&h.clearEditor(!0)},h._handleRemoteFieldChange=function(e,t){var i=h.state,o=i.fieldId,n=i.field,r=h.props.tableId,d=null==n?void 0:n.type,l=h.gridContext.view.table.getField(t),a=l?l.type:void 0;e===r&&t===o&&d!==a&&(Object(L.nG)(n)||Object(L.vy)(n))&&h.clearEditor(!0)},h.getCurrentEditRecordId=function(e){var t=h.props.renderer.activeBitableWidget,i=t.isFloatLayerOpen,o=t.floatRecordId,n=h.gridContext.view.getVisibleRecords()[e.row];return i&&(n=o),n},h.setEditorValue=function(){var e=h.gridContext,t=e.getActiveCell();if(t){var i=h.state.field;if(i&&h.editorRef){var o=e.view,n=h.getCurrentEditRecordId(t),r=o.getVisibleFields()[t.col],d=o.table.getCellValue(n,r);if(Object(L.DK)(i)){var l=i.property,a=l&&l.formula;h.editorRef.setEditorValue(a)}else h.editorRef.setEditorValue(d)}}},h.state={rect:null,cellValue:null,field:null,needFocusHolder:!1};var t=document.querySelector(".navigation-bar-wrapper");return t&&(h.focusOnlyEditorOffsetY=(t.offsetHeight||0)+a),h}return Object(L.bu)(o,i),Object(L.Pw)(o,[{key:"componentDidMount",value:function(){var e=this.props,t=e.fasterDom,i=e.bitableStore;this.gridContext=this.props.renderer.activeBitableWidget.getGridWidget(),this.bindWidgetEvent(this.gridContext),this.bindContextEvent(),this.bindDomEvent(),this.rootAppDom=Object(L.TJ)(this.editorContainerId),this.bitableContainer=t?Object(L.UJ)(t,L.gF):null,i.base.eventEmitter.addListener(L.Yx.FieldDel,this._handleRemoteFieldDelete),i.base.eventEmitter.addListener(L.Yx.FieldModify,this._handleRemoteFieldChange)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.props.viewId!==e.viewId&&(this.reset(),this.gridContext=this.props.renderer.activeBitableWidget.getGridWidget(),this.unbindWidgetEvent(this.gridContext),this.bindWidgetEvent(this.gridContext))}},{key:"componentDidUpdate",value:function(e,t){this.state.needFocusHolder&&!t.needFocusHolder&&this.focusEditor(),this.props.viewId!==e.viewId&&this.reset()}},{key:"componentWillUnmount",value:function(){var e=this.props.bitableStore;this.isUnmounted=!0,this.unbindWidgetEvent(this.gridContext),this.unbindDomEvent(),this.unbindContextEvent(),this.rootAppDom=null,this.bitableContainer=null,e.base.eventEmitter.removeListener(L.Yx.FieldDel,this._handleRemoteFieldDelete),e.base.eventEmitter.removeListener(L.Yx.FieldModify,this._handleRemoteFieldChange)}},{key:"clearEditor",value:function(e){if(e||!this.editorRef||!this.editorRef.preventOnEndEdit){var t={tableId:"",viewId:"",editing:!1,rect:null,cellValue:null,field:null},i=!(null==this.gridContext.getSelection()&&0===this.gridContext.getSelectRows().length);this.setState(Object.assign({},t,{needFocusHolder:i}))}}},{key:"reset",value:function(){this.endEdit(),this.clearEditor()}},{key:"isPositionUnderCell",value:function(e){return null!=e&&L.sy.instance.get(e).valueEditorPositionUnderCell}},{key:"editorContainerId",get:function(){var e=this.props,t=e.renderer,i=e.isFullScreenMode,o=t.getActiveTable();return Object(L.VJ)(Boolean(i),o?o.id:"")}},{key:"renderFocusOnlyEditor",value:function(){var t=this;return k.a.createElement(L.WJ,{ref:function(e){t.editorRef=e,t.editorRef&&t.editorRef.focus()},style:{width:0,height:10,border:"none",padding:0,overflow:"hidden"}})}},{key:"render",value:function(){var r=this,e=0,t=0,i=this.props,o=this.state,n=i.bitableStore,d=i.renderer,l=i.isAnonymousAccess,a=i.tableId,s=i.viewId,c=i.editing,b=i.isEditorHidden,v=o.recordId,u=o.fieldId,f=o.rect,p=o.cellValue,E=o.field,h=this.getIsCellEditable(),g=this.getIsFieldEditable(),m=E&&E.type;if(f){e=f.x,t=f.y;var y=Object(L.vy)(E)&&!E.isHasDeniedProperty();this.isPositionUnderCell(m)&&(!y||E&&E.validateValueInView(E.property.tableId))&&(t=t+f.height-1)}this.editorContainerRef&&(this.editorContainerRef.style.left="".concat(e,"px"));var C={tableId:a,bitableStore:n,renderer:d,editable:h,viewId:s,ref:function(e){if(r.editorRef=e,r.startEditAfterSetRef&&r.editorRef&&r.editorRef.onStartEdit){var t=r.startEditAfterSetRef,i=t.value,o=t.keepValue,n=t.directlyEndEdit;r.startEditAfterSetRef=null,r.startEditorEdit(i,o,n)}r.focusAfterSetRef&&r.editorRef&&r.focusEditor()&&r.setEditorValue()},executeAction:i.bitableStore.executeCommandImmediately,cardSyncMode:L.tx.RealTime,isAnonymousAccess:l,copyable:this.props.renderer.isCopyable()};if((!this.state.cell||!m)&&this.state.needFocusHolder)return k.a.createElement("div",{id:this.editorContainerId,className:"bitable-editor-container",style:{left:0,top:this.focusOnlyEditorOffsetY,position:"fixed"},ref:this.setEditorContainerRef},this.renderFocusOnlyEditor());var w=n.isEmbeddedInDoc?"app-main-container":"bitable-container",I=null;m&&f&&(I=L.sy.instance.get(m).renderValueEditor(Object.assign({recordId:v||"",fieldId:u||"",rect:f,width:null==f?void 0:f.width,field:E,value:p,style:this.getEditorStyle(),view:this.gridContext.view,anchorRef:this.editorContainerRef,relativeClass:w,fieldEditable:g,isOpen:!!c,fieldSetSource:this.teaSource,editorContainerId:this.editorContainerId,getPinyin:this.pinyinHelper.getPinYin,startEdit:this.startEdit,endEdit:this.endEdit},C)));var x=Object(L.JJ)(n),O=Object(L.KJ)(n,a),S=Object(L.LJ)(n,a),T=n.base.isPro(),R=n.Options.isHistoryMode,j=n.isSyncTable(a),F=Object(L.MJ)()&&!(x||O||S||!T||R),B=m&&(j||F)&&this.showLockIcon(n,a);return k.a.createElement("div",{id:this.editorContainerId,className:D()("bitable-editor-container",{hidden:b}),style:{left:e,top:t},ref:this.setEditorContainerRef},B,I)}}]),o}(k.a.Component),n=Object(L.lz)(t.prototype,"pinyinHelper",[e],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),t)}.call(this,b("vb163"))},vb540:function(e,t,i){"use strict";var o=i("vb144"),n=i.n(o),r=i("vb103"),d=i("vb151");function l(e){return r.createElement("svg",n()({width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),r.createElement("path",{d:"M16.583 9.333V7.111c0-2.453-2.053-4.444-4.583-4.444-2.53 0-4.583 1.99-4.583 4.444v2.222H5.733c-.589 0-1.066.478-1.066 1.067v9.867c0 .589.477 1.066 1.066 1.066h12.534c.589 0 1.066-.477 1.066-1.066V10.4c0-.59-.477-1.067-1.066-1.067h-1.684ZM12 16.89c-1.013 0-1.834-.796-1.834-1.778s.82-1.778 1.834-1.778c1.013 0 1.833.796 1.833 1.778S13.013 16.89 12 16.89ZM9.158 9.333V7.111c0-1.52 1.274-2.756 2.842-2.756 1.567 0 2.841 1.236 2.841 2.756v2.222H9.159Z",fill:"currentColor"}))}var a=r.forwardRef(function(e,t){return r.createElement(d.a,n()({icon:l},e,{ref:t,svgProps:{"data-icon":"BitableLockOutlined"}}))});t.a=a},vb950:function(e,t,i){"use strict";i.d(t,"a",function(){return r}),i.d(t,"b",function(){return o});var n=i("vb143");i("vb147"),i("vb103"),i("vb148");function o(e){var t=e.metaKey,i=e.ctrlKey,o=e.keyCode;return!t&&!i&&o!==n.sx.Space&&(o>=n.sx.A&&o<=n.sx.Z||o>=n.sx.Digit0&&o<=n.sx.Digit9||o>=n.sx.Numpad0&&o<=n.sx.Numpad9||o>=n.sx.Semicolon&&o<=n.sx.Grave||o>=n.sx.BracketLeft&&o<=n.sx.Quot||o>=n.sx.Asterisk&&o<=n.sx.Slash||o===n.sx.Space||o===n.sx.FirefoxEqual||o===n.sx.FirefoxMinus||(o===n.sx.Ime||o===n.sx.NoKeyCode)&&"Shift"!==e.key)}function r(e){var t=e.keyCode;return t>=n.sx.Digit0&&t<=n.sx.Digit9||t>=n.sx.Numpad0&&t<=n.sx.Numpad9||t===n.sx.NumpadDot||t===n.sx.Dot||t===n.sx.E||t===n.sx.Plus||t===n.sx.Minus}}}]);
//# sourceMappingURL=//slardar.bytedance.net/api_v2/browser/jserr/get_sourcemap?bid=docs_pc&js_filename=editor-container.f0b00a3449.chunk.js