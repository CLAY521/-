(window.webpackJsonp=window.webpackJsonp||[]).push([["6bc42ad08fbd"],{vb1928:function(e,T,F){"use strict";F.r(T),function(l){F.d(T,"DocTableView",function(){return V});var e,t,i,n=F("vb114"),J=F("vb143"),a=F("vb152"),s=F.n(a),r=F("vb145"),w=F("vb156"),d=F("vb192"),o=F("vb200"),c=F("vb172"),u=F("vb494"),b=F("vb212"),p=F("vb2143"),y=F("vb180"),W=F("vb103"),x=F.n(W),C=F("vb194"),B=(F("vb147"),F("vb119"),F("vb116")),h=(F("vb120"),F("vb121"),F("vb118"),F("vb117"),F("vb115"),F("vb112"),F("vb164"),F("vb167"),F("vb113"),F("vb174"),F("vb155"),F("vb159")),O=F.n(h),v=(F("vb111"),F("vb110")),_=F.n(v),f=F("vb967"),g=F("vb397"),m=F("vb185"),S=F("vb312"),k=(F("vb292"),F("vb129"),F("vb223"),F("vb214"),F("vb232"),F("vb187"),F("vb225"),F("vb224"),F("vb128"),F("vb148"),F("vb122"),F("vb233"),F("vb234"),F("vb235"),F("vb123"),F("vb236"),F("vb193"),F("vb237"),F("vb238"),F("vb124"),F("vb239"),F("vb104"),F("vb240"),F("vb134"),F("vb131"),F("vb226"),F("vb241"),F("vb125"),F("vb242"),F("vb127"),F("vb132"),F("vb227"),F("vb135"),F("vb228"),F("vb229"),F("vb133"),F("vb126"),F("vb243"),F("vb262"),F("vb244"),F("vb245"),F("vb246"),F("vb247"),F("vb248"),F("vb249"),F("vb201"),F("vb260"),F("vb267"),F("vb250"),F("vb136"),F("vb251"),F("vb130"),F("vb252"),F("vb543"),5),I=J.ob.ExternalConst.previewWrapperPrefix,Q=288,M=(e=Object(J.iF)(),t=Object(J.iF)(),i=function(i){function n(e){var Z;Object(J.ov)(this,n),(Z=i.call(this,e)||this).cursorMembers={},Z._toolBarHeight=f.c,Z._statusBarHeight=0,Z.virtualWrapperOffset=0,Z.instanceArr=[],Z.isScreenShoting=!1,Z._pendingSetZoom=!1,Z.templateCenterPreviewWrapper=null,Z.shortcutImgResolve=null,Z.fasterStyle={position:"relative",top:null,bottom:null,height:"auto"},Z.scrollableContainerRef=null,Z.onResizeInDoc=Object(y.a)(function(){if(Z.props.isFullScreenMode){var e;Z._updateViewportResize(),Z.updateFasterSize(),Z.viewType===J.az.Gallery&&(null===(e=Z.galleryContext)||void 0===e||e.rebuildAddWidget())}else{var t,i,n=null;if(Z.viewType===J.az.Grid){var a=Z.gridContext;if(!a)return;var r=a.getTableViewHint(),o=r.height;n=r.width,t=o+Z.toolBarHeight,i=a.x}else if(Z.viewType===J.az.Kanban){var s=Z.props,l=s.tableId,d=s.viewId,c=s.docWidth,u=Z.getActiveTableAndView(l,d).view;if(u&&u.isValid()){var b=Z.kanbanContext;if(!b)return;var p=b.getContentDocWidth();t=b.getContentDocHeight()+Z.toolBarHeight,n=p<c?c:p,i=b.x}}else if(Z.viewType===J.az.Gallery){var h=Z.props,v=h.tableId,f=h.viewId,g=h.docWidth,m=Z.getActiveTableAndView(v,f).view;if(m&&m.isValid()){var w=Z.galleryContext;if(!w)return;var y=w.getContentDocWidth();t=w.getContainerHeight()+Z.toolBarHeight,n=y<g?g:y,i=w.x}}else Z.viewType,J.az.Gantt;null!==n&&(Z._sizeAndHScrollChange(i,n+.1,t),Z._sizeAndHScrollChange(i,n,t))}},200),Z.handleShortcutImageReady=function(){var e,t;null===(e=(t=Z).shortcutImgResolve)||void 0===e||e.call(t),Z.shortcutImgResolve=null},Z.setAddViewLoadingState=function(e){null!=Z.state.isAddingView&&Z.setState({isAddingView:e})},Z.baseEditableRule=function(){return Z.props.support},Z.onHeightDidUpdate=function(e){Z.state.height!==e&&Z.props.shell.onHeightDidUpdate&&Z.props.shell.onHeightDidUpdate()},Z._setFasterDom=function(e){Z._fasterDom=e},Z._setBitableContainer=function(e){Z._bitableContainer=e},Z.getBitableWidgetConfig=function(){var e=Object(r.a)(Z.props.bitableStore,"bitableConfig.ui.bitableWidgetUIConfig",void 0),t={isFullScreen:Z.props.isFullScreenMode,disableRowHoverWidget:!1,disableSelection:!1,disableHScroll:!1,keepLastColumn:!0};return Object.assign({},t,{bitableStore:Z.props.bitableStore,storageManager:Z.props.renderer.storageManager,disableRowHoverWidget:J.ob.config.ui.disableRecordCardMode},e,{onContentLoaded:Z.onContentLoaded})},Z.onContentLoaded=function(){var e,t=Object(r.a)(Z.props.bitableStore,"bitableConfig.bitableContentLoaded");t&&t(),null===(e=Z.props.smartableCommentManager)||void 0===e||e.notifyCommentUpdate(),setTimeout(Object(J.uY)(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:Z.emitShortcutEvent();case 1:case"end":return e.stop()}},e)})),16)},Z.getContextListeners=function(){var e;return Object(J.Ww)(e={},J.ay.ChangesetApplied,Z.onChangesetApplied),Object(J.Ww)(e,J.ay.OperationProduced,Z.onOperationProduced),Object(J.Ww)(e,J.ay.CursorInfo,Z.updateCursorInfo),Object(J.Ww)(e,J.ay.UserLeave,Z.clearCursorInfo),Object(J.Ww)(e,J.ay.TableUpdated,Z.updateIfTableDeleted),e},Z.onOperationProduced=function(e){var t=e.updateActions;Z.updateIfGroupChanged({updateActions:t}),Z.updateIfCutPasteChanged({updateActions:t})},Z.onChangesetApplied=function(e){var t=e.updateActions;Z.updateIfGroupChanged({updateActions:t}),Z.updateIfViewPermChanged({updateActions:t})},Z.bindContextEvent=function(){var e=Z.getContextListeners(),t=Z.props,i=t.bitableStore,n=t.tableId;i.addEventListeners(n,e);var a=i.getBaseEventManager();a.addListener(J.ay.ViewModelUpdated,Z.handleViewModelUpdated),a.addListener(J.ay.UserLeave,Z.clearCursorInfo),i.uiEventManager.addListener(J.my.UpdateViewport,Z._updateViewportResize),Z.viewType===J.az.Grid?Z._bitableWidget.getGridWidget()._rightTable.contentDoc.addListener(B.FEventType.AfterFlush,Z.afterFlush):(Z._bitableWidget.getKanbanWidget().events.addListener(J.rC.AddRecord,Z.handleKanbanAddRecord),Z._bitableWidget.getKanbanWidget().events.addListener(J.rC.DocKanbanScroll,Z.handleScrollKanban))},Z.afterFlush=function(){return!Z.state.rendered&&Z.setState({rendered:!0}),!1},Z.handleScrollKanban=function(e){var t=e.delta;Z._scrollY(t)},Z.handleKanbanAddRecord=function(e){var t=e.trigger,i=void 0===t?J.IF.BottomButton:t,n=e.buttonPoint;if(!Z.props.isFullScreenMode&&Z._virtualWrap){var a=Z._virtualWrap.getBoundingClientRect(),r=a.top,o=a.bottom,s=Z.virtualWrapperOffset-r;if(i===J.IF.TopButton&&0<s)Z._virtualWrap.scrollIntoView();else if(i===J.IF.BottomButton&&Z.kanbanContext&&n){var l,d=n.y-Z.kanbanContext.y;0<=s?(l=Z.kanbanContext.height-d,Z.toolbarfixed||(l+=o)):l=window.innerHeight-Z.virtualWrapperOffset+s-Z.toolBarHeight-d,0<=l&&l<=Z.kanbanContext.cardListFooterHeight&&Z._scrollY(J.IE.cardInitialHeight+J.IE.cardBottomMargin)}}},Z.handleCreateBtnClick=function(){var e=Z.props.bitableStore.getCommandManager(),t=Z.props,i=t.tableId,n=t.viewId,a=Z.getActiveTableAndView(i,n).table;if(a){var r={type:J.og.SingleSelect,fieldUIType:J.ex.SingleSelect,name:a.getNewFieldDefaultName(J.ex.SingleSelect),property:{options:[],optionsType:J.JE.STATIC}};e.execute({cmd:J.Fy.AddField,tableId:i,viewId:n,data:r})}},Z.unbindContextEvent=function(){var e=Z.getContextListeners(),t=Z.props,i=t.bitableStore,n=t.tableId;i.removeEventListeners(n,e);var a=i.getBaseEventManager();a.removeListener(J.ay.ViewModelUpdated,Z.handleViewModelUpdated),a.removeListener(J.ay.UserLeave,Z.clearCursorInfo),i.uiEventManager.removeListener(J.my.UpdateViewport,Z._updateViewportResize),Z.viewType===J.az.Grid?Z._bitableWidget.getGridWidget()._rightTable.contentDoc.removeListener(B.FEventType.AfterFlush,Z.afterFlush):Z._bitableWidget.getKanbanWidget().events.removeListener(J.rC.AddRecord,Z.handleKanbanAddRecord)},Z.updateIfCutPasteChanged=function(e){var t=e.updateActions,i=Object(J.Cx)(Z).props,n=i.tableId,a=!1,r="";t&&t.map(function(e){if(e.tableId&&e.tableId!==n)return r=e.tableId,void(a=!0)}),r&&a&&i.notify&&i.notify({name:J.KE.UpdateBitableById,targetIds:[r]})},Z.updateIfGroupChanged=function(e){var t=e.updateActions,i=Z.props,n=i.tableId,a=i.viewId,r=i.bitableStore,o=i.support,s=i.offsetX,l=Z.getActiveTableAndView(n,a).view,d=!!l&&l.type===J.az.Kanban&&!l.isValid(),c=r.base.getTableById(n),u=Object(J.NA)(t,c,n,a,d);a&&n&&u&&(Z.clearListener&&Z.clearListener(),Z.clearListener=null,Z.applyFasterView(n,a),Z._setOffsetX(s),Z.clearListener=Z.bindAfterFlush()),o&&Z.updateSupportStatus()},Z.updateIfTableDeleted=function(e){var t=Z.props,i=t.tableId,n=t.bitableStore,a=t.viewId;if(e.action===J.LE.DeleteTable&&i===e.tableId){var r=e.referTableId,o=n.base.getTableById(i),s=o&&o.getViewById(a||"");if(s&&s.type===J.az.Kanban){var l=s,d=Z.getGroupFieldIdFromKanbanProperty(l);if(d){var c=o.fields[d];Object(J.vy)(c)&&!c.validateValueInView(r)&&Z.applyFasterView(i,a)}}}},Z.updateSupportStatus=function(){var e=Z.props,t=e.changeSupportStatus,i=e.tableId,n=e.bitableStore.base.getTableById(i);if(n){var a=n.fields;for(var r in a)if(a[r].type===J.og.NotSupport)return void t(!1);n.views.some(function(e){return e.type===J.az.NotSupport})&&t(!1)}},Z.updateCursorInfo=function(e){if(e){var t=e.member_id,i=e.data;Z.updateCursorMember(t,i)}var n=Z._bitableWidget.getActiveWidget();if(n){var a=Z.getCurrentTableMembers();n.updateCursor(a)}},Z.clearCursorInfo=function(e){var t=e.suiteType,i=e.token,n=e.data;(t===J.ME.Base&&i===Z.props.bitableStore.token||t===J.ME.Table&&i===Z.props.tableId)&&(Z.cursorMembers=Object(o.a)(Z.cursorMembers,n.member_id),Z.updateCursorInfo())},Z.getActiveTableAndView=function(e,t){var i=Z.props.bitableStore,n=e&&i.base.getTableById(e),a=n&&t&&n.getViewById(t);return{table:n,view:a}},Z.handleViewModelUpdated=function(){var e=Z.props.renderer.getActiveTableId(),t=Z.props.renderer.getActiveViewId();Z.applyFasterView(e,t)},Z.setFasterView=function(e){var t=Z.props,i=t.openGuidebar,n=t.editable,a=t.openCommentBar,r=t.openMentionBar,o=t.isAnonymousAccess,s=t.bitableStore.downgradeManager;e&&s.checkViewNotSupport({viewId:e.id,tableId:e.table.id})&&(e=null),Z._bitableWidget.setGuidebarStatus(i),Z._bitableWidget.setCommentBarStatus(a),Z._bitableWidget.setMentionBarStatus(r),Z._bitableWidget.setView(e,{editable:n,isAnonymousAccess:o}),Z._setIsFullScreen(Z.props.isFullScreenMode),e&&Z.updateCursorInfo()},Z.onHostClick=function(e){Z._setEmbedActiveTableId()},Z.toggleEmptyKanbanPlaceholder=function(e){Z.state.showEmptyKanbanPlaceholder!==e&&(Z.setState({showEmptyKanbanPlaceholder:e}),Z._updateViewportResize())},Z.renameToolbarView=function(){},Z.onCloseEditPopup=function(){var e=Z.props.tableId;Z.setState({cardGroupCellValues:[],cardAddRecordIndex:0,cardAddRecordDirection:J.qC.Down,showCardModal:!1}),Z.props.renderer.eventManager.emit(J.ay.ExitCardModalEdit),Z.props.toggleEditorInCardEdit(e,!1,null)},Z.afterClose=function(){if(Z._bitableWidget){var e=Z._bitableWidget.getGridWidget();e&&e.restoreSelection()}},Z.onTransitionEnd=function(){var e=Z.props.isOpenSidebar;Z.setState({fasterViewFold:e})},Z.onSidebarToggled=function(){var e=Z.getIsOpenSidebar();Z.setState({fasterViewFold:e})},Z.onAddRecord=function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:J.qC.Down,n=Z.props,a=n.bitableStore,r=n.tableId,o=a.base.getTableById(r);if(o){var s=o.getNewRecordId();Z.setState({cardGroupCellValues:e||[],cardAddRecordIndex:t,cardAddRecordDirection:i},function(){return Z.showCardModal(s)})}},Z.onSubmit=function(e,t){var i=Z.props,n=i.bitableStore,a=i.tableId,r=i.viewId,o=Z.state,s=o.cardAddRecordDirection,l=o.cardAddRecordIndex,d=o.cardGroupCellValues,c=Z.getActiveTableAndView(a,r).view;if(!c)return Z.onCloseEditPopup();n.getCommandManager().execute({cmd:J.Fy.AddRecord,tableId:a,viewId:r,recordId:e,groupCellValues:d,record:Object.entries(t).reduce(function(e,t){var i=Object(J.xz)(t,2),n=i[0],a=i[1].value;return Object.assign({},e,Object(J.Ww)({},n,{value:a}))},{}),index:l}),J.ob.collectBitableEvent(J.On.BitableRecordAdd,{table_id:a,view_id:r,bitable_view_type:J.Cz[c.type],bitable_record_direction:s||J.qC.Bottom,data_source:n.Options.module,action:J.UC.Click,record_number:1},!0),Z.onCloseEditPopup()},Z.showCardModal=function(e,t,i){var n=Z.props.tableId;Z.props.toggleEditorInCardEdit(n,!0,e,t),i&&Z.setState({showCardModal:!0})},Z.onScroll=function(){Z.instanceArr.forEach(function(e){return e.onScrollCore()})},Z.onWakeup=function(e){e&&Z.props.tableId!==e||Z._wakeup()},Z.findFirstTableIdByViewType=function(i){var e=Z.props,n=e.bitableStore,t=e.activeViewIdMap,a=n.getValidTables(t).find(function(e){var t=n.getCreateSource(n.token,e.id);return!(!e.type||e.type!==i||t.createdSource!==J.ob.ExternalConst.CreatedSource.USER_INSERT)});return a?a.id:void 0},Z._sizeAndHScrollChange=function(e,t,i,n,a){var r=Object(J.Cx)(Z).props;Z.viewType===J.az.Kanban&&(e+=10),r.shell.onHScrollChange&&r.shell.onHScrollChange(e,t),r.shell.onSizeAndScrollChange&&r.shell.onSizeAndScrollChange(e,t,i,n,a)},Z._syncVirtualScroll=function(){if(Z._virtualWrap){var e=Z.props.isFullScreenMode,t=Z.virtualWrapperOffset,i=window.innerHeight,n=Z._virtualWrap.getBoundingClientRect(),a=n.top,r=n.bottom,o=n.left;a-=t,r-=t;var s=Z.isInViewport();s?Z._wakeup():Z._suspend();var l=Z.getBlockAndCanvasHeight(),d=l.canvasHeight,c=l.blockHeight,u=0<=a?0:-a;if(s)if(Z.viewType===J.az.Grid){var b=Z.gridContext,p=Z.gridDocView;if(!b||!p)return;var h=b.transform,v=p.contentDoc,f=u/h.scaleY;!e&&v.updateByCfg({posY:f})}else if(Z.viewType!==J.az.Kanban||e||J.rx.isSafari)if(Z.viewType!==J.az.Gallery||e){if(Z.viewType===J.az.Gantt&&!e){var g,m=Z.ganttContext,w=null==m||null===(g=m.getGridWidgetInGantt())||void 0===g?void 0:g.getRightTableView();if(!m||!w)return;var y=m.transform,C=w.contentDoc,S=u/y.scaleY;C.updateByCfg({posY:S})}}else{var I=Z.galleryContext;if(I&&I.galleryGridView){var M=u/I.transform.scaleY;I.setPosY(M),I.rebuildAddWidget()}}else{var O=Z.kanbanContext;if(!O)return;if(O.board){var _=u/O.transform.scaleY;O.board.updateCardListsPosY({posY:_,blockHeight:c,top:a,bottom:r})}}Z.updateFasterSize();var W=i-a-t-Z.toolBarHeight;r<i?W=0:d<W&&(W=d),Z.handleActiveViewCeiling(c,d,a,r,o),Z._updateOverHeight(W)}},Z.handleActiveViewCeiling=function(e,t,i,n,a){if(Z._virtualWrap){var r=!1,o=Z.virtualWrapperOffset,s={position:"absolute",height:e+"px",left:null,right:null,top:null,bottom:null,overflow:null},l=110+Z.statusBarHeight;0<i?s.top=0:n<=e?(l<n&&!J.rx.isSafari&&1===Z.props.zoom&&(r=!0),s.bottom=0):(r=!0,s.position="fixed",s.top=o+"px",Z.props.isEmbeddedTemplateMode&&Z.props.bitableStore.isEmbeddedInDoc&&(s.overflow="hidden"),Z.scrollableContainerRef&&Z.scrollableContainerRef.current&&(s.left=a+"px",s.overflow="hidden",Z._virtualWrap.style.transform="none"));var d=Z._fasterWrap;if(Z.toolbarfixed!==r){var c=Z.props,u=c.editbarPinChanged,b=c.updateOverlayerPosition;Z.toolbarfixed=r,u&&u(r),b&&b()}d&&!p(s,Z.fasterStyle)&&(Object.assign(d.style,s),Z.fasterStyle=s),J.rx.isSafari||1!==Z.props.zoom?(Z.setStatusBarStyle({top:Z.statusBarTopOffset+"px",bottom:"auto"}),Z.props.updateOverlayerPosition&&Z.props.updateOverlayerPosition()):Z.updateViewShortCeiling(e,t,i,n)}function p(e,t){return e.position===t.position&&e.top===t.top&&e.bottom===t.bottom&&e.height===t.height&&e.left===t.left}},Z.onScrollCore=function(){Z.isFixSize(),Z._syncVirtualScroll()},Z._updateViewPortResizeCallback=function(){return Z.isScreenShoting||Z._updateViewportResize(),!1},Z._updateViewportResize=function(){var e=0,t=0,i=0,n=0,a=0,r=0,o=Z.props,s=o.isFullScreenMode,l=o.isEmbeddedTemplateMode,d=o.bitableStore.isEmbeddedInDoc,c=o.docWidth,u=o.offsetX,b=o.zoom,p="number"==typeof b?b:1;if(Z.viewNotSupport())return e=Q+Z.toolBarHeight,t=c+u,Z._sizeAndHScrollChange(u,t,e),void Z.updateRenderAreaSize(t,e);if(Z.viewType===J.az.Grid){var h=Z.gridContext;if(!h)return;if(s)e=window.innerHeight-Z.virtualWrapperOffset,t=Math.ceil(Z.props.maxWidth-Z._bitableWidget.squashedSize);else{var v=h.getTableViewHint(),f=v.height,g=v.width;e=f+Z.toolBarHeight;var m=t=g;Z._sizeAndHScrollChange(h.x,m,e),n=Math.ceil(Z.props.maxWidth);var w=h.x+2;t>Math.ceil(n)-Math.ceil(w)?t=n:t+=Math.ceil(Z.props.offsetX);var y=Z.props.maxHeight||1/0;y<e&&(e=y)}}else if(Z.viewType===J.az.Kanban){var C=Z.props,S=C.tableId,I=C.viewId,M=C.docWidth,O=Z.getActiveTableAndView(S,I).view;if(O&&O.isValid()){var _=Z.kanbanContext;if(!_)return;if(s)e=window.innerHeight-Z.virtualWrapperOffset,t=Math.ceil(Z.props.maxWidth-Z._bitableWidget.squashedSize);else{var W=_.getContentDocWidth();t=W<M?M:W,e=_.getContentDocHeight()+Z.toolBarHeight,n=Math.ceil(Z.props.maxWidth),i=_.x,r=t,Z._sizeAndHScrollChange(i,r,e),a=i+2,t>Math.ceil(n)-Math.ceil(a)?t=n:t+=Math.ceil(Z.props.offsetX);var x=Z.props.maxHeight||1/0;x<e&&(e=x)}}else{var B=Z.props,k=B.docWidth,E=B.maxWidth;e=s?window.innerHeight-Z.virtualWrapperOffset:J.IE.emptyKanbanPlaceholderHeight+Z.toolBarHeight,t=s?Math.ceil(E-Z._bitableWidget.squashedSize):k}}else if(Z.viewType===J.az.Gallery){var V=Z.props,T=V.docWidth,F=V.maxWidth,R=V.maxHeight,j=Z.galleryContext;if(j){if(s)t=Math.ceil(F-Z._bitableWidget.squashedSize),e=window.innerHeight-Z.virtualWrapperOffset;else{var H=j.layoutConfig.cardTheme.halfGap;t=(T+Math.ceil(Z.props.offsetX)+2*H)*p,e=j.getContainerHeight()+Z.toolBarHeight}Z._sizeAndHScrollChange(j.x,0,e),R&&R<e&&(e=R)}}else if(Z.viewType===J.az.Gantt){var z=Z.ganttContext;if(!z)return;var P=Z.props,L=P.maxWidth,D=P.docWidth,N=P.offsetX;if(s)e=window.innerHeight-Z.virtualWrapperOffset,t=Math.ceil(L-Z._bitableWidget.squashedSize);else{e=z.getTableViewHint().height+Z.toolBarHeight,z.source.ganttGridVisible?(i=0,r=t=L):(i=Math.floor(N),t=Math.ceil(D+N)*p,r=D),z.updateByCfg({x:i});var K=z.source.ganttGridVisible;Z._sizeAndHScrollChange(i,r,e,K,!0)}}if(l&&d){var U,X=Z.props.docWidth,Y=null===(U=Z.templateCenterPreviewWrapper)||void 0===U?void 0:U.getBoundingClientRect(),q=Y?X+(Y.width-X)/2:t;t=Math.min(t,q)}Z.updateRenderAreaSize(t,e)},Z.onEmbeddedToolbarWheel=function(e){Z.toolbarfixed&&Math.abs(e.deltaX)<=Math.abs(e.deltaY)&&Z._scrollY(e.deltaY)},Z.renderEmptyKanbanPlaceholder=function(){var e=Z.state,t=e.height,i=e.width,n=e.showEmptyKanbanPlaceholder,a=Z.props,r=a.offsetX,o=a.isFullScreenMode,s=a.editable,l=!o;return n&&x.a.createElement(g.a,{height:t-Z.toolBarHeight,width:i,offsetX:r,withBackground:l,editable:s,onCreateBtnClick:Z.handleCreateBtnClick})},Z.state={width:e.docWidth,height:68,fasterReady:!1,contextMenuPositionX:-1,contextMenuPositionY:-1,fasterViewFold:Z.getIsOpenSidebar(),rendered:!0,showEmptyKanbanPlaceholder:!1,cardGroupCellValues:[],cardAddRecordDirection:J.qC.Down,cardAddRecordIndex:0,isScreenShotMode:!1,screenShotBlob:null,isBlob:!1,isShowNewbieGuideModal:!1,isAddingView:!1,showCardModal:!1,showAddRecordCard:!1,showInvalidViewPlaceholder:!1,invalidViewPlaceholderDesc:"",delayComponentTimeout:!1};var t=e.shell;return t.onHeightWillUpdate&&t.onHeightWillUpdate(),Z.contextMenuService=Object(S.b)(e.bitableStore),Z}return Object(J.bu)(n,i),Object(J.Pw)(n,[{key:"componentDidMount",value:function(){var e,i=this,t=this.props,n=t.bitableStore,a=t.renderer,r=t.tableId,o=t.viewId,s=t.support,l=t.mountOption,d=this._fasterDom,c=l&&l.canvasReuseSwitcher;n.getPermissionStore().addBasePermissionRules([this.baseEditableRule],J.ry.Editable);var u=this.props.isFullScreenMode?this._bitableContainer:void 0,b=new J.QA(d,Object.assign({},this.getBitableWidgetConfig(),{canvasReuseSwitcher:c,language:J.ob.I18nConfig.language,connectContext:this.connectContextProvider.getConnectContext()}),u);this._bitableWidget=b,l&&l.setBitableFaster&&l.setBitableFaster(b.getFaster()),this.updateSidebarStatus(),b.exec();var p=Object(w.a)(function(){Object(J.NE)()&&Object(J.OE)()===J.PE.PDF||null==b||b.resize(),Object(J.NE)()&&i.viewType===J.az.Gallery||setTimeout(function(){i.emitShortcutEvent()},16)},500),h=Object(w.a)(function(e){var t=e[0].contentRect;i.setState({canvasWidth:t.width})},500),v=new C.a(function(){p()}),f=new C.a(function(e){h(e)});v.observe(d),f.observe(this._bitableContainer),this.resizeObserver=v,this.containerResizeObserver=f,I&&(this.templateCenterPreviewWrapper=document.querySelector(".".concat(I))),this.getOffsetX=function(){return i.props.offsetX||0},this._setIsFullScreen(this.props.isFullScreenMode);var g=document.querySelector(".app-main-container");if(g){var m=new C.a(function(){return i.initVirtualWrapperOffset()});m.observe(g),this.docResizeObserver=m}J.rx.isIPad&&document.addEventListener("visibilitychange",Object(y.a)(function(){"visible"===document.visibilityState&&i.forceUpdate()},100)),a.setActiveBitableWidget(b),r&&o&&this.applyFasterView(r,o),this.setState({fasterReady:!0}),null===(e=a.mentionPermissionManager)||void 0===e||e.bindCellRenderMiddleWare(),this.initToolbarHeight(),this.initVirtualWrapperOffset(),this._setCommentActionType(this.props.commentActionType),this._setMaxWidth(this.props.maxWidth),this._updatePadding(this.props.maxWidth,this.props.offsetX),this._setOffsetX(this.props.offsetX),this._setDocWidth(this.props.docWidth),this._setBlockMaxWidth(),this._updateViewportResize(),this.createVirtual(),this.addInstance(this),this.props.setOnScrollHandle&&this.props.setOnScrollHandle(this.onScroll),this._setZoom(this.props.zoom||1),window.addEventListener("resize",this.onResizeInDoc),Object(J.QE)()&&this._setFirstViewTableIdInDoc(this.props),s&&this.updateSupportStatus(),this.bindContextEvent(),this.switchToNewTableView(),this.bindCopyCutEvent()}},{key:"bindCopyCutEvent",value:function(){var e=this.props.renderer;this._bitableContainer&&(this._bitableContainer.addEventListener("copy",e.clipboardHelper.handleCopyCut,!1),this._bitableContainer.addEventListener("cut",e.clipboardHelper.handleCopyCut,!1))}},{key:"unBindCopyCutEvent",value:function(){var e=this.props.renderer;this._bitableContainer&&(this._bitableContainer.removeEventListener("copy",e.clipboardHelper.handleCopyCut,!1),this._bitableContainer.removeEventListener("cut",e.clipboardHelper.handleCopyCut,!1))}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this.props,i=t.tableId,n=t.viewId,a=t.openGuidebar,r=t.offsetX,o=t.maxWidth,s=t.docWidth,l=t.commentActionType,d=t.cardModalVisible,c=t.isSelect,u=t.isOpenSidebar,b=t.openCommentBar,p=t.openMentionBar,h=t.isFullScreenMode,v=t.fullScreenTableId,f=t.isOpenTableSidebar,g=t.support,m=t.bitableStore,w=e.tableId,y=e.viewId,C=e.openGuidebar,S=e.isOpenSidebar,I=e.isOpenTableSidebar,M=e.openCommentBar,O=e.openMentionBar,_=e.support;d&&(i!==w||n!==y&&!this.state.showCardModal)&&this.onCloseEditPopup(),i===w&&n===y||(this.unbindContextEvent(),this.props.renderer.setActiveTableId(e.tableId)),e.offsetX!==r&&this._setOffsetX(e.offsetX),e.maxWidth!==o&&(this._setMaxWidth(e.maxWidth),this._updatePadding(e.maxWidth,e.offsetX)),e.docWidth!==s&&this._setDocWidth(e.docWidth),e.commentActionType!==l&&this._setCommentActionType(e.commentActionType),e.isSelect!==c&&this._setSelect(e.isSelect,e.selectedStyle),i===w&&n!==y&&this.switchToNewView(),i===w&&n===y||this.applyFasterView(w,y),C!==a&&this._bitableWidget&&this._bitableWidget.setGuidebarStatus(C)&&this._bitableWidget.rebuild(),M!==b&&this._bitableWidget&&this._bitableWidget.setCommentBarStatus(M)&&this._bitableWidget.rebuild(),O!==p&&this._bitableWidget&&this._bitableWidget.setMentionBarStatus(O)&&this._bitableWidget.rebuild(),S!==u&&this._bitableWidget&&this._bitableWidget.setSidebarStatus(S)&&this._bitableWidget.rebuild(),I!==f&&this._bitableWidget&&this._bitableWidget.setSidebarStatus(I)&&this._bitableWidget.rebuild(),h||(v!==i||e.fullScreenTableId||this._wakeup(),e.fullScreenTableId===i&&this._suspend()),g!==_&&m.getPermissionStore().emitPermissionChange()}},{key:"UNSAFE_componentWillUpdate",value:function(e,t){var i=this.state.height,n=this.props.shell;i!==t.height&&n.onHeightWillUpdate&&n.onHeightWillUpdate()}},{key:"componentDidUpdate",value:function(e,t){var i=this.props;if(i.editable||!e.editable||i.bitableStore.getIsRecovering()||this.onCloseEditPopup(),i.tableId!==e.tableId?(i.bitableStore.switchTable(i.tableId),this.switchToNewTableView()):i.tableId&&i.bitableStore.isTableNotLoad(i.tableId)&&i.bitableStore.fetchClientVars({tableId:i.tableId}),this._setIsFullScreen(i.isFullScreenMode),i.tableId===e.tableId&&i.viewId===e.viewId||(this.applyFasterView(i.tableId,i.viewId),this.props.smartableCommentManager&&this.props.smartableCommentManager.handleSwitchTableOrView(),this.props.smartableMentionManager&&this.props.smartableMentionManager.handleSwitchTableOrView()),i.tableLoaded&&!e.tableLoaded&&this.applyFasterView(i.tableId,i.viewId),this._bitableWidget.setEditable(i.editable),i.isAnonymousAccess&&this._bitableWidget.setIsAnonymousAccess(i.isAnonymousAccess),this._bitableWidget.setIsPreview(i.mode!==J.ly.DEFAULT),i.zoom&&e.zoom!==i.zoom&&(this._setZoom(i.zoom),this.initToolbarHeight(),1!==i.zoom)){var n=this.props,a=n.setToolBarStyle,r=n.editbarPinChanged;r&&r(!1),a&&a({top:0,bottom:"auto"}),this.setStatusBarStyle({top:this.statusBarTopOffset+"px",bottom:"auto"}),this.activeViewWidget&&this.activeViewWidget.updateByCfg({y:0})}!1===e.isMounted&&!0===i.isMounted&&this.initToolbarHeight(),this.statusBarHeight!==this._statusBarHeight&&(this.initToolbarHeight(),this._updateViewportResize()),e.maxWidth===i.maxWidth&&e.offsetX===i.offsetX&&e.viewId===i.viewId||(this._setOffsetX(i.offsetX),this._updateViewportResize(),this._setBlockMaxWidth(),this._setMaxWidth(i.maxWidth),this._updatePadding(i.maxWidth,i.offsetX)),i.tableId===e.tableId&&i.viewId===e.viewId||(this.clearListener&&this.clearListener(),this.clearListener=null,this.updateActiveModel(i)&&(this.clearListener=this.bindAfterFlush(),this._setCommentActionType(i.commentActionType))),this.isTableOrViewChangeInFeatureOnboarding(e,i)&&this._setFirstViewTableIdInDoc(this.props),this.updateFasterSize(),this.handleCeiling(),this.onHeightDidUpdate(t.height),e.isOpenSidebar!==i.isOpenSidebar&&this.onSidebarToggled(),e.isOpenTableSidebar!==i.isOpenTableSidebar&&this.onSidebarToggled(),this.bindContextEvent()}},{key:"componentWillUnmount",value:function(){var e;this.removeInstance(this),this.clearListener&&this.clearListener(),(this.clearListener=null)===(e=this.virtualObserver)||void 0===e||e.disconnect(),window.removeEventListener("resize",this.onResizeInDoc),this._bitableWidget.destroy(),this.resizeObserver.disconnect(),this.containerResizeObserver.disconnect(),this.docResizeObserver&&this.docResizeObserver.disconnect(),this.unbindContextEvent(),this.props.bitableStore.getPermissionStore().removeBasePermissionRule(this.baseEditableRule,J.ry.Editable),this._setFirstViewTableIdInDoc(this.props),this.contextMenuService.dispose(),this.unBindCopyCutEvent()}},{key:"updateSidebarStatus",value:function(){this._bitableWidget.setSidebarStatus(this.getIsOpenSidebar())}},{key:"getIsOpenSidebar",value:function(){var e=this.props,t=e.bitableStore,i=e.isOpenTableSidebar,n=e.mode,a=t.embeddedType;return n===J.ly.DEFAULT&&(a===J.pA.BitableInd||a===J.pA.Default?!Object(J.NE)()&&this.props.isOpenSidebar:i)}},{key:"getCurrentBitable",value:function(){var e,t=this.props.bitableStore.base;return t&&(e=t.getTableById(this.props.tableId)),e}},{key:"isTableOrViewChangeInFeatureOnboarding",value:function(e,t){var i=t.userGuideStatusLoaded;return i&&Object(J.QE)()&&(i!==e.userGuideStatusLoaded||t.tableId!==e.tableId||t.viewId!==e.viewId)}},{key:"_setZoom",value:function(e){var t=this._bitableWidget.getActiveWidget(),i=this._bitableWidget.getFaster();t&&(t.zoomContent(e,i.isActive),i.isActive?this._pendingSetZoom=!1:this._pendingSetZoom=!0)}},{key:"updateActiveModel",value:function(e){var t=e.bitableStore,i=e.tableId,n=e.viewId,a=t.base.getTableById(i),r=a&&n&&a.getViewById(n);return!(!a||!r)}},{key:"emitShortcutEvent",value:function(){if(Object(J.NE)()){var e=this.props;window.dispatchEvent(Object(J.RE)("bitableDidRender",{detail:{tableId:e.tableId,viewId:e.viewId}}))}}},{key:"updateIfViewPermChanged",value:function(e){var t=e.updateActions;if(t){var i=this.props,n=i.tableId,a=i.viewId;t.some(function(e){return e.action===J.Od.SetViewPublicLevel&&e.tableId===n&&e.viewId===a})&&this.applyFasterView(n,a)}}},{key:"getGroupFieldIdFromKanbanProperty",value:function(e){var t=e.getGroupInfos()||[];return t.length?t[0].fieldId:null}},{key:"initToolbarHeight",value:function(){var e=this._virtualWrap,t="number"==typeof this.props.zoom?this.props.zoom:1,i=f.c*t;if(e){var n=this.props.isFullScreenMode?0:this.statusBarHeight;this._statusBarHeight=n,this._toolBarHeight=i+n}else this._toolBarHeight=i}},{key:"toolBarHeight",get:function(){var e=this.props,t=e.isFullScreenMode,i=e.view,n=this._toolBarHeight;return t&&(n+=[J.az.Grid,J.az.Gantt].includes(i.type)?J.SE:0),n}},{key:"initVirtualWrapperOffset",value:function(){var e;if(this.props.isFullScreenMode)e=0;else if(this.props.isEmbeddedTemplateMode&&this.props.bitableStore.isEmbeddedInDoc){var t,i=null===(t=this.templateCenterPreviewWrapper)||void 0===t?void 0:t.getBoundingClientRect();e=(null==i?void 0:i.top)||0}else{var n=document.querySelector(".navigation-bar-wrapper .navigation-bar-wrapper")||document.querySelector(".navigation-bar-wrapper"),a=n?n.getBoundingClientRect().bottom:0,r=document.querySelector(".suite-body");e=r?Math.max(r.getBoundingClientRect().top,a):0}this.virtualWrapperOffset=e}},{key:"viewType",get:function(){var e=this.props.view;return e&&e.type}},{key:"activeViewWidget",get:function(){var e;return(e={},Object(J.Ww)(e,J.az.Grid,this.gridContext),Object(J.Ww)(e,J.az.Kanban,this.kanbanContext),Object(J.Ww)(e,J.az.Gantt,this.ganttContext),Object(J.Ww)(e,J.az.Gallery,this.galleryContext),e)[this.viewType]||null}},{key:"gridContext",get:function(){var e=this.props.view;if(!e||e.type!==J.az.Grid)return null;var t=this._bitableWidget.getActiveWidget();return t instanceof J.TE?t:this._bitableWidget.getGridWidget()}},{key:"kanbanContext",get:function(){var e=this.props.view;if(!e||e.type!==J.az.Kanban)return null;var t=this._bitableWidget.getActiveWidget();return t instanceof J.RA?t:this._bitableWidget.getKanbanWidget()}},{key:"galleryContext",get:function(){var e=this.props.view;if(!e||e.type!==J.az.Gallery)return null;var t=this._bitableWidget.getActiveWidget();return t instanceof J.UE?t:this._bitableWidget.getGalleryWidget()}},{key:"ganttContext",get:function(){var e=this.props.view;if(!e||e.type!==J.az.Gantt)return null;var t=this._bitableWidget.getActiveWidget();return t instanceof J.VE?t:this._bitableWidget.getGanttWidget()}},{key:"gridDocView",get:function(){var e=this.gridContext;return e?e.getRightTableView():null}},{key:"getMemberMap",value:function(){var e=this.props.members;return e?Object(c.a)(e,"member_id"):[]}},{key:"updateCursorMember",value:function(e,t){var i=J.ob.CommonUtil.getColorByMember,n=this.getMemberMap(),a=Object(J.xE)(),r=n[e];if(r){var o=i&&i(r,{isDoc:!0});o||(o=a[r.color_id%a.length]),this.cursorMembers[e]={color:o,cursorInfo:t,memberInfo:r}}this.cursorMembers=Object(d.a)(this.cursorMembers,Object.keys(n))}},{key:"getCurrentTableMembers",value:function(){var a={},e=this._bitableWidget.getView();if(!e)return{};var r=e.table.id,o=Object(b.a)(e.getVisibleRecords()),s=Object(b.a)(e.getVisibleFields());return Object(p.a)(this.cursorMembers,function(e,t){if(e.cursorInfo.table_id===r){var i=parseInt(o[e.cursorInfo.record_id],10),n=parseInt(s[e.cursorInfo.field_id],10);if(Object(u.a)(i)||Object(u.a)(n))return;a[t]=Object.assign({},e,{cell:{row:i,col:n}})}}),a}},{key:"applyFasterView",value:function(e,t){var i=this.getActiveTableAndView(e,t),n=i.view,a=i.table;if(a){if(n&&!Object(J.zz)(n.viewPermission))return this.setFasterView(null),void this.toggleInvalidViewPlaceholder(!0,l("bitable.view_attribute_no_view_perssion"));this.toggleInvalidViewPlaceholder(!1,""),n&&n.isValid()?(this.setFasterView(n),this.toggleEmptyKanbanPlaceholder(!1),t&&this.props.renderer.switchView(this.props.bitableStore.base,e,t)):(this.setFasterView(null),n&&n.type===J.az.Kanban&&this.handleInvalidKanbanView(a,n))}else this.setFasterView(null)}},{key:"handleInvalidKanbanView",value:function(e,t){var i=this.props,n=i.editable,a=i.bitableStore,r=t.getGroupField();if(Object(J.vy)(r)&&r.property.tableId&&a.base.isDeniedTable(r.property.tableId))this.toggleInvalidViewPlaceholder(!0,l("Bitable_AdvancedPermission_NoPermissionToViewKanban"));else{var o=this.getGroupFields(e,t);if(o&&o.length&&n){if(0<o.length){var s=o[0];this.setGroupField(s,!0,t)}}else this.toggleEmptyKanbanPlaceholder(!0)}}},{key:"onContextMenu",value:function(e){this.onHostClick(e),this.setState({contextMenuPositionX:e.clientX,contextMenuPositionY:e.clientY})}},{key:"getGroupFields",value:function(e,t){var i=t.getAllFields(),n=e.fields;return i.map(function(e){return n[e]}).filter(function(e){return Object(J.vy)(e)?e.validateValueInView(e.property.tableId):Object(J.hB)(e.type)}).sort(function(e,t){return Object(J.WE)(t)-Object(J.WE)(e)}).map(function(e){return e.id})}},{key:"toggleInvalidViewPlaceholder",value:function(e,t){this.state.showInvalidViewPlaceholder!==e&&this.setState({showInvalidViewPlaceholder:e,invalidViewPlaceholderDesc:t})}},{key:"setGroupField",value:function(e){var t,i,n=1<arguments.length&&void 0!==arguments[1]&&arguments[1],a=2<arguments.length?arguments[2]:void 0,r=this.props,o=r.bitableStore,s=r.tableId,l=r.viewId;if(a?(t=a.table.id,i=a.id):(t=s,i=l,a=this.getActiveTableAndView(t,l).view),a&&a.type===J.az.Kanban){var d=a.getGroupInfos();if(d.length&&d[0].fieldId===e)return;if(o.getCommandManager().execute({cmd:J.Fy.SetGroup,tableId:t,viewId:i,group:[{fieldId:e,desc:!1}],justExecute:n}).result===J.Ey.Success&&this.setFasterView(a),!n){var c=Object(J.XE)(a);J.ob.collectBitableEvent(J.On.BitableSetGroup,{bitable_view_type:"kanban",source:"modal",data_source:o.Options.module,bitable_field_type:c},!0)}}}},{key:"hiddenGroupField",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],i=this.props,n=i.tableId,a=i.viewId,r=i.bitableStore,o=this.getActiveTableAndView(n,a).view;if(o&&o.type===J.az.Kanban){if(o.getIsFieldHidden(e))return;r.getCommandManager().execute({cmd:J.Fy.SetFieldHidden,tableId:n,viewId:a,fieldIds:[e],data:{hidden:!0},justExecute:t})}}},{key:"renameView",value:function(e){this.props.isOpenSidebar&&this.sidebarRef&&this.sidebarRef.onViewRename(Object(J.YE)(e))}},{key:"onSuspend",value:function(e){e&&this.props.tableId!==e||this._suspend()}},{key:"bindAfterFlush",value:function(){var e,t=null===(e=this.activeViewWidget)||void 0===e?void 0:e.getViewportResizeWidgets();if(!t)return null;var i=this._updateViewPortResizeCallback;return t.forEach(function(e){return null==e?void 0:e.addListener(B.FEventType.AfterFlush,i)}),function(){t.forEach(function(e){return null==e?void 0:e.removeListener(B.FEventType.AfterFlush,i)})}}},{key:"addInstance",value:function(e){0===this.instanceArr.length&&window.addEventListener("scroll",this.onScroll,!0),this.instanceArr.push(e)}},{key:"removeInstance",value:function(t){this.instanceArr=this.instanceArr.filter(function(e){return e!==t}),0===this.instanceArr.length&&window.removeEventListener("scroll",this.onScroll,!0)}},{key:"_wakeup",value:function(){var e=this._bitableWidget.getFaster();e.isActive||(e.wakeup(),this._pendingSetZoom&&this.props.zoom&&this._setZoom(this.props.zoom))}},{key:"_suspend",value:function(){var e=this._bitableWidget.getFaster();e.isActive&&e.suspend()}},{key:"_setFirstViewTableIdInDoc",value:function(e){var t=e.bitableStore,i=e.setOnboardingGridTableId,n=e.setOnboardingKanbanTableId;t.isAllTableLoaded()&&(i(this.findFirstTableIdByViewType(J.az.Grid)),n(this.findFirstTableIdByViewType(J.az.Kanban)))}},{key:"_setCommentActionType",value:function(e){var t,i;null===(t=this.activeViewWidget)||void 0===t||null===(i=t.setCommentActionType)||void 0===i||i.call(t,e)}},{key:"_setIsFullScreen",value:function(e){var t,i;null===(t=this.activeViewWidget)||void 0===t||null===(i=t.setIsFullscreen)||void 0===i||i.call(t,e),e&&this._setEmbedActiveTableId()}},{key:"_setEmbedActiveTableId",value:function(){var e=this.getCurrentBitable();e&&Object(J.ZE)(this.props.renderer.reduxStore.getState())!==e.id&&this.props.setEmbedActiveTableId(e.id)}},{key:"_setSelect",value:function(e,t){var i,n;null===(i=this.activeViewWidget)||void 0===i||null===(n=i.setSelect)||void 0===n||n.call(i,e,t)}},{key:"_setOffsetX",value:function(e){var t;null===(t=this.activeViewWidget)||void 0===t||t.setOffsetX(e)}},{key:"_updateOverHeight",value:function(e){var t,i;null===(t=this.activeViewWidget)||void 0===t||null===(i=t.updateOverHeight)||void 0===i||i.call(t,e)}},{key:"_updatePadding",value:function(e,t){if(this._virtualWrap){var i=this.gridContext;if(i){var n=this._virtualWrap.getBoundingClientRect().left;if(0===n){var a=$(this._virtualWrap).closest(".block-placeholder")[0];n=a?a.getBoundingClientRect().left:t}n+e+J.aF>=window.innerWidth?i.setRightMargin(!0):i.setRightMargin(!1)}}}},{key:"_setMaxWidth",value:function(e){var t,i;null===(t=this.activeViewWidget)||void 0===t||null===(i=t.setMaxWidth)||void 0===i||i.call(t,e)}},{key:"_setDocWidth",value:function(e){this._bitableWidget.getGridWidget().setDocWidth(e)}},{key:"_setBlockMaxWidth",value:function(){var e=this.props,t=e.maxWidth,i=e.isFullScreenMode,n=window.innerWidth,a=this.activeViewWidget;if(a)if(i)a.setBlockMaxWidth(n);else{var r=this._bitableContainer,o=r&&r.getBoundingClientRect();if(o&&0===o.left){var s=$(r).closest(".block-placeholder")[0];o=s&&s.getBoundingClientRect()}if(o){for(var l=document.querySelectorAll(".comment-panel"),d=o,c=d.left,u=d.top,b=d.bottom,p=!1,h=0,v=0,f=l.length;v<f;v++){var g=l[v].getBoundingClientRect(),m=g.top,w=g.bottom;if(h=n-g.left+5,m<=u&&u<=w){p=!0;break}if(m<=b&&b<=w){p=!0;break}if(u<=m&&w<=b){p=!0;break}}var y=c-1,C=n-y-(p?h:0);(C<t||t===n-y-h)&&(C=t),a.setBlockMaxWidth(C)}}}},{key:"observerVirtual",value:function(){var i=this;this.virtualObserver=new MutationObserver(function(e,t){e.forEach(function(e){i._bitableWidget.getFaster().setOffsetDirty()})});var e={childList:!0,attributes:!0},t=this._fasterDom.querySelector("canvas");t&&this.virtualObserver.observe(t,e)}},{key:"createVirtual",value:function(){var t=this;if(this._fasterDom){this.updateActiveModel(this.props)&&(this.clearListener=this.bindAfterFlush()),this.observerVirtual();var e=this._bitableWidget.getRootWidget();e&&!J.rx.isIPad&&e.addListener(B.FEventType.MouseWheel,function(e){return Math.abs(e.deltaX)<=Math.abs(e.deltaY)&&(t._scrollY(e.deltaY),e.preventDefault(),e.srcEventPreventDefault()),!1})}}},{key:"_scrollY",value:function(e){if(0<Math.abs(e)){var t=this._scrollParent(this._fasterDom);if(t instanceof Window||t instanceof Document||t instanceof HTMLBodyElement){var i=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,n=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0;window.scrollTo(n,i)}else{var a=t.scrollTop+e,r=t.scrollLeft;t.scrollTo?t.scrollTo(r,a):(t.scrollTop=a,t.scrollLeft=r)}}}},{key:"_scrollParent",value:function(e){var t=e;if(this.scrollContainer)return this.scrollContainer;for(var i=t&&getComputedStyle(t);t&&(t.scrollHeight<=t.clientHeight||"scroll"!==i.overflowY&&"auto"!==i.overflowY&&"overlay"!==i.overflowY);)i=(t=t.parentElement)&&getComputedStyle(t);return this.scrollContainer=t||window,this.scrollContainer}},{key:"isInViewport",value:function(){var e=100;if(!this._virtualWrap)return!1;var t=this.virtualWrapperOffset,i=window.innerHeight,n=this._virtualWrap.getBoundingClientRect(),a=n.top,r=n.bottom,o=n.width,s=n.height;return!(!o||!s||(r-=t)<-e||i+e<(a-=t))}},{key:"updateFasterSize",value:function(){var e=this._bitableWidget.getRootWidget(),t=this._bitableWidget.getFaster();if(this.isInViewport()&&this._wakeup(),e){var i=this.getBlockAndCanvasHeight().canvasHeight;t.resize(this.state.width,i),e.updateByCfg({width:this.state.width,height:i});var n=this._bitableWidget.getFaster();n&&n.resize(this.state.width,i)}}},{key:"getBlockAndCanvasHeight",value:function(){var e=this.props,t=e.isFullScreenMode,i=e.isEmbeddedTemplateMode,n=e.bitableStore.isEmbeddedInDoc,a=window.innerHeight,r=this.virtualWrapperOffset,o=this.state.height;if(t)return{blockHeight:a-r,canvasHeight:this._fasterDom?this._fasterDom.clientHeight:0};if(i&&n){var s,l=Math.min(o,a-r),d=null===(s=this.templateCenterPreviewWrapper)||void 0===s?void 0:s.getBoundingClientRect();return{blockHeight:l=d?Math.min(d.bottom-d.top,l):l,canvasHeight:l-this.toolBarHeight}}var c=Math.min(o,a-r);return{blockHeight:c,canvasHeight:c-this.toolBarHeight}}},{key:"handleCeiling",value:function(){if(this._virtualWrap){var e=this.virtualWrapperOffset,t=this._virtualWrap.getBoundingClientRect(),i=t.top,n=t.bottom,a=t.left;i-=e,n-=e;var r=this.getBlockAndCanvasHeight(),o=r.canvasHeight,s=r.blockHeight;this.handleActiveViewCeiling(s,o,i,n,a)}}},{key:"statusBarHeight",get:function(){return this.statusBarRef&&this.statusBarRef.getBoundingClientRect().height||0}},{key:"updateViewShortCeiling",value:function(e,t,i,n){if(!this.props.isFullScreenMode&&!this.viewNotSupport()){var a=this.activeViewWidget;if(a){var r=this.props,o=r.setToolBarStyle,s=r.updateOverlayerPosition,l=0,d=0,c=4,u=a instanceof J.TE,b=a instanceof J.RA,p=Object(J.bF)(a),h=a instanceof J.UE;if(u)l=a.colHeaderHeight,d=a.bottomMargin+c;else if(b){if(!a.board)return;l=J.IE.listHeaderHeight,d=0}else p&&(l=a.colHeaderHeight,d=0);var v=a.transform.scaleY,f=(l+d)*v+this.statusBarHeight,g=Math.max(n,f)-this.toolBarHeight,m=g<f?f:g;if(i<0&&n<=e&&0<n){o&&o({top:"auto",bottom:m+this.statusBarHeight+"px"}),this.setStatusBarStyle({top:"auto",bottom:m+k+"px"});var w=Math.max(g,f),y=t-w,C=u||p||h?w:t;if(a.updateByCfg({y:y/v,height:C/v}),u){var S=a.getRightTableView().contentDoc;S.addOnceListener(B.FEventType.AfterFlush,function(){return S.updateByCfg({posY:S.maxPosY}),!1})}else if(b){var I=a.board;if(I){var M=I.getCardListMaxHeight();I.updateCardListsPosY({posY:M+y})}}else if(p){var O=a._rightTable.contentDoc;O.addOnceListener(B.FEventType.AfterFlush,function(){return O.updateByCfg({posY:O.maxPosY}),!1})}else if(h){var _=a.galleryGridView;_&&_.addOnceListener(B.FEventType.AfterFlush,function(){var e=_.docSize().height;return a.setPosY(e),a.rebuildAddWidget(),!1})}}else o&&o({top:0,bottom:"auto"}),this.setStatusBarStyle({top:this.statusBarTopOffset+"px",bottom:"auto"}),a.updateByCfg({y:0,height:t/v});s&&s()}}}},{key:"isFixSize",value:function(){return this.props.maxHeight&&this.props.maxHeight!==1/0}},{key:"renderCardModal",value:function(){var e=this.props,t=e.bitableStore,i=e.viewId,n=e.tableId,a=e.cardModalVisible,r=e.cardRecordId,o=e.cardFieldId,s=e.renderer,l=e.smartableCommentManager,d=e.isAnonymousAccess,c=e.isVCEnable,u=e.isFullScreenMode;if(e.fullScreenTableId===n&&!u)return null;var b=t.getMountSource(),p=this.state.fasterReady;return i&&p?x.a.createElement(x.a.Fragment,null,b!==J.Bz.History&&b!==J.Bz.Template?x.a.createElement(J.cF,{cardSyncMode:J.ob.config.cardSyncMode,modalVisible:(a||this.state.showCardModal)&&!this.state.showAddRecordCard,recordId:r,fieldId:o,tableId:n,viewId:i,bitableStore:t,onClose:this.onCloseEditPopup,renderer:s,afterClose:this.afterClose,smartableCommentManager:l,mask:!0,forSelfTable:!0,isAnonymousAccess:d,source:J.sz.View,isVCEnable:c,isFullScreenMode:u}):x.a.createElement(J.VA,{modalVisible:a||this.state.showCardModal,recordId:r,viewId:i,bitableStore:t,tableId:n,onClose:this.onCloseEditPopup,renderer:s,afterClose:this.afterClose,mask:!0,forSelfTable:!0,source:J.sz.View}),x.a.createElement(J.xB,{cardSyncMode:J.ob.config.cardSyncMode,modalVisible:(a||this.state.showCardModal)&&!this.state.showAddRecordCard,recordId:r,fieldId:o,tableId:n,viewId:i,onClose:this.onCloseEditPopup,afterClose:this.afterClose,smartableCommentManager:l,mask:!0,forSelfTable:!0,source:J.sz.View,isVCEnable:c,isFullScreenMode:u})):null}},{key:"setStatusBarStyle",value:function(e){function t(e,t){return e.top===t.top&&e.bottom===t.bottom}this.props.renderStatusBar&&e&&this.statusBarRef&&!t(this.statusBarRef.style,e)&&Object.assign(this.statusBarRef.style,e)}},{key:"renderFullScreenShot",value:function(){var e=this,t=this.props,i=t.renderScreenShotToolbar,n=t.offsetX,a=this.state,r=a.isBlob,o=a.screenShotBlob,s="";o&&(s=r?window.URL.createObjectURL(o):o);var l={paddingLeft:n};return x.a.createElement("div",{className:"bitable-print"},i&&i(l,this.onEmbeddedToolbarWheel),o&&x.a.createElement("div",null,x.a.createElement("img",{src:s,style:{zoom:1/(window.devicePixelRatio||1)},onLoad:function(){r&&window.URL.revokeObjectURL(s),e.handleShortcutImageReady()},onError:this.handleShortcutImageReady})))}},{key:"statusBarTopOffset",get:function(){return this.toolBarHeight-this._statusBarHeight-k}},{key:"currentScreenShot",value:function(){var e=this._bitableWidget.getActiveWidget();if(e)return e.currentScreenShot()}},{key:"takeScreenShot",value:function(){var i=Object(J.uY)(s.a.mark(function e(t,i){var n,a,r,o=this;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=!1,n=this.state.screenShotBlob,!i){e.next=14;break}if(this.isScreenShoting=!0,(a=this._bitableWidget.getFaster()).isActive||a.wakeup(),!(r=this._bitableWidget.getActiveWidget())){e.next=13;break}return e.next=10,Object(J.Gy)(20);case 10:return e.next=12,r.takeScreenShot(t,i);case 12:n=e.sent;case 13:a.isActive||a.suspend();case 14:return e.abrupt("return",new Promise(function(e){o.isScreenShoting=!1,i&&n?(o.shortcutImgResolve=e,o.setState({isBlob:t,isScreenShotMode:i,screenShotBlob:n})):o.setState({isBlob:t,isScreenShotMode:i,screenShotBlob:n},function(){e()})}));case 15:case"end":return e.stop()}},e,this)}));function e(e,t){return i.apply(this,arguments)}return e}()},{key:"registerScrollContainerRef",value:function(e){this.scrollableContainerRef=e}},{key:"switchToNewTableView",value:function(){if(this.props.mountOption){var e=this.props.mountOption.operator;e.onSwitchNewTableView&&e.onSwitchNewTableView()}}},{key:"switchToNewView",value:function(){if(this.props.mountOption){var e=this.props.mountOption.operator;e.onSwitchNewView&&e.onSwitchNewView()}}},{key:"renderCommentBar",value:function(){var e=this.props,t=e.bitableStore,i=e.smartableCommentManager,n=e.tableId,a=e.renderer,r=e.isFullScreenMode,o=e.isPureBitable;if(!i)return null;var s=i.getCustomCommentBar();return r&&!o?s?x.a.createElement(s,{bitableStore:t,renderer:a,smartableCommentManager:i,tableId:n}):x.a.createElement(f.b,{bitableStore:t,renderer:a,smartableCommentManager:i,tableId:n}):null}},{key:"renderMentionBar",value:function(){var e,t,i=this.props,n=i.bitableStore,a=i.renderer,r=i.smartableMentionManager,o=i.tableId,s=i.isFullScreenMode,l=i.isPureBitable,d=null===(e=J.ob.MentionHelper)||void 0===e?void 0:e.mentionV2Enabled,c=null===(t=J.ob.MentionHelper)||void 0===t?void 0:t.getShowMentionBarEnabled(),u=n.getOriginalBasePermission("editable");if(!r||!d||!c||!u||J.rx.isFeedV2)return null;var b=r.getCustomMentionBar();return s&&!l&&b?x.a.createElement(b,{bitableStore:n,renderer:a,smartableMentionManager:r,tableId:o}):null}},{key:"getViewLayer",value:function(){var e=this.props,t=this.state,i=e.bitableStore,n=e.viewId,a=e.tableId,r=e.view,o=e.editable,s=e.renderer,l=e.isFullScreenMode,d=e.viewLayerOverlay,c=e.isBitableNewUser,u=e.mountOption,b=e.collapsed,p=e.smartableCommentManager,h=e.smartableMentionManager,v=e.isAnonymousAccess,f=e.isOpenSidebar,g=r&&r.type,m=t.contextMenuPositionX,w=t.contextMenuPositionY,y=t.fasterViewFold,C=t.showEmptyKanbanPlaceholder,S=t.isShowNewbieGuideModal,I=null,M=i.getService(J.kx.PERMISSION),O=Object(J.dF)()&&!l;if(t.fasterReady&&n){var _=Object.assign({editable:o,bitableStore:i,renderer:s,viewId:n,tableId:a,contextMenuPositionX:m,contextMenuPositionY:w,showCardModal:this.showCardModal,fasterDom:this._fasterDom,isFullScreenMode:l,onAddRecord:this.onAddRecord,viewLayerOverlay:d,fasterViewFold:y,showEmptyKanbanPlaceholder:C,parentBlockRef:this._virtualWrap,isBitableNewUser:c,mountOption:u,isShowNewbieGuideModal:S,collapsed:b,smartableCommentManager:p,smartableMentionManager:h,isParentBlockInView:!0,view:r,isOpenSidebar:f,isAnonymousAccess:v,addRecordInCard:!!M&&M.enabled,contextMenuService:this.contextMenuService,tooltipOverlayRef:O?this._fasterDom:void 0},this.connectContextProvider.getConnectContext());g===J.az.Grid?I=x.a.createElement(J.zB,Object(J.Kx)({},_,{renameToolbarView:this.renameToolbarView})):g===J.az.Kanban?I=x.a.createElement(J.AB,_):g===J.az.Gallery?I=x.a.createElement(J.BB,_):g===J.az.Gantt&&(I=x.a.createElement(W.Fragment,null,x.a.createElement(J.zB,Object(J.Kx)({},_,{getOffsetX:this.getOffsetX,renameToolbarView:this.renameToolbarView})),x.a.createElement(J.CB,_)))}return I}},{key:"updateRenderAreaSize",value:function(e,t){this.state.width===e&&this.state.height===t||this.setState({width:e,height:t})}},{key:"viewNotSupport",value:function(){var e=this.props,t=e.viewId,i=e.tableId;return!!e.bitableStore.downgradeManager.getViewNotSupportNotifyConfig({tableId:i,viewId:t||""})}},{key:"renderViewContentDowngrade",value:function(){var e=this.props,t=e.viewId,i=e.tableId,n=e.docWidth,a={viewId:t||"",tableId:i},r=this.props.bitableStore.downgradeManager.getViewNotSupportNotifyConfig(a);return r?x.a.createElement(J.SA,Object(J.Kx)({style:{width:n}},r)):null}},{key:"renderBitableContent",value:function(){var t=this,e=this.props,i=e.view,n=e.viewId,a=e.bitableStore,r=e.tableId,o=e.renderer,s=e.editable,l=i&&i.type,d=this.getViewLayer(),c=this.state,u=this.props,b=this.props,p=b.isFullScreenMode,h=b.viewLayerOverlay,v=b.tableLoaded,f=b.delayLoading,g=c.fasterViewFold,m=c.rendered,w=u.renderEmbededToolbar,y=u.offsetX,C=u.renderStatusBar,S={marginTop:p?void 0:this.toolBarHeight,flexDirection:C&&"column"},I={paddingLeft:y},M=this.renderViewContentDowngrade();return x.a.createElement("div",{className:"virtual-view-wrapper bitable-layout-column",ref:function(e){return t._fasterWrap=e}},w&&w(I,this.onEmbeddedToolbarWheel),!p&&C&&x.a.createElement("div",{className:"bitable-status-bar-wrapper",ref:function(e){return t.statusBarRef=e}},C()),x.a.createElement("div",{ref:this._setFasterDom,className:O()("embeded-faster-view bitable-layout-row bitable-flex",{gridView:l===J.az.Grid,ganttView:l===J.az.Gantt,kanbanView:l===J.az.Kanban,galleryView:l===J.az.Gallery,fullscreen:p,fold:g,"bitable-ipad-scroller":p,"view-content-downgrade":!!M}),style:S,onClick:this.onHostClick,onContextMenu:function(e){return t.onContextMenu(e)},onDragStart:function(e){return e.preventDefault()},draggable:!0},p?d:x.a.createElement("div",{className:"faster-overlay"}),!p&&h&&_.a.createPortal(d,h),this.renderEmptyKanbanPlaceholder(),M,x.a.createElement(J.eF,{tableId:r,renderer:o,bitableStore:a,viewId:n,editable:s}),(!v||!m||f)&&x.a.createElement("div",{className:"bitable-loading-wrapper"},x.a.createElement(J.yB,null))))}},{key:"render",value:function(){var t=this,e=this.props,i=e.viewId,n=e.bitableStore,a=e.tableId,r=O()("bitable-container bitable-layout-column bitable-flex",{"empty-view":!i,"using-bottom-top":!n.isEmbedded}),o=this.state,s=o.width,l=o.height,d=o.isScreenShotMode,c={width:s,height:l,position:"relative"};return x.a.createElement(J.eA,{bitableStore:n,ref:function(e){return t.connectContextProvider=e}},x.a.createElement(J.fF,{blockId:a},x.a.createElement("div",{id:J.gF,className:O()("embeded-bitable-container",r),ref:this._setBitableContainer},x.a.createElement("div",{className:O()(J.hF,{open:!1}),ref:function(e){return t._virtualWrap=e},style:c},d&&this.renderFullScreenShot(),this.renderBitableContent()),this.renderCommentBar(),this.renderMentionBar(),this.renderCardModal())))}}]),n}(x.a.Component),Object(J.lz)(i.prototype,"setGroupField",[e],Object.getOwnPropertyDescriptor(i.prototype,"setGroupField"),i.prototype),Object(J.lz)(i.prototype,"hiddenGroupField",[t],Object.getOwnPropertyDescriptor(i.prototype,"hiddenGroupField"),i.prototype),i),E=Object(J.Sy)(function(e){return{editable:e.getBasePermission(J.ry.Editable)}})(Object(m.c)(M)),V=Object(n.connect)(f.g,f.d,null,f.h)(Object(f.e)(E))}.call(this,F("vb163"))},vb292:function(e,t,i){"use strict";var n,a,r,o;i.d(t,"a",function(){return a}),i.d(t,"b",function(){return n}),(o=n||(n={})).GridContentContextMenu="GridContentContextMenu",o.GridFieldHeaderMenu="GridFieldHeaderMenu",o.GridGroupTitleContextMenu="GridGroupTitleContextMenu",o.KanbanCardContextMenu="KanbanContextMenu",o.KanbanCardListMoreContextMenu="KanbanCardListMoreContextMenu",o.GalleryCardContextMenu="GalleryCardContextMenu",o.GanttBarContextMenu="GanttBarContextMenu",o.BlockCreationMenu="BlockCreationMenu",o.BlockContextMenu="BlockContextMenu",(r=a||(a={})).InsertAbove="InsertAbove",r.InsertBelow="InsertBelow",r.InsertLeft="InsertLeft",r.InsertRight="InsertRight",r.ExpendRow="ExpendRow",r.CopyLink="CopyLink",r.Comment="Comment",r.FilterItem="FilterItem",r.Reminder="Reminder",r.DeleteRecord="DeleteRecord",r.ExpendSubGroups="ExpendSubGroups",r.FoldSubGroups="FoldSubGroups",r.ModifyField="ModifyField",r.ModifyDescription="ModifyDescription",r.DuplicateField="DuplicateField",r.InsertFieldLeft="InsertFieldLeft",r.InsertFieldRight="InsertFieldRight",r.FrozenField="FrozenField",r.SetSortAZ="SetSortAZ",r.SetSortZA="SetSortZA",r.SetGroup="SetGroup",r.SetFilter="SetFilter",r.CreateView="CreateView",r.HideField="HideField",r.DeleteField="DeleteField",r.CopyRecord="CopyRecord",r.GroupRename="GroupRename",r.DeleteGroup="DeleteGroup",r.ExportAttachment="ExportAttachment",r.DeleteGanttTask="DeleteGanttTask",r.AddTable="AddTable",r.AddDashboard="AddDashboard",r.RenameBlock="RenameBlock",r.CopyTable="CopyTable",r.DeleteBlcok="DeleteBlcok",r.CopyBlock="CopyBlock"},vb312:function(e,t,i){"use strict";i.d(t,"a",function(){return d}),i.d(t,"b",function(){return c});var l=i("vb143"),n=(i("vb147"),i("vb103"),i("vb148"),i("vb152"),i("vb112"),i("vb164"),i("vb167"),i("vb113"),i("vb174"),i("vb155"),i("vb292"),i("vb176")),r=(i("vb110"),function e(){var i=this;Object(l.ov)(this,e),this.configMap=new Map,this.getConfigMap=function(){return i.configMap},this.setConfig=function(e,t){return i.configMap.set(e,t)},this.getConfig=function(e){return i.configMap.get(e)||null},this.deleteConfig=function(e){return i.configMap.delete(e)},this.clear=function(){return i.configMap.clear()}}),a=function e(){var a=this;Object(l.ov)(this,e),this.slotConfigRegistry=new r,this.registerBlocks=function(n){Object.keys(n).forEach(function(e){var t=n[e],i=t.type;a.slotConfigRegistry.setConfig(i,t)})},this.getBlockIcon=function(e){var t=a.slotConfigRegistry.getConfig(e);return(null==t?void 0:t.icon)||null},this.getContextMenuItems=function(e){var t=e.menuId,i=e.type,n=a.slotConfigRegistry.getConfig(i);return n&&n.contextMenuConfig&&n.contextMenuConfig[t]||[]}},o=function e(){var i=this;Object(l.ov)(this,e),this.MenuMap=new Map,this.getMenuItems=function(e){return i.MenuMap.get(e)},this.setMenuItems=function(e,t){return i.MenuMap.set(e,t)}},s=function(){function e(){var s=this;Object(l.ov)(this,e),this.closeMenuMap=new Map,this.menuRegistry=new o,this.options=null,this.getCustomMenuConfig=function(e,t,i){var n,a=null===(n=s.options)||void 0===n?void 0:n.customContextMenus;if(a&&a[e])return a[e](t,i)},this.getContextMenuItems=function(e,t){var i=t.getContext,n=s.menuRegistry.getMenuItems(e);if(!n)return[];var a=i(),r=s.getContextMenuConfig(e,{getContext:i,getContextMenuConfig:function(){return{}}},n,a),o=s.getCustomMenuConfig(e,r,a);return null!=o?o.items:r.items}}return Object(l.Pw)(e,[{key:"setContextMenus",value:function(i){var n=this;null!=i&&Object.keys(i).length&&Object.keys(i).forEach(function(e){var t=i[e];n.menuRegistry.setMenuItems(e,t)})}},{key:"appendContextMenu",value:function(e,t){var i,n=null!==(i=this.menuRegistry.getMenuItems(e))&&void 0!==i?i:[];this.menuRegistry.setMenuItems(e,[].concat(Object(l.hI)(n),[t]))}},{key:"setContextServiceOption",value:function(e){this.options=Object(n.a)(this.options,e)}},{key:"showContextMenu",value:function(e,t){var i=t.getContext,n=this.menuRegistry.getMenuItems(e);if(n){var a=i(),r=this.getContextMenuConfig(e,t,n,a),o=this.getCustomMenuConfig(e,r,a),s=Object(l.NB)(null!=o?o:r);this.closeMenuMap.set(e,s)}}},{key:"closeContextMenu",value:function(e){if(e){var t=this.closeMenuMap.get(e);t&&t(),this.closeMenuMap.delete(e)}else this.closeMenuMap.forEach(function(e){return e&&e()}),this.closeMenuMap.clear()}},{key:"getContextMenuConfig",value:function(a,e,t,r){var o=this,i=Object.assign({},e.getContextMenuConfig()),s=[];return t.forEach(function(e){var t=e&&e(r,function(){return o.closeContextMenu(a)});if(t){var i=t.onClick,n=function(){i&&i(),o.closeContextMenu(a)};t.onClick=n,s.push(t)}}),Object.assign({},i,{items:s})}},{key:"dispose",value:function(){this.closeContextMenu(),this.closeMenuMap.clear(),this.options=null,l.OB.forEach(function(e){return e()})}}]),e}(),d=function e(){Object(l.ov)(this,e)};d.blockSlotServiceMap=new WeakMap,d.contextMenuServiceMap=new WeakMap,d.getBlockSlotServiceInstance=function(e){if(!d.blockSlotServiceMap.get(e)){var t=new a;d.blockSlotServiceMap.set(e,t)}return d.blockSlotServiceMap.get(e)},d.getContextMenuServiceInstance=function(e){if(!d.contextMenuServiceMap.get(e)){var t=new s;d.contextMenuServiceMap.set(e,t)}return d.contextMenuServiceMap.get(e)};var c=function(e){var t=Object(l.MB)(e.base,e);return d.getContextMenuServiceInstance(t)}},vb397:function(e,a,r){"use strict";(function(d){r.d(a,"a",function(){return n});var i=r("vb143"),e=r("vb103"),c=r.n(e),t=r("vb159"),u=r.n(t),b=r("vb111"),n=function(e){function t(){return Object(i.ov)(this,t),e.apply(this,arguments)||this}return Object(i.bu)(t,e),Object(i.Pw)(t,[{key:"render",value:function(){var e=this.props,t=e.height,i=e.width,n=e.offsetX,a=e.withBackground,r=e.editable,o=e.onCreateBtnClick,s=e.isNewLayout,l=void 0!==s&&s;return c.a.createElement("div",{style:{height:t,width:i,left:n},className:u()("empty-kanban-placeholder bitable-noselect",{"empty-kanban-placeholder_with-background":a,newLayout:l})},c.a.createElement("div",{className:"empty-kanban-placeholder__text"},d("bitable.empty_kanban_placeholder")),r&&c.a.createElement(b.Button,{onClick:o,className:"empty-kanban-placeholder__btn",type:"primary"},d("bitable.create_group")))}}]),t}(e.Component)}).call(this,r("vb163"))},vb494:function(e,t,i){"use strict";var n=i("vb153");function a(e){return Object(n.a)(e)&&e!=+e}t.a=a},vb543:function(e,t,i){"use strict";i.d(t,"a",function(){return s});var n=i("vb154"),a=i("vb192"),r=i("vb200"),o=i("vb114");function s(e,t,i){return Object(o.shallowEqual)(Object(r.a)(e,i),Object(r.a)(t,i))&&Object(n.a)(Object(a.a)(e,i),Object(a.a)(t,i))}},vb967:function(e,t,i){"use strict";i.d(t,"a",function(){return h}),i.d(t,"b",function(){return p}),i.d(t,"c",function(){return u}),i.d(t,"d",function(){return f}),i.d(t,"e",function(){return g}),i.d(t,"f",function(){return b}),i.d(t,"g",function(){return v}),i.d(t,"h",function(){return m});var n=i("vb152"),a=i.n(n),s=i("vb143"),l=i("vb170"),r=i("vb145"),o=(i("vb147"),i("vb103"),i("vb148"),i("vb112"),i("vb164"),i("vb167"),i("vb113"),i("vb543")),d=i("vb115"),c=i("vb185"),u=(i("vb174"),i("vb155"),52),b=60,p=Object(s.Uy)(Object(s.uY)(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.e("4c56ff4ce4aa").then(i.bind(null,"vb1323"));case 2:return e.abrupt("return",e.sent.DocCommentBar);case 3:case"end":return e.stop()}},e)}))),h=Object(s.Uy)(Object(s.uY)(a.a.mark(function e(){return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.e("da4fb5c6e93e").then(i.bind(null,"vb1324"));case 2:return e.abrupt("return",e.sent.AloneCommentBar);case 3:case"end":return e.stop()}},e)}))),v=function(e,a){var t=a.tableId,i=a.viewId,n=Object(s.wy)(e,t),r=Object(s.MF)(Object(s.OF)(e),s.NF),o=function(){var e=a.viewsExclude,t=void 0===e?[]:e,i=a.mountOption,n=(null==i?void 0:i.viewsExclude)||[];return Object(l.a)([].concat(Object(s.hI)(t),Object(s.hI)(n)))};return{view:Object(s.wD)(e,t,i),views:Object(s.PF)(e,t),viewsExclude:o(),tableLoaded:Object(s.oD)(e,t)||!1,isAnonymousAccess:s.ob.CommonUtil.isAnonymousAccess,recovering:Object(s.QF)(e),cardRecordId:n?n.recordId:"",cardFieldId:n?n.fieldId:null,cardModalVisible:!!n&&n.isCardEditorOpen&&n.source===s.sz.View,fromMention:!!n&&n.fromMention,members:Object(s.RF)(e),openGuidebar:Object(s.SF)(e),openDiagnoseTool:Object(s.TF)(e),openCommentBar:Object(s.UF)(e),openMentionBar:Object(s.wG)(e),isBitableNewAndSheetOldUser:Object(s.xG)(e),isBitableNewUser:Object(s.yG)(e),isSheetNewUser:Object(s.zG)(e),hasWatchedEmbeddedInSheetVideo:"boolean"!=typeof r||r,support:Object(s.AG)(e),mode:Object(s.Wy)(e),activeViewIdMap:Object(s.Az)(e),userGuideStatusLoaded:Object(s.BG)("userGuide")(e)===s.CG.loaded,fullScreenTableId:Object(s.DG)(e),isPureBitable:Object(s.Ay)(e),bitableStage:Object(s.xy)(e),drawerCardWidth:Object(s.BA)(e),drawerCardHasOpen:Object(s.EG)(e,s.AA.Drawer)}},f=function(a){return{toggleEditorInCardEdit:function(e,t,i,n){a(Object(s.Cy)(e,t,i,n))},changeSupportStatus:function(e){a(Object(s.FG)(e))},setEmbedActiveTableId:function(e){a(Object(s.GG)(e))},toggleGuidebar:function(e){a(Object(s.HG)(e))},setOnboardingGridTableId:function(e){a(Object(s.IG)(e))},setOnboardingKanbanTableId:function(e){a(Object(s.JG)(e))},setBitableStage:function(e){a(Object(s.KG)(e))},toggleCommentBar:function(e){a(Object(s.LG)(e))},toggleMentionBar:function(e){a(Object(s.MG)(e))}}},g=Object(c.b)(function(e,t){var i=e.toolbarStore,n=e.viewState,a=s.LF.getInstance(t.bitableStore);return{isOpenSidebar:i.isOpenSidebar&&Object(r.a)(t.bitableStore,"bitableConfig.ui.visibility.new_table_view.sidebar_visible",!0)&&!d.browser.isFeed,isOpenTableSidebar:i.isOpenTableSidebar,isNewLayout:(null==n?void 0:n.CommonState.layoutManager.checkIsNewLayout(a))||!1}}),m={forwardRef:!0,areStatePropsEqual:function(e,t){return Object(o.a)(t,e,["members","views","view","viewsExclude","activeViewIdMap"])}}}}]);
//# sourceMappingURL=//slardar.bytedance.net/api_v2/browser/jserr/get_sourcemap?bid=docs_pc&js_filename=vendors-doc-table-view.dbbe2088ac.chunk.js