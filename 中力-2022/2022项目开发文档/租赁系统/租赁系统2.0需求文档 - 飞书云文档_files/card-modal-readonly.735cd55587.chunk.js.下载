(window.webpackJsonp=window.webpackJsonp||[]).push([["48b5763a1571"],{vb1291:function(e,t,o){"use strict";o.r(t),o.d(t,"ReadOnlyCardModal",function(){return l});var m=o("vb143"),n=o("vb180"),d=o("vb103"),y=o.n(d),w=o("vb489"),i=(o("vb147"),o("vb148"),o("vb194")),r=o("vb159"),C=o.n(r),g=o("vb961"),O=o("vb111"),l=(o("vb129"),o("vb152"),o("vb223"),o("vb214"),o("vb232"),o("vb187"),o("vb174"),o("vb225"),o("vb224"),o("vb128"),o("vb122"),o("vb115"),o("vb112"),o("vb118"),o("vb119"),o("vb113"),o("vb167"),o("vb164"),o("vb233"),o("vb234"),o("vb235"),o("vb123"),o("vb236"),o("vb193"),o("vb237"),o("vb155"),o("vb238"),o("vb124"),o("vb239"),o("vb104"),o("vb116"),o("vb120"),o("vb121"),o("vb117"),o("vb240"),o("vb134"),o("vb131"),o("vb226"),o("vb241"),o("vb114"),o("vb110"),o("vb125"),o("vb242"),o("vb127"),o("vb132"),o("vb227"),o("vb135"),o("vb228"),o("vb229"),o("vb133"),o("vb126"),o("vb243"),o("vb262"),o("vb244"),o("vb245"),o("vb246"),o("vb247"),o("vb248"),o("vb249"),o("vb201"),o("vb260"),o("vb267"),o("vb250"),o("vb136"),o("vb251"),o("vb130"),o("vb252"),o("vb396"),o("vb334"),o("vb412"),o("vb490"),o("vb326"),o("vb590"),function(d){function r(){var a;Object(m.ov)(this,r);for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return(a=d.call.apply(d,[this].concat(t))||this).state={height:window.document.documentElement.clientHeight*m.px,hideFilterTip:!1,currentRecordId:a.props.recordId,modalScrollTop:0,modalOffsetHeight:790,modalHiddenFieldOffset:0},a.resizeObserver=null,a.modalBody=null,a.dialogRef=null,a.onWindowResize=Object(n.a)(function(){a.setState({height:document.documentElement.clientHeight*m.px})},500),a.handleModalScroll=Object(n.a)(function(){if(a.modalBody){var e=a.modalBody.scrollTop;if(e!==a.state.modalScrollTop){var t=a.modalBody.querySelector(".card_edit_hide_toggle");a.setState({modalScrollTop:e,modalHiddenFieldOffset:t?t.offsetTop+m.qx:0})}}},250),a.bindCopyCutEvent=function(){var e=a.props.renderer;a.modalBody&&(a.modalBody.addEventListener("copy",e.clipboardHelper.handleCopyCut,!0),a.modalBody.addEventListener("cut",e.clipboardHelper.handleCopyCut,!0))},a.unbindCopyCutEvent=function(){var e=a.props.renderer;a.modalBody&&(a.modalBody.removeEventListener("copy",e.clipboardHelper.handleCopyCut,!0),a.modalBody.removeEventListener("cut",e.clipboardHelper.handleCopyCut,!0))},a.setModalBodyRef=function(e){a.modalBody=e,a.onScrollHandler&&a.onScrollHandler(e)},a.setDialogRef=function(e){a.dialogRef=e},a.observeModalHeight=function(){if(a.modalBody){var e=a.modalBody.offsetHeight;if(e!==a.state.modalOffsetHeight){var t=a.modalBody.querySelector(".card_edit_hide_toggle");a.setState({modalOffsetHeight:e,modalHiddenFieldOffset:t?t.offsetTop+m.qx:0})}}},a.switchCard=function(e){var t=a.cardOrderInfo;"pre"===e?t.preRecordId&&a.setState({currentRecordId:t.preRecordId}):t.nextRecordId&&a.setState({currentRecordId:t.nextRecordId})},a.afterShow=function(){a.modalBody&&!a.resizeObserver&&(a.resizeObserver=new i.a(a.observeModalHeight),a.resizeObserver.observe(a.modalBody)),a.bindKeydown()},a.onCardModalClose=function(){var e=a.props,t=e.onClose,o=e.afterClose;t(),"function"==typeof o&&setTimeout(o,0),a.unbindKeydown()},a.handleKeydown=function(e){if(a.props.modalVisible&&!e.ignoreKeybinding){var t=e.altKey,o=e.keyCode,d=e.metaKey,r=e.ctrlKey;if(m.rx.mac||m.rx.isIPad){var n=[d,r];r=n[0],d=n[1]}var i=t&&r&&o===m.sx.BracketLeft,l=t&&r&&o===m.sx.BracketRight;i&&a.switchCard("pre"),l&&a.switchCard("next")}},a.disconnectObserver=function(){a.resizeObserver&&(a.modalBody&&a.resizeObserver.unobserve(a.modalBody),a.resizeObserver.disconnect(),a.resizeObserver=null)},a.setHideFilterTip=function(e){a.setState({hideFilterTip:e})},a.onCancel=function(){a.disconnectObserver(),a.onCardModalClose()},a.addOnScrollHandler=function(e){a.onScrollHandler=e},a}return Object(m.bu)(r,d),Object(m.Pw)(r,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.onWindowResize),this.bindCopyCutEvent()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.recordId;this.state.currentRecordId!==t&&this.setState({currentRecordId:t})}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onWindowResize),this.disconnectObserver(),this.unbindCopyCutEvent()}},{key:"handleKeyDown",value:function(e){e.nativeEvent.stopImmediatePropagation(),e.keyCode===m.sx.Esc&&this.onCancel()}},{key:"bindKeydown",value:function(){var e;null===(e=this.dialogRef)||void 0===e||e.addEventListener("keydown",this.handleKeydown)}},{key:"unbindKeydown",value:function(){var e;null===(e=this.dialogRef)||void 0===e||e.removeEventListener("keydown",this.handleKeydown)}},{key:"renderHeader",value:function(){var e,t=this.props,o=t.tableId,d=t.bitableStore,r=t.viewId,n=this.state.currentRecordId,i=d.base.getTableById(o),l="",a=null==i?void 0:i.getViewById(r),s=null==i?void 0:i.getPrimaryField();if(i&&a&&s){var v=i.getCellValue(n,s.id);l=s.cellValueToString(v)||""}var c=this.state.hideFilterTip,b=!(null===(e=m.ob.config.ui)||void 0===e||!e.useCardModalFilterTip||c||-1!==this.cardOrderInfo.curFieldIdIndex||!1===this.props.showTip),u={switchCard:this.switchCard,headerTitle:l,cardOrderInfo:this.cardOrderInfo,showTip:b,setHideFilterTip:this.setHideFilterTip,onClose:this.onCancel,renderer:this.props.renderer,bitableStore:d,source:this.props.source,tableId:o};return y.a.createElement(g.C,u)}},{key:"render",value:function(){var e,t,o=this,d=this.props,r=d.tableId,n=d.viewId,i=d.forSelfTable,l=d.bitableStore,a=d.modalVisible,s=d.mask,v=d.marginLeft;if(!a)return null;var c=this.state.currentRecordId,b={maxHeight:this.state.height,marginLeft:v||0},u=this.props.cardSyncMode||m.tx.OnDemand,f=l.executeCommandImmediately,h=null===(e=l.base.getTableById(r))||void 0===e||null===(t=e.getViewById(n))||void 0===t?void 0:t.getAllFields();this.cardOrderInfo=Object(g.g)({tableId:r,bitableStore:l,forSelfTable:i,viewId:n,recordId:c});var p=Object(g.a)(r,l,i,n,c,h);return y.a.createElement(O.Dialog,{header:this.renderHeader(),closable:!1,visible:a,zIndex:100,width:m.ux,style:b,mask:s,onCancel:this.onCancel,className:C()({"J-card-edit-modal":!0,"cp-modal-centered":!0,"b-small-scrollbar":!0,"card-readonly":!0}),onKeyDown:function(e){return o.handleKeyDown(e)},footer:null,onAfterOpen:this.afterShow,ref:this.setDialogRef},y.a.createElement("div",{className:"J-card-edit-modal-body b-ud-scrollbar-lg",ref:this.setModalBodyRef,onScroll:this.handleModalScroll},y.a.createElement(w.a,Object(m.Kx)({},this.props,{addOnScrollHandler:this.addOnScrollHandler,windowOffset:this.state.modalScrollTop,windowSize:this.state.modalOffsetHeight,hiddenFieldOffset:this.state.modalHiddenFieldOffset,recordId:c,bitableStore:l,cardSyncMode:u,relativeClass:"J-card-edit-modal-body",receiveAction:f,record:p,closePopup:this.onCancel,fieldAddable:!1,fieldEditable:!1,recordEditable:!1}))))}}]),r}(y.a.PureComponent))}}]);
//# sourceMappingURL=//slardar.bytedance.net/api_v2/browser/jserr/get_sourcemap?bid=docs_pc&js_filename=card-modal-readonly.735cd55587.chunk.js