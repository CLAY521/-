(window.webpackJsonp=window.webpackJsonp||[]).push([["5d9443e0302e"],{vb1298:function(e,S,O){"use strict";O.r(S),function(u){O.d(S,"S",function(){return r}),O.d(S,"b",function(){return h}),O.d(S,"t",function(){return g});var e,D=O("vb143"),f=O("vb176"),t=O("vb196"),x=(O("vb147"),O("vb103")),K=O("vb150"),i=(O("vb148"),O("vb152"),O("vb112"),O("vb164"),O("vb167"),O("vb113"),O("vb174"),O("vb155"),O("vb185")),n=O("vb114"),o=O("vb180"),a=O("vb159"),U=O.n(a),q=O("vb398"),w=O("vb111"),E=O("vb341"),d=O("vb1925"),p=O("vb2152"),T=O("vb1931"),c=O("vb446"),y=O("vb449"),Z=["bitable-layout-row","bitable-layout-cross-center","bitable-noselect","toolbar-btn"],b=(Object(D.Ww)(e={},c.b.zh,980),Object(D.Ww)(e,c.b["zh-HK"],980),Object(D.Ww)(e,c.b["zh-TW"],980),Object(D.Ww)(e,c.b.en,1280),Object(D.Ww)(e,c.b.ja,1500),e);function v(e){var t=b[e];return Number.isFinite(t)?t:b.en}var r=function(t){function i(e){var d;return Object(D.ov)(this,i),(d=t.call(this,e)||this).viewNameEditor=null,d.viewNameContainer=null,d.isMenuBtnClicked=!1,d.clearGridListener=null,d.resetShowToolTips=Object(o.a)(function(){var e=d.props.view,t=(null==e?void 0:e.type)===D.az.Form,i=D.ob.I18nConfig.getLanguage();if(t){var n=document.querySelector(".form-view-toolbar-in-sheet"),o=c.a;n&&(o=n.classList.contains("open")?n.clientWidth-c.d:n.clientWidth);var a=o<Object(c.f)(i);d.setState({isShowToolTip:a})}else{var r,l=(null===(r=d.getBitableContainer())||void 0===r?void 0:r.clientWidth)||window.innerWidth,s=!!v(i)&&l<b[i];d.setState({isShowToolTip:s})}},200).bind(Object(D.Cx)(d)),d.handleMentionUpdate=function(e){var t=e.tableId,i=e.mentions;d.props.renderer.getActiveTableId()===t&&d.setState({hasMentionData:0!==i.length})},d.handleMentionViewSwitch=function(){var e=d.props,t=e.renderer,i=e.smartableMentionManager,n=t.getActiveTableId(),o=(null==i?void 0:i.getMentions(n))||[];d.handleMentionUpdate({tableId:n,mentions:o})},d.handleOpenViewPanelEvent=function(){d.props.isOpenSidebar||d.openSidebar()},d.handleClickFieldSettingsBtnEvent=function(){d.handleClick(D.LC.FIELD)},d.handleSetFormModeEvent=function(e){var t=d.props,i=t.tableId,n=t.viewId,o=t.editable;i&&n&&(o?d.formStorageManager.getFormMode(i,n,D.MC.Edit):D.MC.Submit)!==e&&(d.forceUpdate(),d.handleClick(e===D.MC.Edit?D.LC.FORM_EDIT:D.LC.FORM_SUBMIT))},d.setGroupRef=function(e){d.groupRef=e},d.getGroupRef=function(){return d.groupRef},d.onViewRename=function(e){var t=e.id,i=e.name;d.props.editable&&d.props.hasViewEditablePermission(d.props.tableId,t)&&d.setState({editViewId:t,editName:i},function(){setTimeout(function(){d.viewNameEditor&&(d.viewNameEditor.focus(),d.viewNameEditor.select())},60)})},d.switchView=function(e){var t=d.props,i=t.tableId,n=t.viewId,o=t.getSelectType,a=t.view,r=t.moduleType;i&&e!==n&&d.props.onSwitchView(i,e);var l=i&&e?o(i,e):null;D.ob.collectBitableEvent(D.On.BitableViewSwitch,{table_id:i,from_view_id:n,to_view_id:e,bitable_view_type:a&&D.Cz[a.type],source:D.OC.HoverBar,data_source:r,bitable_select_type:l},!0),d.onSidebarBtnLeave()},d.toggleHistory=function(){D.ob.collectBitableEvent(D.On.ClientDatabaseHistory,{action:"click_table_history"}),d.props.toggleHistory(d.props.tableId)},d.hasEditablePermission=function(e,t){var i=2<arguments.length&&void 0!==arguments[2]&&arguments[2],n=d.props.hasEditablePermission;return(e||i)&&n(t)},d.onSidebarbtnHover=function(){Object(D.TC)(),d.props.isOpenSidebar||d.isMenuBtnClicked||d.setState({viewMenuHovered:!0},function(){D.cz.collectClickEvent(D.Bc.CcmBitableToolbarClick,{click:D.PC[D.LC.VIEW_CLICK],target:D.Rw.CcmBitableTitlebarViewOperateView})})},d.onSidebarBtnLeave=function(){var e=!0;document.querySelector(".J-bitable-drag-item")&&(e=!1),e&&(d.setState({viewMenuHovered:!1}),d.isMenuBtnClicked=!1)},d.onClickViewMoreOptionsBtn=function(){D.cz.collectBitableEvent(D.Bc.CcmBitableTitlebarViewOperateClick,{click:D.eB.ViewMore,target:D.Rw.CcmBitableViewMoreView})},d.onClickSideBarItem=function(){D.cz.collectClickEvent(D.Bc.CcmBitableTitlebarViewOperateClick,{click:D.eB.ViewClick})},d.state={showGroupMenu:!1,viewMenuHovered:!1,activeButton:"",editViewId:"",editName:"",isPickup:!1,isShowToolTip:!1,hasMentionData:!1},d}return Object(D.bu)(i,t),Object(D.Pw)(i,[{key:"componentDidMount",value:function(){var e,t=this.props.renderer;this.resetShowToolTips(),t.eventManager.addListener(D.ay.OpenViewPanel,this.handleOpenViewPanelEvent),t.eventManager.addListener(D.ay.ClickFieldSettingsBtn,this.handleClickFieldSettingsBtnEvent),t.eventManager.addListener(D.ay.ResetToolbarShowToolTips,this.resetShowToolTips),t.eventManager.addListener(D.QC.MentionUpdate,this.handleMentionUpdate),t.eventManager.addListener(D.QC.ViewSwitch,this.handleMentionViewSwitch),t.eventManager.addOnceListener(D.ay.ClickGroupSettingsBtn,this.handleClickGroupSettingsBtnEvent),this.observer=Object(c.c)(this.getBitableContainer(),this.resetShowToolTips),window.addEventListener("resize",this.resetShowToolTips),t.eventManager.addOnceListener(D.ay.ClickGridGroupBtn,this.handleClickGroupSettingsBtnEvent),t.eventManager.addListener(D.ay.RenameView,this.onViewRename),this.props.onShow&&this.props.onShow(),null!==(e=D.ob.MentionHelper)&&void 0!==e&&e.mentionV2Enabled&&this.updateMentionInitStatus()}},{key:"handleCommentClick",value:function(){var e=this.props,t=e.renderer,i=e.triggerCreateComment,n=t.activeBitableWidget&&t.activeBitableWidget.getGridWidget(),o=n.source.gridView.getVisibleRecords()[0],a=n.getActiveRecord()||o;a&&i(a)}},{key:"handleMentionClick",value:function(){var e=this.props.smartableMentionManager;null==e||e.triggerTogglePanelBar(!0)}},{key:"updateMentionInitStatus",value:function(){var e=this.props,t=e.renderer,i=e.smartableMentionManager,n=t.getActiveTableId(),o=(null==i?void 0:i.getMentions(n))||[];this.handleMentionUpdate({tableId:n,mentions:o})}},{key:"componentWillUnmount",value:function(){var e=this.props.renderer;e.eventManager.removeListener(D.ay.OpenViewPanel,this.handleOpenViewPanelEvent),e.eventManager.removeListener(D.ay.ClickFieldSettingsBtn,this.handleClickFieldSettingsBtnEvent),e.eventManager.removeListener(D.ay.ClickGroupSettingsBtn,this.handleClickGroupSettingsBtnEvent),e.eventManager.removeListener(D.ay.ResetToolbarShowToolTips,this.resetShowToolTips),e.eventManager.removeListener(D.QC.MentionUpdate,this.handleMentionUpdate),e.eventManager.removeListener(D.QC.ViewSwitch,this.handleMentionViewSwitch),this.observer&&(this.observer.disconnect(),this.observer=null),e.eventManager.removeListener(D.ay.ClickGridGroupBtn,this.handleClickGroupSettingsBtnEvent),e.eventManager.removeListener(D.ay.RenameView,this.onViewRename),this.clearGridListener&&this.clearGridListener(),window.removeEventListener("resize",this.resetShowToolTips)}},{key:"handleMenuIconClick",value:function(e){D.cz.collectClickEvent(D.Bc.CcmBitableSidebarClick,{click:D.VC.SideBar,sidebar_status:this.props.isOpenSidebar?D.oy.Close:D.oy.Open}),Object(D.TC)(),this.openSidebar()}},{key:"openSidebar",value:function(){var e=this.props,t=e.tableId,i=e.viewId,n=e.moduleType,o=e.embeddedType;this.props.isOpenSidebar||(this.onSidebarBtnLeave(),o===D.pA.EmbeddedInDoc?D.cz.collectBitableEvent(D.Rw.CcmBitableTitlebarViewOperateView):D.cz.collectBitableEvent(D.Rw.CcmBitableSidebarView)),this.isMenuBtnClicked=!0,t&&this.props.toggleTableSidebar(!this.props.isOpenSidebar),D.ob.collectBitableEvent(D.On.BitableViewSlidebar,{table_id:t,view_id:i,is_open:Number(!this.props.isOpenSidebar),data_source:n})}},{key:"handleClick",value:function(e){this.setState({activeButton:e}),Object(D.Kz)(Object(D.Lz)(i.prototype),"handleClick",this).call(this,e)}},{key:"onKeyDown",value:function(e){e.nativeEvent.stopImmediatePropagation(),e.keyCode===D.sx.Enter?this.onViewEditBlur():e.keyCode===D.sx.Esc&&this.setState({editViewId:""})}},{key:"onViewEditBlur",value:function(){var e=this,t=this.viewNameEditor.value.trim();if(!Object(D.oB)(t))return Object(D.pB)(),void this.setState({editViewId:""});var i=this.props,n=i.tableId,o=i.onSetView,a=i.moduleType;if(n){var r=this.state.editViewId,l=o({name:t,tableId:n,viewId:r}),s=this.props.getViewState(n,r);l.result===D.Ey.Fail&&l.reason===D.qB.NameRepeat&&Object(D.rB)({title:u("common.rename_failed"),message:u("bitable.error.repeat_view_name",t),buttons:[{text:u("common.confirm"),type:D.YA.primary,onClick:function(){s&&e.onViewRename(s)}}]}),this.setState({editViewId:""}),s&&s.name!==t&&D.ob.collectBitableEvent(D.On.BitableViewRename,{table_id:n,view_id:r,bitable_view_type:D.Cz[s.type],length:t.length,action:D.sB.Rename,data_source:a},!0)}}},{key:"isInSheet",get:function(){return this.props.embeddedType===D.pA.EmbeddedInSheet}},{key:"genToolbarBtn",value:function(e){var t=this,i=e.id,n=e.cls,o=e.name,a=e.type,r=e.icon,l=e.decorator,s=e.editable,d=e.isShowName,c=void 0===d||d,b=e.disable,u=void 0!==b&&b,p=e.onClick,v=e.customToolTipProp,h=e.showTooltip,m=void 0===h||h;s||(u=!0);var g=x.createElement("div",{id:i,className:n,"data-selector":s&&q.f[a]?q.f[a]:"",onClick:function(){return s?p?p():t.handleClick(a):function(){return null}}},x.createElement("div",{className:U()("toolbar-btn-container","bitable-layout-row bitable-layout-cross-center bitable-noselect",{"toolbar-btn-container-mouse-event":!u})},x.createElement("i",{className:"toolbar-icon"},r),x.createElement("span",{className:"toolbar-text"},l||"",c&&x.createElement("span",null,o))));return m?x.createElement(w.Tooltip,Object(D.Kx)({disabled:u,placement:"bottom",title:o,hideAction:["click"]},v),g):g}},{key:"getToolbarItems",value:function(){var e,t,n=this,i=this.state.hasMentionData,o=this.props,a=o.extraToolbarBtns,r=o.tableId,l=o.viewId,s=o.rowHeightLevel,d=o.view,c=o.hasAddableRecordPermission,b=o.embeddedType,u=o.isShowName,p=o.isShowTooltip,v=o.isDisableReminder,h=o.isShowComment,m=o.originalEditable;if(!d)return{lastItems:[],leftItems:[],insertedItems:[],rightItems:[],middleItems:[]};var g=this.hasEditablePermission(this.props.editable,D.qy.View),w={showTooltip:this.state.isShowToolTip,isShowName:!this.state.isShowToolTip},f=function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];return U()(Z,{disabled:e,interactive:(!(1<arguments.length&&void 0!==arguments[1])||arguments[1])&&!e})},y=this.props.editable&&c(),S=function(e){return n.handleClick(e)},O=b===D.pA.EmbeddedInSheet,C=d.type,I=C===D.az.Gantt,E=C===D.az.Grid,T=C===D.az.Form,B=[];T||B.push(Object(q.e)(g,this.props,S,{isShowShortCut:!0,isShowName:!1}),Object(q.g)(g,this.props,S,{isShowShortCut:!0,isShowName:!1}),Object(q.h)(this.props,S,{isShowShortCut:!1,isShowName:u,isShowTooltip:p}),Object(q.i)(g,this.props,S,w),Object(q.m)(y,void 0,S)),I&&B.push(Object(q.j)(g,this.props,S,w)),T||B.push(Object(q.l)(g,this.props,S,w)),(E||I&&b!==D.pA.EmbeddedInDoc)&&B.push(Object(q.o)(g,this.props,this.collectSetGroupEvent,S,w)),d&&!T&&B.push(Object(q.p)(g,this.props,this.collectSetSortEvent,S,w)),E&&B.push(Object(q.q)(g,this.props,S,Object.assign({},w,{level:s}))),!E&&!I||v||B.push(Object(q.r)(g,S,w)),!T&&O&&B.push(Object(q.s)(g,S,w)),(E||I)&&h&&this.props.haveCommentPermission&&this.props.isCommentDataInit&&B.push(Object(q.t)(g,this.props,S,w));var j=null===(e=D.ob.MentionHelper)||void 0===e?void 0:e.mentionV2Enabled,M=null===(t=D.ob.MentionHelper)||void 0===t?void 0:t.getShowMentionBarEnabled();if(j&&M&&i&&m&&!D.rx.isFeedV2&&B.push(Object(q.u)(m,this.props,S,w)),T){var V=!!this.props.formMeta.shareToken&&this.props.formMeta.bannedStatus!==D.YC.Normal,k=!!this.props.formMeta.flag,F=g?this.formStorageManager.getFormMode(r,l,D.MC.Edit):D.MC.Submit;k&&!V&&B.push(Object(q.y)(g&&k,this.props,w)),B.push(Object(q.x)(g,this.props,S,V,w)),F===D.MC.Edit&&B.push(Object(q.k)(g,this.props,S))}B=D.ob.config.ui.toolbarItems?D.ob.config.ui.toolbarItems(B):[];var P,N=[],L=[],_=[],W=[],R=[],z=Object(D.WB)(B);try{for(z.s();!(P=z.n()).done;){var H=P.value;H.item=H.item||x.createElement("div",{key:H.type,className:"toolbar-common-wrapper"},H.dialog,this.genToolbarBtn({cls:f(!!H.disable),editable:!H.disable,name:H.text||"",type:H.type,icon:H.icon,onClick:H.onClick,showTooltip:H.showTooltip||!0})),[D.LC.UNDO,D.LC.REDO,D.LC.FIND,D.LC.FORM_HOW_TO_USE].includes(H.type)?W.push(H):[D.LC.ADD].includes(H.type)?N.push(H):[D.LC.COMMENT,D.LC.MENTION,D.LC.FORM_CREATE,D.LC.REMINDER].includes(H.type)?_.push(H):[D.LC.FORM_SETTINGS].includes(H.type)?R.push(H):L.push(H)}}catch(e){z.e(e)}finally{z.f()}return a&&a.forEach(function(e){var t=Object(K.a)(e.disabled)?!g:e.disabled,i=Object(K.a)(e.disabled)?g:!e.disabled;W.splice(e.index,0,{type:e.type||"",item:x.createElement("div",{key:e.index,className:"toolbar-common-wrapper"},e.DropDown,n.genToolbarBtn({cls:U()(Z,{disabled:t,interactive:i}),name:e.name,type:e.type||"",icon:x.createElement(e.Icon,null),onClick:e.onClick,editable:g}))})}),{lastItems:N,leftItems:L,insertedItems:_,middleItems:W,rightItems:R}}},{key:"getToolbarItemByType",value:function(t){var e=this.getToolbarItems(),i=e.leftItems,n=e.middleItems,o=e.rightItems,a=[];return i&&(a=a.concat(i)),n&&(a=a.concat(n)),o&&(a=a.concat(o)),a.find(function(e){return e.type===t})}},{key:"renderToolbarItemByType",value:function(e){var t=this.getToolbarItemByType(e);return t?x.createElement("div",{className:"toolbar-middle-group"},t.item):null}},{key:"renderBaseFeatureBtn",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.getToolbarItems().middleItems,t=this.props,i=t.bitableInSheetEnableHistory,n=t.viewEditable,o=t.embeddedType,a=this.props.editable;a=a&&n;var r=D.rx.isFeed,l=o===D.pA.EmbeddedInDoc,s=o===D.pA.EmbeddedInSheet;return x.createElement(x.Fragment,null,x.createElement("div",{className:"toolbar-middle-group"},e.map(function(e){return e.item})),!l&&a&&!s&&!r&&i&&x.createElement("div",{className:U()("toolbar-history"),onClick:this.toggleHistory},x.createElement(d.a,null),x.createElement("span",null,u("bitable.history.history_record"))))}},{key:"renderKanbanGroup",value:function(){var e=this.props,t=e.tableId,i=e.viewId,n=e.kanbanGroupOpened,o=e.toggleKanbanGroup,a=e.hasToolBarEntityPermission,r=e.getKanbanGroupField,l=e.groupFields,s=e.embeddedType,d=a(D.qy.Group),c=U()(Z,{disabled:!d,interactive:d}),b=r(t,i);return x.createElement("div",{title:u("bitable.choose_group_field"),className:"toolbar-group-wrapper",onClick:this.handleGroupClick,"data-selector":D.bD.smartable_kanban_group_setting,ref:this.setGroupRef},x.createElement("div",{className:c},x.createElement("div",{className:U()("toolbar-btn-container bitable-layout-row bitable-layout-cross-center bitable-noselect",{"toolbar-btn-container-mouse-event":d})},x.createElement("i",{className:"toolbar-icon"},x.createElement(p.a,null)),x.createElement("span",{className:"toolbar-text"},u("bitable.group_by",""),x.createElement("span",{className:"toolbar-text-bold toolbar-text-overflow"},b?" ".concat(b.name):"")))),x.createElement(q.b,{tableId:t,groupFields:l,selectedField:b,bitableType:s,isOpen:n,toggleKanbanGroup:o,getAnchorRef:this.getGroupRef,onItemClick:this.onGroupOptionClick}))}},{key:"viewNotSupport",value:function(){var e=this.props,t=e.tableId,i=e.viewId;return!!e.bitableStore.downgradeManager.getViewNotSupportNotifyConfig({tableId:t||"",viewId:i||""})}},{key:"render",value:function(){var t=this,e=this.props,i=this.state,n=e.tableId,o=e.viewId,a=e.isOpenSidebar,r=e.views,l=e.isEmptyView,s=e.bitableStore,d=e.renderer,c=e.viewsExclude,b=e.editable,u=e.isVCEnable,p=e.moduleType,v=e.view,h=i.viewMenuHovered,m=this.showGroupField(),g=this.getToolbarItems(),w=g.lastItems,f=g.leftItems,y=g.insertedItems,S=g.middleItems,O=g.rightItems,C=(null==v?void 0:v.type)===D.az.Form,I=this.viewNotSupport();return x.createElement("div",{className:U()("bitable-toolbar bitable-layout-row bitable-layout-cross-center bitable-f-s-0",{"form-view-toolbar-in-sheet":C,open:a})},D.ob.config.ui.visibility[D.cC.ViewPanel]&&x.createElement("div",{className:U()("bitable-layout-row","bitable-layout-cross-center","bitable-noselect","toolbar-btn-sidebar-ccm","hover-menu_container",{close:!a,open:a})},x.createElement("i",{className:"toggle-sidebar-icon bitable-g-pr","data-selector":v&&v.type===D.az.Kanban?q.f.kanbanChangeView:q.f.gridChangeView,onMouseEnter:this.onSidebarbtnHover,onMouseLeave:this.onSidebarBtnLeave},x.createElement("div",{className:"toggle-sidebar-svg",ref:function(e){return t.toggleIconEl=e}},x.createElement(T.a,{className:a?"":"toggle-sidebar-svg-close",onClick:this.handleMenuIconClick.bind(this)})),n&&o&&x.createElement(D.RH,{isFloat:!0,showFloatSidebar:!a&&h,bitableStore:s,renderer:d,tableId:n,viewId:o,views:r,onAddView:this.onSidebarBtnLeave,onSwitchView:this.onSidebarBtnLeave,onCopyView:this.onSidebarBtnLeave,source:D.KC.LeftSidePanel,viewsExclude:c,editable:b,onClickViewMoreOptionsBtn:this.onClickViewMoreOptionsBtn,onClickSideBarItem:this.onClickSideBarItem,isVCEnable:u})),v&&(v.id!==this.state.editViewId?x.createElement(D.Mx,{title:v.name},x.createElement("span",{className:"toolbar-title-text",style:{cursor:e.editable?"pointer":"auto"},onDoubleClick:function(){D.cz.collectClickEvent(D.Bc.CcmBitableToolbarClick,{click:D.PC[D.LC.VIEW_NAME_EDIT_CLICK]}),t.onViewRename(v)},ref:function(e){return t.viewNameContainer=e}},v.name)):x.createElement("div",{className:"view-name-flex-input-container"},x.createElement(E.a,{className:"toolbar-input",onBlur:function(){return t.onViewEditBlur()},onKeyDown:function(e){return t.onKeyDown(e)},defaultValue:v.name,ref:function(e){return t.viewNameEditor=e}})))),C&&!I&&!(p===D.Bz.Template)&&Object(q.w)(b,this.props,this.handleSetFormModeEvent).item,!l&&!I&&x.createElement("div",{className:"bitable-view-toolbar bitable-layout-row bitable-layout-cross-center"},m&&this.renderKanbanGroup(),0<f.length&&x.createElement("div",{className:"toolbar-left-group"},f.map(function(e){return e.item})),0<y.length&&x.createElement("div",{className:"toolbar-inserted-group"},y.map(function(e){return e.item})),0<S.length&&this.renderBaseFeatureBtn(S),0<O.length&&x.createElement("div",{className:"toolbar-right-group",style:{border:C?"none":""}},O.map(function(e){return e.item})),0<w.length&&x.createElement("div",{className:"toolbar-last-group"},w.map(function(e){return e.item}))))}}]),i}(q.d),l=Object(n.connect)(function(e,t){var i,n=t.tableId,o=Object(D.Fz)(e),a=o&&o.status.translated;return{haveCommentPermission:Object(D.Hz)(e)&&!a,hiddenInfoMap:Object(D.ZH)(e,n),bitableInSheetEnableHistory:D.ob.MinaConfig&&(null===(i=D.ob.MinaConfig)||void 0===i?void 0:i.getMinaBooleanConfig(D.JF.BitableInSheetEnableHistory,!1))}},{toggleHistory:D.TB,beforeToggleMentionBar:D.aI},null,{forwardRef:!0}),s=Object(i.b)(function(e,t){var i=e.toolbarStore;return Object.assign({},Object(y.b)(i,t),{toggleTableSidebar:i.toggleTableSidebar})}),h=Object(D.oA)(function(e,t){var i,n,o,a,r,l,s,d=e.base,c=e.config,b=e.permissionStore,u=t.tableId,p=t.viewId,v=d.getTable(u),h=null==v?void 0:v.getView(p),m=(null!==(i=null==v?void 0:v.getAllViews())&&void 0!==i?i:[]).map(function(e){return Object(D.lB)(v.getView(e))}),g=c.get("ui"),w=Object(f.a)({shareToken:"",memberList:[],bannedStatus:D.YC.Unknown,forbiddenSubmit:!1},null!=h&&h.isType(D.az.Form)?h.getFormMeta():{});return Object.assign({},Object(y.a)(e,t),{filterInfo:null!==(n=null==h?void 0:h.getValidFilterInfo())&&void 0!==n?n:null,isShowName:null!==(o=null==g||null===(a=g.visibility.new_table_view)||void 0===a?void 0:a.toolbar_find_btn_show_name)&&void 0!==o&&o,isShowTooltip:null==g||null===(r=g.visibility.new_table_view)||void 0===r?void 0:r.toolbar_find_btn_show_tooltip,isDisableReminder:null!==(l=c.get("disableReminder"))&&void 0!==l&&l,isShowComment:null!==(s=null==g?void 0:g.showComment)&&void 0!==s&&s,formMeta:w,views:m,originalEditable:b.getOriginalBasePermission("editable")})},function(e,t){var i=e.permissionStore,n=e.operate,o=e.base,a=t.renderer,r=t.tableId,l=t.viewId,s=t.hiddenInfoMap;function d(e,t){return i.hasPermission(D.qy.View,{tableId:e,viewId:t},D.ry.Editable)}function c(e,t){var i=o.getTable(e),n=null==i?void 0:i.getView(t);return n?Object(D.lB)(n):void 0}function b(e,t){a.switchView(Object(D.aB)(o),e,t)}function u(e,t){var i=o.getTable(e),n=null==i?void 0:i.getView(t);return n?Object(D.pF)(n):void 0}function p(e){return i.hasPermission(e,{tableId:r||"",viewId:l||""},D.ry.Editable)}function v(){return i.hasPermission(D.qy.Record,{tableId:r},D.ry.Addable)}function h(){var e=0,t=o.getTable(r);return r&&s&&Object.keys(s).length&&(e=t?Object.keys(s).filter(function(e){return!Object(D.bI)(t).isDeniedField(e)&&!!t.getField(e)}).length:0),e}function m(e,t,i){n.viewOperate.setFormMeta({tableId:e,viewId:t,formMeta:i})}return Object.assign({},Object(y.c)(e,t),{hasViewEditablePermission:d,onSetView:n.tableOperate.setViewSync,getViewState:c,onSwitchView:b,getSelectType:u,hasEditablePermission:p,hasAddableRecordPermission:v,getFieldHiddenCount:h,updateFormMeta:m})},function(e,t,i){var o=e.base,n=e.permissionStore,a=t.tableId,r=t.viewId;i(function(e){return n.subscribe(e),function(){return n.unsubscribe(e)}},[]),i(function(e){var t,i=o.getTable(a);return null==i?void 0:i.batchBind((Object(D.Ww)(t={},D.uA.AddView,e),Object(D.Ww)(t,D.uA.DeleteView,e),Object(D.Ww)(t,D.uA.MoveView,e),Object(D.Ww)(t,D.uA.AddField,e),Object(D.Ww)(t,D.uA.ViewNameChange,e),Object(D.Ww)(t,D.uA.DeleteField,e),Object(D.Ww)(t,D.uA.ViewPublicLevelChange,e),Object(D.Ww)(t,D.uA.FieldAttrChange,e),t))},[a]),i(function(e){var t,i=o.getTable(a),n=null==i?void 0:i.getView(r);return null==n?void 0:n.batchBind((Object(D.Ww)(t={},D.uA.ViewGroupInfoChange,e),Object(D.Ww)(t,D.uA.ViewSortInfoChange,e),Object(D.Ww)(t,D.uA.ViewAutoSortChange,e),Object(D.Ww)(t,D.uA.ViewRowHeightLevelChange,e),Object(D.Ww)(t,D.uA.ViewFilterInfoChange,e),Object(D.Ww)(t,D.uA.FormMateChange,e),Object(D.Ww)(t,D.uA.ViewDescriptionChange,e),t))},[a,r])}),m=Object(t.a)(i.c,s,l,h)(r),g=Object.freeze({__proto__:null,mobxInject:s,bizConnect:h,EmbeddedSheetToolBar:m})}.call(this,O("vb163"))},vb1925:function(e,t,i){"use strict";var n=i("vb144"),o=i.n(n),a=i("vb103"),r=i("vb151");function l(e){return a.createElement("svg",o()({width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),a.createElement("path",{d:"M22.4 12c0 5.523-4.477 10-10 10a9.982 9.982 0 0 1-7.845-3.797l1.59-1.215a8 8 0 1 0-1.634-6.32H5.5a.532.532 0 0 1 .444.828L3.99 14a.533.533 0 0 1-.888 0l-2.046-2.505a.533.533 0 0 1 .444-.83h.988C3.14 5.775 7.33 2 12.4 2c5.523 0 10 4.477 10 10Z",fill:"currentColor"}),a.createElement("path",{d:"M13.5 11V8a1 1 0 1 0-2 0v4.467c0 .294.239.533.533.533h3.3a1 1 0 1 0 0-2H13.5Z",fill:"currentColor"}))}var s=a.forwardRef(function(e,t){return a.createElement(r.a,o()({icon:l},e,{ref:t,svgProps:{"data-icon":"HistoryOutlined"}}))});t.a=s},vb1931:function(e,t,i){"use strict";var n=i("vb144"),o=i.n(n),a=i("vb103"),r=i("vb151");function l(e){return a.createElement("svg",o()({width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),a.createElement("path",{d:"m10.65 17.637-5.636-5.636 5.943-5.943.835-.84a1 1 0 1 0-1.418-1.41l-.663.668-6.819 6.818a1 1 0 0 0 0 1.414l6.473 6.472 1.011 1.014a1 1 0 0 0 1.416-1.41 1595.32 1595.32 0 0 0-1.142-1.147Z",fill:"currentColor"}),a.createElement("path",{d:"m19.558 17.637-5.636-5.636 5.943-5.943.835-.84a1 1 0 1 0-1.419-1.41l-.663.668-6.818 6.818a1 1 0 0 0 0 1.414l6.473 6.472 1.011 1.014a1 1 0 0 0 1.416-1.41l-1.142-1.147Z",fill:"currentColor"}))}var s=a.forwardRef(function(e,t){return a.createElement(r.a,o()({icon:l},e,{ref:t,svgProps:{"data-icon":"UpLeftOutlined"}}))});t.a=s},vb341:function(e,t,i){"use strict";i.d(t,"a",function(){return l});var n=i("vb143"),o=i("vb103"),a=function(t){function i(e){return Object(n.ov)(this,i),t.call(this,e)||this}return Object(n.bu)(i,t),Object(n.Pw)(i,[{key:"componentDidMount",value:function(){var e,t=null===(e=this.props.forwardedRef)||void 0===e?void 0:e.current;t&&this.resetDomWidth(t)}},{key:"onChange",value:function(e){this.resetDomWidth(e.target),this.props.onChange&&this.props.onChange(e)}},{key:"resetDomWidth",value:function(e){e.style.width="0px",e.style.width="".concat(e.scrollWidth,"px")}},{key:"render",value:function(){var t=this,e=this.props.forwardedRef;return o.createElement("input",Object(n.Kx)({type:"text"},this.props,{ref:e,onChange:function(e){return t.onChange(e)}}))}}]),i}(o.PureComponent);function r(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=o.useRef();return o.useEffect(function(){t.forEach(function(e){e&&("function"==typeof e?e(n.current):e.current=n.current)})},[t]),n}var l=o.forwardRef(function(e,t){var i=r(t,o.useRef(null));return o.createElement(a,Object(n.Kx)({},e,{forwardedRef:i}))})},vb446:function(e,t,i){"use strict";i.d(t,"a",function(){return b}),i.d(t,"b",function(){return r}),i.d(t,"c",function(){return u}),i.d(t,"d",function(){return c}),i.d(t,"e",function(){return m}),i.d(t,"f",function(){return p});var n,o,a,r,l,s=i("vb143");(l=r||(r={})).zh="zh",l["zh-HK"]="zh-HK",l["zh-TW"]="zh-TW",l.en="en",l.ja="ja";var d=(Object(s.Ww)(n={},r.zh,760),Object(s.Ww)(n,r["zh-HK"],760),Object(s.Ww)(n,r["zh-TW"],760),Object(s.Ww)(n,r.en,900),Object(s.Ww)(n,r.ja,1e3),n),c=215,b=780;function u(e,a){if(e){var t={attributes:!0,subtree:!0,attributeFilter:["width"]},i=new MutationObserver(function(e,t){var i,n=Object(s.WB)(e);try{for(n.s();!(i=n.n()).done;){var o=i.value;"attributes"===o.type&&"width"===o.attributeName&&a()}}catch(e){n.e(e)}finally{n.f()}});return i.observe(e,t),i}return null}var p=function(e){return d[e]||1e3},v=(Object(s.Ww)(o={},r.zh,1400),Object(s.Ww)(o,r["zh-HK"],1400),Object(s.Ww)(o,r["zh-TW"],1400),Object(s.Ww)(o,r.en,1570),Object(s.Ww)(o,r.ja,1650),o),h=(Object(s.Ww)(a={},r.zh,868),Object(s.Ww)(a,r["zh-HK"],868),Object(s.Ww)(a,r["zh-TW"],868),Object(s.Ww)(a,r.en,1054),Object(s.Ww)(a,r.ja,1120),a),m=function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],i=t?h[e]:v[e];return Number.isFinite(i)?i:t?h.en:v.en}},vb449:function(e,t,i){"use strict";i.d(t,"a",function(){return o}),i.d(t,"b",function(){return n}),i.d(t,"c",function(){return a});var y=i("vb143");i("vb147"),i("vb103"),i("vb148"),i("vb152"),i("vb112"),i("vb164"),i("vb167"),i("vb113"),i("vb174"),i("vb155");function n(t,i){var e,n=i.viewId;function o(){var e=(0,i.addFormView)();(null==e?void 0:e.result)===y.Ey.Success&&(t.toggleSidebar(!1),t.toggleFormSettingsPanel(e.data.viewId,!0),setTimeout(function(){var e=document.querySelector(".bitable-form-title-text");null==e||e.click()},200))}return{openFilter:t.isOpenFilter,fieldPanelOpened:t.isOpenFieldPanel,ganttBarSettingsPanelOpened:t.isOpenGanttBarSettingsPanel,groupOpened:t.isOpenGroup,kanbanGroupOpened:t.isOpenKanbanGroup,rowHeightPanelOpened:t.isOpenRowHeightPanel,sortPanelOpened:t.isOpenSortPanel,toggleFieldPanel:t.toggleFieldPanel,toggleFilter:t.toggleFilter,toggleGanttBarSettingsPanel:t.toggleGanttBarSettingsPanel,toggleGroup:t.toggleGroup,toggleKanbanGroup:t.toggleKanbanGroup,toggleRowHeightPanel:t.toggleRowHeightPanel,toggleSortPanel:t.toggleSortPanel,findPanelOpened:t.isOpenFindPanel,shareFormPanelOpened:t.isOpenShareFormPanel,toggleFindPanel:t.toggleFindPanel,toggleFormSharePanel:t.toggleFormSharePanel,onAddFormView:o,isCommentDataInit:t.isCommentDataInit,formSettingsPanelOpened:null!==(e=t.formSettingsPanelMap.get(n))&&void 0!==e&&e,toggleFormSettingsPanel:t.toggleFormSettingsPanel,toggleSidebar:t.toggleSidebar}}function o(e,t){var i,n,o,a,r=e.base,l=e.env,s=e.permissionStore,d=t.tableId,c=t.viewId,b=r.getTable(d),u=null==b?void 0:b.getView(c),p=(null!==(i=null==u?void 0:u.getAllFields())&&void 0!==i?i:[]).reduce(function(e,t){var i=null==b?void 0:b.getField(t);return i&&Object(y.hB)(i.getType())&&i.validateValueInView(d)&&e.push({id:i.getId(),name:i.getName(),type:i.getType()}),e},[]),v=s.hasPermission(y.qy.View,{tableId:d,viewId:c},y.ry.Editable),h=u&&u.isType(y.az.Grid)?u.getRowHeightLevel():y.CD.Short;return{moduleType:l.getModuleType(),view:u?Object(y.lB)(u):void 0,groupFields:p,embeddedType:l.getEmbeddedType(),groupInfo:null!==(n=null==u?void 0:u.getGroupInfo())&&void 0!==n?n:[],isAutoSort:null!==(o=null==u?void 0:u.isAutoSort())&&void 0!==o&&o,sortInfo:null!==(a=null==u?void 0:u.getSortInfo())&&void 0!==a?a:[],viewEditable:v,rowHeightLevel:h}}function a(e,t){var a=e.base,n=e.operate,o=e.permissionStore,r=t.tableId,l=t.viewId,s=t.isInvalidView,d=t.editable,c=t.renderer,i=t.mountOption,b=t.smartableCommentManager;function u(e,t){if(e&&t){var i=a.getTable(e);if(i){var n=i.getView(t);if(n&&n.isType(y.az.Kanban)){var o=n.getGroupField();if(o)return{id:o.id,name:o.name,type:o.type,fieldUIType:o.fieldUIType}}}}return null}function p(e){var t=a.getTable(r),i=t.getView(l);return n.viewOperate.setGroupSync({tableId:r,viewId:l,group:[{fieldId:e,desc:!1}]}),{fieldStringType:Object(y.pF)(i),fieldType:(null==t?void 0:t.getField(e)).getType()}}function v(e){var t=a.getTable(r),i=null==t?void 0:t.getField(e);return null==i?void 0:i.getStringType()}function h(){return o.hasPermission(y.qy.Record,{tableId:r,viewId:l},y.ry.Editable)}function m(e){return o.hasPermission(e,{tableId:r||"",viewId:l||""},y.ry.LocalEditable)}function g(e){var t=!s&&d&&o.hasPermission(y.qy.View,{tableId:r||"",viewId:l||""},y.ry.Editable),i=o.hasPermission(e,{tableId:r,viewId:l},y.ry.Editable);return m(e)||t&&i}function w(){var e=a.getTable(r),t=null==e?void 0:e.getView(l);if(t){var i=n.tableOperate.addViewSync({activeViewId:t.getId(),tableId:r,type:y.az.Form});return i.result===y.Ey.Success&&c.switchView(Object(y.aB)(a),r,i.data.viewId),i}}function f(e){null==b||b.triggerCreateComment(e,y.YH.EditorBar,i)}return{getKanbanGroupField:u,onSetGroup:p,getFieldStringType:v,hasEditRecordPermission:h,undo:n.undo,redo:n.redo,hasToolBarEntityPermission:g,addFormView:w,getLocalEditable:m,triggerCreateComment:f}}}}]);
//# sourceMappingURL=//slardar.bytedance.net/api_v2/browser/jserr/get_sourcemap?bid=docs_pc&js_filename=vendors-embed-doc-toolbar-embed-sheet-toolbar.dd167494c7.chunk.js